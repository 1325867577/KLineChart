/*! For license information please see main.6f646f50.chunk.js.LICENSE.txt */
(this["webpackJsonpk-line-chart-home-page"]=this["webpackJsonpk-line-chart-home-page"]||[]).push([[0],{135:function(t){t.exports=JSON.parse('{"solid":"\u5168\u5b9e\u5fc3","stroke":"\u5168\u7a7a\u5fc3","up_stroke":"\u6da8\u7a7a\u5fc3","down_stroke":"\u8dcc\u7a7a\u5fc3","ohlc":"OHLC","indicator":"\u6307\u6807","setting":"\u8bbe\u7f6e","screen_shot":"\u622a\u5c4f","dark":"\u6df1\u8272","light":"\u6d45\u8272","last_price":"\u6700\u65b0\u4ef7","high_price":"\u6700\u9ad8\u4ef7","low_price":"\u6700\u4f4e\u4ef7","main_technical_indicator":"\u4e3b\u56fe\u6307\u6807","sub_technical_indicator":"\u526f\u56fe\u6307\u6807","main_view_style":"\u4e3b\u56fe\u6837\u5f0f","chart_background":"\u56fe\u8868\u80cc\u666f","axis":"\u5750\u6807\u8f74","candlestick_style":"\u8721\u70db\u67f1\u6837\u5f0f","candlestick_color":"\u8721\u70db\u67f1\u989c\u8272","time_line":"\u5206\u65f6\u7ebf","trade_average_line":"\u6210\u4ea4\u5747\u7ebf","grid_horizontal_line":"\u7f51\u683c\u6c34\u5e73\u7ebf","grid_vertical_line":"\u7f51\u683c\u5782\u76f4\u7ebf","crosshair_horizontal_line":"\u5341\u5b57\u5149\u6807\u6c34\u5e73\u7ebf","crosshair_vertical_line":"\u5341\u5b57\u5149\u6807\u5782\u76f4\u7ebf","chart_separator_line":"\u56fe\u8868\u95f4\u5206\u5272\u7ebf","y_axis_type":"Y\u8f74\u7c7b\u578b","y_axis_position":"Y\u8f74\u4f4d\u7f6e","line_axis":"\u7ebf\u6027\u5750\u6807","percentage_axis":"\u767e\u5206\u6bd4\u5750\u6807","left":"\u5de6\u8fb9","right":"\u53f3\u8fb9","inside":"\u5185\u90e8","up":"\u4e0a\u6da8","down":"\u4e0b\u8dcc","no_change":"\u65e0\u53d8\u5316","timezone":"\u65f6\u533a","th":"\u53f7","ma":"MA(\u79fb\u52a8\u5e73\u5747\u7ebf)","ema":"EMA(\u6307\u6570\u5e73\u6ed1\u79fb\u52a8\u5e73\u5747\u7ebf)","sma":"SMA","boll":"BOLL(\u5e03\u6797\u7ebf)","bbi":"BBI(\u591a\u7a7a\u6307\u6570)","sar":"SAR(\u505c\u635f\u70b9\u6307\u5411\u6307\u6807)","vol":"VOL(\u6210\u4ea4\u91cf)","macd":"MACD(\u6307\u6570\u5e73\u6ed1\u5f02\u540c\u79fb\u52a8\u5e73\u5747\u7ebf)","kdj":"KDJ(\u968f\u673a\u6307\u6807)","rsi":"RSI(\u76f8\u5bf9\u5f3a\u5f31\u6307\u6807)","bias":"BIAS(\u4e56\u79bb\u7387)","brar":"BRAR(\u60c5\u7eea\u6307\u6807)","cci":"CCI(\u987a\u52bf\u6307\u6807)","dmi":"DMI(\u52a8\u5411\u6307\u6807)","cr":"CR(\u80fd\u91cf\u6307\u6807)","psy":"PSY(\u5fc3\u7406\u7ebf)","dma":"DMA(\u5e73\u884c\u7ebf\u5dee\u6307\u6807)","trix":"TRIX(\u4e09\u91cd\u6307\u6570\u5e73\u6ed1\u5e73\u5747\u7ebf)","obv":"OBV(\u80fd\u91cf\u6f6e\u6307\u6807)","vr":"VR(\u6210\u4ea4\u91cf\u53d8\u5f02\u7387)","wr":"WR(\u5a01\u5ec9\u6307\u6807)","mtm":"MTM(\u52a8\u91cf\u6307\u6807)","emv":"EMV(\u7b80\u6613\u6ce2\u52a8\u6307\u6807)","roc":"ROC(\u53d8\u52a8\u7387\u6307\u6807)","pvt":"PVT(\u4ef7\u91cf\u8d8b\u52bf\u6307\u6807)","ao":"AO(\u52a8\u91cf\u9707\u8361\u6307\u6807)","params_setting":"\u53c2\u6570\u8bbe\u7f6e","calc_param":"\u8ba1\u7b97\u53c2\u6570","utc":"\u4e16\u754c\u7edf\u4e00\u65f6\u95f4","honolulu":"(UTC-10) \u6a80\u9999\u5c71","juneau":"(UTC-8) \u6731\u8bfa","los_angeles":"(UTC-7) \u6d1b\u6749\u77f6","chicago":"(UTC-5) \u829d\u52a0\u54e5","toronto":"(UTC-4) \u591a\u4f26\u591a","sao_paulo":"(UTC-3) \u5723\u4fdd\u7f57","london":"(UTC+1) \u4f26\u6566","berlin":"(UTC+2) \u67cf\u6797","bahrain":"(UTC+3) \u5df4\u6797","dubai":"(UTC+4) \u8fea\u62dc","ashkhabad":"(UTC+5) \u963f\u4ec0\u54c8\u5df4\u5fb7","almaty":"(UTC+6) \u963f\u62c9\u6728\u56fe","bangkok":"(UTC+7) \u66fc\u8c37","shanghai":"(UTC+8) \u4e0a\u6d77","tokyo":"(UTC+9) \u4e1c\u4eac","sydney":"(UTC+10) \u6089\u5c3c","norfolk":"(UTC+12) \u8bfa\u798f\u514b\u5c9b","reset":"\u6062\u590d\u9ed8\u8ba4","confirm":"\u786e\u5b9a"}')},136:function(t){t.exports=JSON.parse('{"solid":"All Solid","stroke":"All Stroke","up_stroke":"Up Stroke","down_stroke":"Down Stroke","ohlc":"OHLC","timezone":"Timezone","utc":"UTC","honolulu":"(UTC-10) Honolulu","juneau":"(UTC-8) Juneau","los_angeles":"(UTC-7) Los Angeles","chicago":"(UTC-5) Chicago","toronto":"(UTC-4) Toronto","sao_paulo":"(UTC-3) Sao Paulo","london":"(UTC+1) London","berlin":"(UTC+2) Berlin","bahrain":"(UTC+3) Bahrain","dubai":"(UTC+4) Dubai","ashkhabad":"(UTC+5) Ashkhabad","almaty":"(UTC+6) Almaty","bangkok":"(UTC+7) Bangkok","shanghai":"(UTC+8) Shanghai","tokyo":"(UTC+9) Tokyo","sydney":"(UTC+10) Sydney","norfolk":"(UTC+12) Norfolk","confirm":"OK","indicator":"Indicator","setting":"Setting","screen_shot":"Screenshot","dark":"Dark","light":"Light","last_price":"\u6700\u65b0\u4ef7","high_price":"High","low_price":"Low","main_technical_indicator":"Main Indicators","sub_technical_indicator":"Sub Indicators","main_view_style":"Chart Style","chart_background":"Chart Background","axis":"Axis","candlestick_style":"Candle Style","candlestick_color":"Candle Color","time_line":"\u5206\u65f6\u7ebf","trade_average_line":"\u6210\u4ea4\u5747\u7ebf","grid_horizontal_line":"\u7f51\u683c\u6c34\u5e73\u7ebf","grid_vertical_line":"\u7f51\u683c\u5782\u76f4\u7ebf","crosshair_horizontal_line":"\u5341\u5b57\u5149\u6807\u6c34\u5e73\u7ebf","crosshair_vertical_line":"\u5341\u5b57\u5149\u6807\u5782\u76f4\u7ebf","chart_separator_line":"\u56fe\u8868\u95f4\u5206\u5272\u7ebf","y_axis_type":"Y\u8f74\u7c7b\u578b","y_axis_position":"Y\u8f74\u4f4d\u7f6e","line_axis":"Linear","percentage_axis":"\u767e\u5206\u6bd4\u5750\u6807","left":"Left","right":"Right","inside":"Inside","up":"Rise","down":"Drop","no_change":"No Change","th":"th","ma":"MA(Moving Average)","ema":"EMA(Exponential Moving Average)","sma":"SMA","boll":"BOLL(Bolinger Bands)","bbi":"BBI(Bull And Bearlndex)","sar":"SAR(Stop and Reverse)","vol":"VOL(Volume)","macd":"MACD(Moving Average Convergence / Divergence)","kdj":"KDJ(KDJ Index)","rsi":"RSI(Relative Strength Index)","bias":"BIAS(Bias Ratio)","brar":"BRAR(\u60c5\u7eea\u6307\u6807)","cci":"CCI(Commodity Channel Index)","dmi":"DMI(Directional Movement Index)","cr":"CR(\u80fd\u91cf\u6307\u6807)","psy":"PSY(Psychological Line)","dma":"DMA(Different of Moving Average)","trix":"TRIX(Triple Exponentially Smoothed Moving Average)","obv":"OBV(On Balance Volume)","vr":"VR(Volatility Volume Ratio)","wr":"WR(Williams %R)","mtm":"MTM(Momentum Index)","emv":"EMV(Ease of Movement Value)","roc":"ROC(Price Rate of Change)","pvt":"PVT(Price and Volume Trend)","ao":"AO(Awesome Oscillator)","params_setting":"\u53c2\u6570\u8bbe\u7f6e","calc_param":"\u8ba1\u7b97\u53c2\u6570"}')},138:function(t,e,a){t.exports=a(361)},141:function(t,e){},147:function(t,e,a){!function(t){"use strict";function e(t){return(e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){for(var a=0;e.length>a;a++){var i=e[a];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function n(t,e,a){return e&&i(t.prototype,e),a&&i(t,a),t}function r(t,e,a){return e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&function(t,e){(Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}(t,e)}function c(t){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function s(t,e){return!e||"object"!=typeof e&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function l(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var a,i=c(t);if(e){var n=c(this).constructor;a=Reflect.construct(i,arguments,n)}else a=i.apply(this,arguments);return s(this,a)}}function h(t,e,a){return(h="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,a){var i=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=c(t)););return t}(t,e);if(i){var n=Object.getOwnPropertyDescriptor(i,e);return n.get?n.get.call(a):n.value}})(t,e,a||t)}function u(t,e){(null==e||e>t.length)&&(e=t.length);for(var a=0,i=Array(e);e>a;a++)i[a]=t[a];return i}function d(t){if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(t=function(t,e){if(t){if("string"==typeof t)return u(t,e);var a=Object.prototype.toString.call(t).slice(8,-1);return"Object"===a&&t.constructor&&(a=t.constructor.name),"Map"===a||"Set"===a?Array.from(t):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?u(t,e):void 0}}(t))){var e=0,a=function(){};return{s:a,n:function(){return t.length>e?{done:!1,value:t[e++]}:{done:!0}},e:function(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,n,r=!0,o=!1;return{s:function(){i=t[Symbol.iterator]()},n:function(){var t=i.next();return r=t.done,t},e:function(t){o=!0,n=t},f:function(){try{r||null==i.return||i.return()}finally{if(o)throw n}}}}function v(t,e){if(y(t)&&y(e))for(var a in e)if(t.hasOwnProperty(a)){var i=t[a],n=e[a];y(n)&&y(i)&&!_(n)&&!_(i)?v(i,n):(e[a]||0===e[a]||!1===e[a])&&(t[a]=e[a])}}function p(t){if(!t||!y(t))return t;var e,a,i;for(a in e=_(t)?[]:{},t)t.hasOwnProperty(a)&&(e[a]=(i=t[a])&&y(i)?p(i):i);return e}function _(t){return"[object Array]"===Object.prototype.toString.call(t)}function f(t){return"function"==typeof t}function y(t){var a=e(t);return"function"===a||!!t&&"object"===a}function m(t){return"number"==typeof t&&!isNaN(t)}function k(t){return null!=t}function g(t){return"boolean"==typeof t}var x="dash",w="left",b="right",P="real_time",C="candle_stick",T="solid",D="always",M="standard",S={grid:{display:!0,horizontal:{display:!0,size:1,color:"#393939",style:x,dashValue:[2,2]},vertical:{display:!1,size:1,color:"#393939",style:x,dashValue:[2,2]}},candleStick:{bar:{style:T,upColor:"#26A69A",downColor:"#EF5350",noChangeColor:"#888888"},priceMark:{display:!0,high:{display:!0,color:"#D9D9D9",textMargin:5,textSize:10,textFamily:"Helvetica Neue",textWeight:"normal"},low:{display:!0,color:"#D9D9D9",textMargin:5,textSize:10,textFamily:"Helvetica Neue",textWeight:"normal"},last:{display:!0,upColor:"#26A69A",downColor:"#EF5350",noChangeColor:"#888888",line:{display:!0,style:x,dashValue:[4,4],size:1},text:{display:!0,size:12,paddingLeft:2,paddingTop:2,paddingRight:2,paddingBottom:2,color:"#FFFFFF",family:"Helvetica Neue",weight:"normal"}}}},realTime:{timeLine:{color:"#2196F3",size:1,areaFillColor:"rgba(33, 150, 243, 0.08)"},averageLine:{display:!0,color:"#FF9600",size:1}},technicalIndicator:{bar:{upColor:"#26A69A",downColor:"#EF5350",noChangeColor:"#888888"},line:{size:1,colors:["#D9D9D9","#FF9600","#F632FF","#2196F3","#9157DB"]},circle:{upColor:"#26A69A",downColor:"#EF5350",noChangeColor:"#888888"},lastValueMark:{display:!1,textColor:"#ffffff",textSize:12,textFamily:"Helvetica Neue",textWeight:"normal",textPaddingLeft:3,textPaddingTop:2,textPaddingRight:3,textPaddingBottom:2}},xAxis:{display:!0,axisLine:{display:!0,color:"#888888",size:1},tickText:{display:!0,color:"#D9D9D9",size:12,family:"Helvetica Neue",weight:"normal",paddingTop:3,paddingBottom:6},tickLine:{display:!0,size:1,length:3,color:"#888888"}},yAxis:{display:!0,type:"normal",position:b,inside:!1,axisLine:{display:!0,color:"#888888",size:1},tickText:{display:!0,color:"#D9D9D9",size:12,family:"Helvetica Neue",weight:"normal",paddingLeft:3,paddingRight:6},tickLine:{display:!0,size:1,length:3,color:"#888888"}},separator:{size:1,color:"#888888",fill:!0},floatLayer:{crossHair:{display:!0,horizontal:{display:!0,line:{display:!0,style:x,dashValue:[4,2],size:1,color:"#888888"},text:{display:!0,color:"#D9D9D9",size:12,family:"Helvetica Neue",weight:"normal",paddingLeft:2,paddingRight:2,paddingTop:2,paddingBottom:2,borderSize:1,borderColor:"#505050",backgroundColor:"#505050"}},vertical:{display:!0,line:{display:!0,style:x,dashValue:[4,2],size:1,color:"#888888"},text:{display:!0,color:"#D9D9D9",size:12,family:"Helvetica Neue",weight:"normal",paddingLeft:2,paddingRight:2,paddingTop:2,paddingBottom:2,borderSize:1,borderColor:"#505050",backgroundColor:"#505050"}}},prompt:{displayRule:D,candleStick:{showType:M,labels:["\u65f6\u95f4","\u5f00","\u6536","\u9ad8","\u4f4e","\u6210\u4ea4\u91cf"],values:null,rect:{paddingLeft:0,paddingRight:0,paddingTop:0,paddingBottom:6,left:8,top:8,right:8,borderRadius:4,borderSize:1,borderColor:"#3f4254",fillColor:"rgba(17, 17, 17, .3)"},text:{size:12,family:"Helvetica Neue",weight:"normal",color:"#D9D9D9",marginLeft:8,marginTop:6,marginRight:8,marginBottom:0}},technicalIndicator:{text:{size:12,family:"Helvetica Neue",weight:"normal",color:"#D9D9D9",marginTop:6,marginRight:8,marginBottom:0,marginLeft:8},point:{display:!0,radius:3}}}},graphicMark:{line:{color:"#2196F3",size:1},point:{backgroundColor:"#2196F3",borderColor:"#2196F3",borderSize:1,radius:4,activeBackgroundColor:"#2196F3",activeBorderColor:"#2196F3",activeBorderSize:1,activeRadius:6},text:{color:"#1e88e5",size:12,family:"Helvetica Neue",weight:"normal",marginLeft:2,marginRight:2,marginTop:2,marginBottom:6}}};function E(t,e){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"--";if(t&&y(t)){var i=t[e];if(i||0===i||!1===i)return i}return a}function I(t,e,a){if(e&&m(e)){var i=t.format(new Date(e)),n=i.match(/^[\d]{1,2}\/[\d]{1,2}\/[\d]{4}/)[0].split("/"),r="".concat(1===n[0].length?"0".concat(n[0]):n[0]),o="".concat(1===n[1].length?"0".concat(n[1]):n[1]),c=i.match(/[\d]{2}:[\d]{2}$/)[0];switch("24"===c.match(/^[\d]{2}/)[0]&&(c=c.replace(/^[\d]{2}/,"00")),a){case"YYYY":return n[2];case"YYYY-MM":return"".concat(n[2],"-").concat(r);case"YYYY-MM-DD":return"".concat(n[2],"-").concat(r,"-").concat(o);case"YYYY-MM-DD hh:mm":return"".concat(n[2],"-").concat(r,"-").concat(o," ").concat(c);case"MM-DD":return"".concat(r,"-").concat(o);case"hh:mm":return c;default:return"".concat(r,"-").concat(o," ").concat(c)}}return"--"}function L(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2,a=+t;return(a||0===a)&&m(a)?a.toFixed(e):"".concat(a)}function A(t){return m(+t)?t>1e9?"".concat(+(t/1e9).toFixed(3),"B"):t>1e6?"".concat(+(t/1e6).toFixed(3),"M"):t>1e3?"".concat(+(t/1e3).toFixed(3),"K"):t:"--"}var O="price",R="volume",z=function(){function t(e){var i=e.name,n=e.series,r=e.calcParams,o=e.plots,c=e.precision,s=e.shouldCheckParamCount,l=e.shouldOhlc,h=e.shouldFormatBigNumber,u=e.baseValue,d=e.minValue,v=e.maxValue;a(this,t),this.name=i||"",this.series=n||"normal",this.precision=k(c)&&m(c)&&c>=0?c:4,this.calcParams=_(r)?r:[],this.plots=_(o)?o:[],this.shouldCheckParamCount=!g(s)||s,this.shouldOhlc=l,this.shouldFormatBigNumber=h,this.baseValue=m(u)?u:null,this.minValue=d,this.maxValue=v,this.result=[]}return n(t,[{key:"setPrecision",value:function(t){t>=0&&m(t)&&(this.precision=parseInt(t,10))}},{key:"setCalcParams",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];if(!this.shouldCheckParamCount||t.length===this.calcParams.length){this.calcParams=p(t);var e=this.regeneratePlots(t);e&&_(e)&&(this.plots=e)}}},{key:"calcTechnicalIndicator",value:function(t,e){}},{key:"regeneratePlots",value:function(t){}}]),t}(),V=function(t){o(i,t);var e=l(i);function i(){return a(this,i),e.call(this,{name:"MA",series:O,calcParams:[5,10,30,60],precision:2,shouldCheckParamCount:!1,shouldOhlc:!0,plots:[{key:"ma5",type:"line"},{key:"ma10",type:"line"},{key:"ma30",type:"line"},{key:"ma60",type:"line"}]})}return n(i,[{key:"regeneratePlots",value:function(t){var e=[];return t.forEach((function(t){e.push({key:"ma".concat(t),type:"line"})})),e}},{key:"calcTechnicalIndicator",value:function(t,e){var a=this,i=[],n=[];return t.forEach((function(r,o){var c={},s=r.close;e.forEach((function(e,n){i[n]=(i[n]||0)+s,e-1>o||(c[a.plots[n].key]=i[n]/e,i[n]-=t[o-(e-1)].close)})),n.push(c)})),n}}]),i}(z),H=function(t){o(i,t);var e=l(i);function i(){return a(this,i),e.call(this,{name:"EMA",series:O,calcParams:[6,12,20],precision:2,shouldCheckParamCount:!1,shouldOhlc:!0,plots:[{key:"ema6",type:"line"},{key:"ema12",type:"line"},{key:"ema20",type:"line"}]})}return n(i,[{key:"regeneratePlots",value:function(t){var e=[];return t.forEach((function(t){e.push({key:"ema".concat(t),type:"line"})})),e}},{key:"calcTechnicalIndicator",value:function(t,e){var a=this,i=[],n=[];return t.forEach((function(t,r){var o={},c=t.close;e.forEach((function(t,e){var n;o[a.plots[e].key]=n=0===r?c:(2*c+(t-1)*i[e])/(t+1),i[e]=n})),n.push(o)})),n}}]),i}(z),B=function(t){o(i,t);var e=l(i);function i(){return a(this,i),e.call(this,{name:"VOL",series:R,calcParams:[5,10,20],shouldCheckParamCount:!1,shouldFormatBigNumber:!0,precision:0,baseValue:0,minValue:0,plots:[{key:"ma5",line:"line"},{key:"ma10",line:"line"},{key:"ma20",line:"line"},{key:"volume",type:"bar",referenceValue:0,color:function(t,e){var a=t.currentData.kLineData||{};return a.close>a.open?e.bar.upColor:a.open>a.close?e.bar.downColor:e.bar.noChangeColor}}]})}return n(i,[{key:"regeneratePlots",value:function(t){var e=[];return t.forEach((function(t){e.push({key:"ma".concat(t),type:"line"})})),e.push({key:"volume",type:"bar",referenceValue:0,color:function(t,e){var a=t.currentData.kLineData||{};return a.close>a.open?e.bar.upColor:a.open>a.close?e.bar.downColor:e.bar.noChangeColor}}),e}},{key:"calcTechnicalIndicator",value:function(t,e){var a=this,i=[],n=[];return t.forEach((function(r,o){var c=r.volume||0,s={volume:c};e.forEach((function(e,n){i[n]=(i[n]||0)+c,e-1>o||(s[a.plots[n].key]=i[n]/e,i[n]-=t[o-(e-1)].volume)})),n.push(s)})),n}}]),i}(z),N=function(t){o(i,t);var e=l(i);function i(){return a(this,i),e.call(this,{name:"MACD",calcParams:[12,26,9],baseValue:0,plots:[{key:"diff",type:"line"},{key:"dea",type:"line"},{key:"macd",type:"bar",color:function(t,e){var a=(t.currentData.technicalIndicatorData||{}).macd;return a>0?e.bar.upColor:0>a?e.bar.downColor:e.bar.noChangeColor},isStroke:function(t){return(t.currentData.technicalIndicatorData||{}).macd>(t.preData.technicalIndicatorData||{}).macd}}]})}return n(i,[{key:"calcTechnicalIndicator",value:function(t,e){var a,i,n=0,r=0,o=0,c=0,s=[];return t.forEach((function(t,l){var h=t.close;0===l?(a=h,i=h):(a=(2*h+(e[0]-1)*n)/(e[0]+1),i=(2*h+(e[1]-1)*r)/(e[1]+1));var u=a-i;n=a,r=i,c=o=(2*u+c*(e[2]-1))/(e[2]+1),s.push({diff:u,dea:o,macd:2*(u-o)})})),s}}]),i}(z),F=function(t){o(i,t);var e=l(i);function i(){return a(this,i),e.call(this,{name:"BOLL",series:O,calcParams:[20],precision:2,shouldOhlc:!0,plots:[{key:"up",type:"line"},{key:"mid",type:"line"},{key:"dn",type:"line"}]})}return n(i,[{key:"calcTechnicalIndicator",value:function(t,e){var a=this,i=e[0]-1,n=0,r=[];return t.forEach((function(o,c){var s={};if(n+=o.close,c>=i){s.mid=n/e[0];var l=a._getBollMd(t.slice(c-i,c+1),s.mid);s.up=s.mid+2*l,s.dn=s.mid-2*l,n-=t[c-i].close}r.push(s)})),r}},{key:"_getBollMd",value:function(t,e){var a=t.length,i=0;t.forEach((function(t){var a=t.close-e;i+=a*a}));var n=i>0,r=Math.sqrt((i=Math.abs(i))/a);return n?r:-1*r}}]),i}(z);function Y(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=-1/0,a=1/0;return t.forEach((function(t){e=Math.max(t.high,e),a=Math.min(t.low,a)})),{hn:e,ln:a}}var W=function(t){o(i,t);var e=l(i);function i(){return a(this,i),e.call(this,{name:"KDJ",calcParams:[9,3,3],plots:[{key:"k",type:"line"},{key:"d",type:"line"},{key:"j",type:"line"}]})}return n(i,[{key:"calcTechnicalIndicator",value:function(t,e){var a=[];return t.forEach((function(i,n){var r={},o=i.close;if(n>=e[0]-1){var c=Y(t.slice(n-(e[0]-1),n+1)),s=c.ln,l=c.hn-s;r.k=((e[1]-1)*(a[n-1].k||50)+(o-s)/(0===l?1:l)*100)/e[1],r.d=((e[2]-1)*(a[n-1].d||50)+r.k)/e[2],r.j=3*r.k-2*r.d}a.push(r)})),a}}]),i}(z),j=function(t){o(i,t);var e=l(i);function i(){return a(this,i),e.call(this,{name:"RSI",calcParams:[6,12,24],shouldCheckParamCount:!1,plots:[{key:"rsi6",type:"line"},{key:"rsi12",type:"line"},{key:"rsi24",type:"line"}]})}return n(i,[{key:"regeneratePlots",value:function(t){var e=[];return t.forEach((function(t){e.push({key:"rsi".concat(t),type:"line"})})),e}},{key:"calcTechnicalIndicator",value:function(t,e){var a=this,i=[],n=[],r=[];return t.forEach((function(o,c){var s={},l=o.open;e.forEach((function(e,r){var h=(o.close-l)/l;if(i[r]=i[r]||0,n[r]=n[r]||0,h>0?i[r]=i[r]+h:n[r]=n[r]+Math.abs(h),c>=e-1){var u=(i[r]+n[r])/e;s[a.plots[r].key]=0===u?0:i[r]/e/u*100;var d=t[c-(e-1)],v=d.open,p=(d.close-v)/v;p>0?i[r]-=p:n[r]-=Math.abs(p)}})),r.push(s)})),r}}]),i}(z),G=function(t){o(i,t);var e=l(i);function i(){return a(this,i),e.call(this,{name:"BIAS",calcParams:[6,12,24],shouldCheckParamCount:!1,plots:[{key:"bias6",type:"line"},{key:"bias12",type:"line"},{key:"bias24",type:"line"}]})}return n(i,[{key:"regeneratePlots",value:function(t){var e=[];return t.forEach((function(t){e.push({key:"bias".concat(t),type:"line"})})),e}},{key:"calcTechnicalIndicator",value:function(t,e){var a=this,i=[],n=[];return t.forEach((function(r,o){var c={},s=r.close;e.forEach((function(n,r){if(i[r]=(i[r]||0)+s,o>=n-1){var l=i[r]/e[r];c[a.plots[r].key]=(s-l)/l*100,i[r]-=t[o-(n-1)].close}})),n.push(c)})),n}}]),i}(z),U=function(t){o(i,t);var e=l(i);function i(){return a(this,i),e.call(this,{name:"BRAR",calcParams:[26],plots:[{key:"br",type:"line"},{key:"ar",type:"line"}]})}return n(i,[{key:"calcTechnicalIndicator",value:function(t,e){var a=0,i=0,n=0,r=0,o=[];return t.forEach((function(c,s){var l={};if(s>0){var h=c.high,u=c.low,d=c.open,v=t[s-1].close;if(n+=h-d,r+=d-u,a+=h-v,i+=v-u,s>=e[0]){l.ar=0!==r?n/r*100:0,l.br=0!==i?a/i*100:0;var p=t[s-(e[0]-1)].high,_=t[s-(e[0]-1)].low,f=t[s-(e[0]-1)].open,y=t[s-e[0]].close;a-=p-y,i-=y-_,n-=p-f,r-=f-_}}o.push(l)})),o}}]),i}(z),X=function(t){o(i,t);var e=l(i);function i(){return a(this,i),e.call(this,{name:"CCI",calcParams:[13],plots:[{key:"cci",type:"line"}]})}return n(i,[{key:"calcTechnicalIndicator",value:function(t,e){var a,i=e[0]-1,n=0,r=0,o=[],c=[];return t.forEach((function(s,l){var h,u={},d=s.close;if(n+=d,o.push(h=i>l?n/(l+1):n/e[0]),r+=Math.abs(h-d),l>=i){u.cci=0!==(a=r/e[0])?((s.high+s.low+d)/3-h)/a/.015:0;var v=t[l-i].close;n-=v,r-=Math.abs(o[l-i]-v)}c.push(u)})),c}}]),i}(z),K=function(t){o(i,t);var e=l(i);function i(){return a(this,i),e.call(this,{name:"DMI",calcParams:[14,6],plots:[{key:"pdi",type:"line"},{key:"mdi",type:"line"},{key:"adx",type:"line"},{key:"adxr",type:"line"}]})}return n(i,[{key:"calcTechnicalIndicator",value:function(t,e){var a=0,i=[],n=0,r=[],o=0,c=[],s=0,l=[],h=[];return t.forEach((function(u,d){var v={};if(d>0){var p=t[d-1].close,_=u.high,f=u.low,y=_-f,m=Math.abs(_-p),k=Math.abs(f-p),g=_-t[d-1].high,x=t[d-1].low-f,w=Math.max(Math.max(y,m),k);a+=w,i.push(w);var b=g>0&&g>x?g:0;n+=b,r.push(b);var P=x>0&&x>g?x:0;if(o+=P,c.push(P),d>=e[0]){var C,T,D;if(0===a?(C=0,T=0):(C=100*n/a,T=100*o/a),s+=D=T+C===0?0:Math.abs(T-C)/(T+C)*100,l.push(D),v.pdi=C,v.mdi=T,d>=e[0]+e[1]-1){var M=s/e[1];v.adx=M,e[0]+2*e[1]-2>d||(v.adxr=(M+h[d-(e[1]-1)].adx)/2),s-=l[d-(e[0]+e[1]-1)]}a-=i[d-e[0]],n-=r[d-e[0]],o-=c[d-e[0]]}}h.push(v)})),h}}]),i}(z),Z=function(t){o(i,t);var e=l(i);function i(){return a(this,i),e.call(this,{name:"CR",calcParams:[26,10,20,40,60],plots:[{key:"cr",type:"line"},{key:"ma1",type:"line"},{key:"ma2",type:"line"},{key:"ma3",type:"line"},{key:"ma4",type:"line"}]})}return n(i,[{key:"calcTechnicalIndicator",value:function(t,e){var a=Math.ceil(e[1]/2.5+1),i=Math.ceil(e[2]/2.5+1),n=Math.ceil(e[3]/2.5+1),r=Math.ceil(e[4]/2.5+1),o=0,c=[],s=0,l=[],h=0,u=[],d=0,v=[],p=[];return t.forEach((function(_,f){var y={};if(f>0){var m=t[f-1],k=(m.high+m.close+m.low+m.open)/4,g=Math.max(0,_.high-k),x=Math.max(0,k-_.low);f>=e[0]&&(y.cr=0!==x?g/x*100:0,o+=y.cr,s+=y.cr,h+=y.cr,d+=y.cr,e[0]+e[1]-1>f||(c.push(o/e[1]),e[0]+e[1]+a-2>f||(y.ma1=c[c.length-1-a]),o-=p[f-(e[1]-1)].cr),e[0]+e[2]-1>f||(l.push(s/e[2]),e[0]+e[2]+i-2>f||(y.ma2=l[l.length-1-i]),s-=p[f-(e[2]-1)].cr),e[0]+e[3]-1>f||(u.push(h/e[3]),e[0]+e[3]+n-2>f||(y.ma3=u[u.length-1-n]),h-=p[f-(e[3]-1)].cr),e[0]+e[4]-1>f||(v.push(d/e[4]),e[0]+e[4]+r-2>f||(y.ma4=v[v.length-1-r]),d-=p[f-(e[4]-1)].cr))}p.push(y)})),p}}]),i}(z),J=function(t){o(i,t);var e=l(i);function i(){return a(this,i),e.call(this,{name:"PSY",calcParams:[12,6],plots:[{key:"psy",type:"line"},{key:"psyMa",type:"line"}]})}return n(i,[{key:"calcTechnicalIndicator",value:function(t,e){var a=0,i=0,n=[],r=[];return t.forEach((function(t,o){var c={},s=t.close-t.open>0?1:0;n.push(s),a+=s,e[0]-1>o||(c.psy=a/e[0]*100,i+=c.psy,e[0]+e[1]-2>o||(c.psyMa=i/e[1],i-=r[o-(e[1]-1)].psy),a-=n[o-(e[0]-1)]),r.push(c)})),r}}]),i}(z),q=function(t){o(i,t);var e=l(i);function i(){return a(this,i),e.call(this,{name:"DMA",calcParams:[10,50,10],plots:[{key:"dma",type:"line"},{key:"ama",type:"line"}]})}return n(i,[{key:"calcTechnicalIndicator",value:function(t,e){var a=Math.max(e[0],e[1]),i=0,n=0,r=0,o=[];return t.forEach((function(c,s){var l,h,u={},d=c.close;if(i+=d,n+=d,e[0]-1>s||(l=i/e[0],i-=t[s-(e[0]-1)].close),e[1]-1>s||(h=n/e[1],n-=t[s-(e[1]-1)].close),s>=a-1){var v=l-h;u.dma=v,r+=v,a+e[2]-2>s||(u.ama=r/e[2],r-=o[s-(e[2]-1)].dma)}o.push(u)})),o}}]),i}(z),$=function(t){o(i,t);var e=l(i);function i(){return a(this,i),e.call(this,{name:"TRIX",calcParams:[12,20],plots:[{key:"trix",type:"line"},{key:"trixMa",type:"line"}]})}return n(i,[{key:"calcTechnicalIndicator",value:function(t,e){var a,i,n,r,o,c,s=0,l=[];return t.forEach((function(t,h){var u={},d=t.close;0===h?(a=d,i=d,n=d):(n=(2*(i=(2*(a=(2*d+(e[0]-1)*r)/(e[0]+1))+(e[0]-1)*o)/(e[0]+1))+(e[0]-1)*c)/(e[0]+1),u.trix=0===c?0:(n-c)/c*100,s+=u.trix,e[1]-1>h||(u.trixMa=s/e[1],s-=l[h-(e[1]-1)].trix||0)),r=a,o=i,c=n,l.push(u)})),l}}]),i}(z),Q=function(t){o(i,t);var e=l(i);function i(){return a(this,i),e.call(this,{name:"OBV",calcParams:[30],plots:[{key:"obv",type:"line"},{key:"obvMa",type:"line"}]})}return n(i,[{key:"calcTechnicalIndicator",value:function(t,e){var a=0,i=[];return t.forEach((function(t,n){var r={},o=t.close,c=t.high-o;r.obv=0===c?0:(o-t.low-c)/c*t.volume,a+=r.obv,e[0]-1>n||(r.obvMa=a/e[0],a-=i[n-(e[0]-1)].obv),i.push(r)})),i}}]),i}(z),tt=function(t){o(i,t);var e=l(i);function i(){return a(this,i),e.call(this,{name:"VR",calcParams:[24,30],plots:[{key:"vr",type:"line"},{key:"vrMa",type:"line"}]})}return n(i,[{key:"calcTechnicalIndicator",value:function(t,e){var a=0,i=0,n=0,r=0,o=[];return t.forEach((function(c,s){var l={},h=c.close,u=c.open,d=c.volume;if(h>u?a+=d:u>h?i+=d:n+=d,s>=e[0]-1){var v=n/2;l.vr=i+v===0?0:(a+v)/(i+v),r+=l.vr,e[0]+e[1]-2>s||(l.vrMa=r/e[1],r-=o[s-(e[1]-1)].vr);var p=t[s-(e[0]-1)],_=p.open,f=p.close,y=p.volume;f>_?a-=y:_>f?i-=y:n-=y}o.push(l)})),o}}]),i}(z),et=function(t){o(i,t);var e=l(i);function i(){return a(this,i),e.call(this,{name:"WR",calcParams:[6,10,14],shouldCheckParamCount:!1,plots:[{key:"wr1",type:"line"},{key:"wr2",type:"line"},{key:"wr3",type:"line"}]})}return n(i,[{key:"regeneratePlots",value:function(t){var e=[];return t.forEach((function(t,a){e.push({key:"wr".concat(a+1),type:"line"})})),e}},{key:"calcTechnicalIndicator",value:function(t,e){var a=this,i=[];return t.forEach((function(n,r){var o={},c=n.close;e.forEach((function(e,i){var n=e-1;if(r>=n){var s=Y(t.slice(r-n,r+1)),l=s.hn,h=l-s.ln;o[a.plots[i].key]=0===h?0:(l-c)/h*100}})),i.push(o)})),i}}]),i}(z),at=function(t){o(i,t);var e=l(i);function i(){return a(this,i),e.call(this,{name:"MTM",calcParams:[6,10],plots:[{key:"mtm",type:"line"},{key:"mtmMa",type:"line"}]})}return n(i,[{key:"calcTechnicalIndicator",value:function(t,e){var a=0,i=[];return t.forEach((function(n,r){var o={};r<e[0]-1||(o.mtm=n.close-t[r-(e[0]-1)].close,a+=o.mtm,e[0]+e[1]-2>r||(o.mtmMa=a/e[1],a-=i[r-(e[1]-1)].mtm)),i.push(o)})),i}}]),i}(z),it=function(t){o(i,t);var e=l(i);function i(){return a(this,i),e.call(this,{name:"SAR",series:O,calcParams:[2,2,20],precision:2,shouldOhlc:!0,plots:[{key:"sar",type:"circle",color:function(t,e){var a=t.currentData,i=a.kLineData||{};return(i.high+i.low)/2>(a.technicalIndicatorData||{}).sar?e.circle.upColor:e.circle.downColor}}]})}return n(i,[{key:"calcTechnicalIndicator",value:function(t,e){var a=e[0]/100,i=e[1]/100,n=e[2]/100,r=a,o=-100,c=!1,s=0,l=[];return t.forEach((function(e,h){var u=s,d=e.high,v=e.low;if(c){(-100===o||d>o)&&(o=d,r=Math.min(r+i,n)),s=u+r*(o-u);var p=Math.min(t[Math.max(1,h)-1].low,v);s>e.low?(s=o,r=a,o=-100,c=!c):s>p&&(s=p)}else{(-100===o||o>v)&&(o=v,r=Math.min(r+i,n)),s=u+r*(o-u);var _=Math.max(t[Math.max(1,h)-1].high,d);e.high>s?(s=o,r=0,o=-100,c=!c):_>s&&(s=_)}l.push({sar:s})})),l}}]),i}(z),nt=function(t){o(i,t);var e=l(i);function i(){return a(this,i),e.call(this,{name:"EMV",calcParams:[14,9],plots:[{key:"emv",type:"line"},{key:"emvMa",type:"line"}]})}return n(i,[{key:"calcTechnicalIndicator",value:function(t,e){var a=0,i=0,n=[],r=[];return t.forEach((function(o,c){var s={};if(c>0){var l=o.high,h=o.low,u=((l+h)/2-(t[c-1].high+t[c-1].low)/2)*(l-h)-(o.turnover||0);n.push(u),a+=u,e[0]>c||(s.emv=a/e[0],i+=s.emv,e[0]+e[1]-1>c||(s.emvMa=i/e[1],i-=r[c-(e[1]-1)].emv),a-=n[c-e[0]])}r.push(s)})),r}}]),i}(z);function rt(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1?arguments[1]:void 0,a=arguments.length>2?arguments[2]:void 0,i=e.calcParams,n=e.plots,r=e.precision,o=e.shouldFormatBigNumber,c=[],s=[],l="";return n.length>0&&(l=e.name),i.length>0&&(l="".concat(l,"(").concat(i.join(","),")")),n.forEach((function(e){c.push(e.key.toUpperCase());var i,n=t[e.key];k(n)&&(i=a.convertToPixel(n),n=L(n,r),o&&(n=A(n))),s.push({value:n,y:i})})),{labels:c,values:s,name:l}}var ot="none",ct="horizontalStraightLine",st="verticalStraightLine",lt="straightLine",ht="horizontalRayLine",ut="verticalRayLine",dt="rayLine",vt="horizontalSegmentLine",pt="verticalSegmentLine",_t="segmentLine",ft="priceLine",yt="priceChannelLine",mt="parallelStraightLine",kt="fibonacciLine",gt=function(){function t(e,i){var n;a(this,t),this._invalidateHandler=i,this._styleOptions=p(S),v(this._styleOptions,e),this._technicalIndicators=(r(n={},"MA",{structure:V,series:O,precision:2,calcParams:[5,10,30,60]}),r(n,"EMA",{structure:H,series:O,precision:2,calcParams:[6,12,20]}),r(n,"VOL",{structure:B,series:R,precision:0,calcParams:[5,10,20]}),r(n,"MACD",{structure:N,precision:4,calcParams:[12,26,9]}),r(n,"BOLL",{structure:F,series:O,precision:2,calcParams:[20]}),r(n,"KDJ",{structure:W,precision:4,calcParams:[9,3,3]}),r(n,"RSI",{structure:j,precision:4,calcParams:[6,12,24]}),r(n,"BIAS",{structure:G,precision:4,calcParams:[6,12,24]}),r(n,"BRAR",{structure:U,precision:4,calcParams:[26]}),r(n,"CCI",{structure:X,precision:4,calcParams:[13]}),r(n,"DMI",{structure:K,precision:4,calcParams:[14,6]}),r(n,"CR",{structure:Z,precision:4,calcParams:[26,10,20,40,60]}),r(n,"PSY",{structure:J,precision:4,calcParams:[12,6]}),r(n,"DMA",{structure:q,precision:4,calcParams:[10,50,10]}),r(n,"TRIX",{structure:$,precision:4,calcParams:[12,20]}),r(n,"OBV",{structure:Q,precision:4,calcParams:[30]}),r(n,"VR",{structure:tt,precision:4,calcParams:[24,30]}),r(n,"WR",{structure:et,precision:4,calcParams:[6,10,14]}),r(n,"MTM",{structure:at,precision:4,calcParams:[6,10]}),r(n,"EMV",{structure:nt,precision:4,calcParams:[14,9]}),r(n,"SAR",{structure:it,series:O,precision:2,calcParams:[2,2,20]}),n),this._pricePrecision=2,this._volumePrecision=0,this._dateTimeFormat=new Intl.DateTimeFormat("en",{hour12:!1,year:"numeric",month:"numeric",day:"numeric",hour:"numeric",minute:"numeric"}),this._dataList=[],this._loading=!0,this._loadMoreCallback=null,this._more=!0,this._totalDataSpace=0,this._dataSpace=6,this._barSpace=this._calcBarSpace(),this._offsetRightSpace=50,this._offsetRightBarCount=this._offsetRightSpace/this._dataSpace,this._leftMinVisibleBarCount=2,this._rightMinVisibleBarCount=2,this._from=0,this._to=0,this._crossHair={},this._preOffsetRightBarCount=0,this._graphicMarkType=ot,this._graphicMarkPoint=null,this._dragGraphicMarkFlag=!1,this._graphicMarkDatas={horizontalStraightLine:[],verticalStraightLine:[],straightLine:[],horizontalRayLine:[],verticalRayLine:[],rayLine:[],horizontalSegmentLine:[],verticalSegmentLine:[],segmentLine:[],priceLine:[],parallelStraightLine:[],priceChannelLine:[],fibonacciLine:[]}}return n(t,[{key:"_loadMoreHandler",value:function(){this._more&&!this._loading&&this._loadMoreCallback&&f(this._loadMoreCallback)&&(this._loading=!0,this._loadMoreCallback(E(this._dataList[0],"timestamp")))}},{key:"_calcBarSpace",value:function(){return Math.max(1,Math.min(Math.floor(.8*this._dataSpace),Math.floor(this._dataSpace)-1))}},{key:"_innerSetDataSpace",value:function(t){return!(!t||3>t||t>30||this._dataSpace===t)&&(this._dataSpace=t,this._barSpace=this._calcBarSpace(),!0)}},{key:"styleOptions",value:function(){return this._styleOptions}},{key:"applyStyleOptions",value:function(t){v(this._styleOptions,t)}},{key:"technicalIndicatorCalcParams",value:function(){var t={};for(var e in this._technicalIndicators)t[e]=p(this._technicalIndicators[e].calcParams);return t}},{key:"technicalIndicator",value:function(t){return this._technicalIndicators[t]||{}}},{key:"pricePrecision",value:function(){return this._pricePrecision}},{key:"volumePrecision",value:function(){return this._volumePrecision}},{key:"dateTimeFormat",value:function(){return this._dateTimeFormat}},{key:"setTimezone",value:function(t){var e;try{e=new Intl.DateTimeFormat("en",{hour12:!1,timeZone:t,year:"numeric",month:"numeric",day:"numeric",hour:"numeric",minute:"numeric"})}catch(t){}e&&(this._dateTimeFormat=e)}},{key:"timezone",value:function(){return this._dateTimeFormat.resolvedOptions().timeZone}},{key:"applyPrecision",value:function(t,e){var a=k(t)&&m(t)&&t>=0,i=k(e)&&m(e)&&e>=0;if(a&&(this._pricePrecision=t),i&&(this._volumePrecision=e),a||i)for(var n in this._technicalIndicators)switch(this._technicalIndicators[n].series){case O:this._technicalIndicators[n].precision=t;break;case R:this._technicalIndicators[n].precision=e}}},{key:"applyTechnicalIndicatorPrecision",value:function(t,e){var a=this.technicalIndicator(e);if(a)a.precision=t;else for(var i in this._technicalIndicators)this._technicalIndicators[i].precision=t}},{key:"dataList",value:function(){return this._dataList}},{key:"clearDataList",value:function(){this._more=!0,this._loading=!0,this._dataList=[],this._from=0,this._to=0}},{key:"addData",value:function(t,e,a){if(y(t))if(_(t)){this._loading=!1,this._more=!g(a)||a;var i=0===this._dataList.length;this._dataList=t.concat(this._dataList),i?this.setOffsetRightSpace(this._offsetRightSpace):this.adjustOffsetBarCount()}else this._dataList.length>e?this._dataList[e]=t:(this._dataList.push(t),0>this._offsetRightBarCount&&(this._offsetRightBarCount-=1),this.adjustOffsetBarCount())}},{key:"dataSpace",value:function(){return this._dataSpace}},{key:"barSpace",value:function(){return this._barSpace}},{key:"offsetRightBarCount",value:function(){return this._offsetRightBarCount}},{key:"setDataSpace",value:function(t){this._innerSetDataSpace(t)&&(this.adjustOffsetBarCount(),this._invalidateHandler())}},{key:"setTotalDataSpace",value:function(t){this._totalDataSpace!==t&&(this._totalDataSpace=t,this.adjustOffsetBarCount())}},{key:"setOffsetRightSpace",value:function(t){this._offsetRightSpace=t,this._offsetRightBarCount=t/this._dataSpace,this.adjustOffsetBarCount()}},{key:"setLeftMinVisibleBarCount",value:function(t){m(t)&&t>0&&(this._leftMinVisibleBarCount=Math.ceil(t))}},{key:"setRightMinVisibleBarCount",value:function(t){m(t)&&t>0&&(this._rightMinVisibleBarCount=Math.ceil(t))}},{key:"from",value:function(){return this._from}},{key:"to",value:function(){return this._to}},{key:"crossHair",value:function(){return this._crossHair}},{key:"setCrossHairPointPaneTag",value:function(t,e){var a={};t&&(a.x=t.x,a.y=t.y,a.paneTag=this._crossHair.paneTag),void 0!==e&&(a.paneTag=e,this._crossHair=a,this._invalidateHandler(2))}},{key:"startScroll",value:function(){this._preOffsetRightBarCount=this._offsetRightBarCount}},{key:"scroll",value:function(t){this._offsetRightBarCount=this._preOffsetRightBarCount-t/this._dataSpace,this.adjustOffsetBarCount(),this._invalidateHandler()}},{key:"coordinateToFloatIndex",value:function(t){return Math.round(1e6*(this._dataList.length+this._offsetRightBarCount-(this._totalDataSpace-t)/this._dataSpace))/1e6}},{key:"zoom",value:function(t,e){e&&!k(e.x)||(e={x:k(this._crossHair.x)?this._crossHair.x:this._totalDataSpace/2});var a=this.coordinateToFloatIndex(e.x);this._innerSetDataSpace(this._dataSpace+t*(this._dataSpace/10))&&(this._offsetRightBarCount+=a-this.coordinateToFloatIndex(e.x),this.adjustOffsetBarCount(),this._invalidateHandler())}},{key:"adjustOffsetBarCount",value:function(){var t=this._dataList.length,e=this._totalDataSpace/this._dataSpace,a=1-this._barSpace/2/this._dataSpace,i=e-Math.min(this._leftMinVisibleBarCount,t)+a;this._offsetRightBarCount>i&&(this._offsetRightBarCount=i);var n=1-t+Math.min(this._rightMinVisibleBarCount,t)-a;n>this._offsetRightBarCount&&(this._offsetRightBarCount=n),this._to=Math.round(this._offsetRightBarCount+t),this._from=Math.floor(this._to-e)-1,this._to>t&&(this._to=t),0>this._from&&(this._from=0),0===this._from&&this._loadMoreHandler()}},{key:"graphicMarkType",value:function(){return this._graphicMarkType}},{key:"setGraphicMarkType",value:function(t){this._graphicMarkType=t}},{key:"dragGraphicMarkFlag",value:function(){return this._dragGraphicMarkFlag}},{key:"setDragGraphicMarkFlag",value:function(t){this._dragGraphicMarkFlag=t}},{key:"graphicMarkPoint",value:function(){return this._graphicMarkPoint}},{key:"setGraphicMarkPoint",value:function(t){this._graphicMarkPoint=t}},{key:"graphicMarkData",value:function(){return p(this._graphicMarkDatas)}},{key:"setGraphicMarkData",value:function(t){var e=this.shouldInvalidateGraphicMark();this._graphicMarkDatas=p(t),(e||this.shouldInvalidateGraphicMark())&&this._invalidateHandler(1)}},{key:"loadMore",value:function(t){this._loadMoreCallback=t}},{key:"shouldInvalidateGraphicMark",value:function(){if(this._graphicMarkType!==ot)return!0;for(var t in this._graphicMarkDatas)if(this._graphicMarkDatas[t].length>0)return!0;return!1}},{key:"addCustomTechnicalIndicator",value:function(t){var e=function(t){var e=t.name,i=t.series,n=t.calcParams,r=t.plots,c=t.precision,s=t.shouldCheckParamCount,h=t.shouldOhlc,u=t.shouldFormatBigNumber,d=t.baseValue,v=t.minValue,p=t.maxValue,y=t.calcTechnicalIndicator,g=t.regeneratePlots;if(!e||!f(y))return null;var x=function(t){o(f,t);var _=l(f);function f(){return a(this,f),_.call(this,{name:e,series:i,calcParams:n,plots:r,precision:c,shouldCheckParamCount:s,shouldOhlc:h,shouldFormatBigNumber:u,baseValue:d,minValue:v,maxValue:p})}return f}(z);return x.prototype.calcTechnicalIndicator=y,g&&(x.prototype.regeneratePlots=g),{structure:x,series:i||"normal",precision:k(c)&&m(c)&&c>=0?c:i===O?2:i===R?0:4,calcParams:_(n)?n:[]}}(t||{});e&&(this._technicalIndicators[t.name]=e)}},{key:"calcTechnicalIndicator",value:function(t){var e=t.technicalIndicator();if(e){var a=this._technicalIndicators[e.name]||{},i=a.calcParams,n=a.precision;e.setPrecision(k(n)?n:this._pricePrecision),e.setCalcParams(i),e.result=e.calcTechnicalIndicator(this._dataList,e.calcParams)||[],t.computeAxis()}}}]),t}();function xt(t){return(window.devicePixelRatio||1)/(t.backingStorePixelRatio||t.webkitBackingStorePixelRatio||t.mozBackingStorePixelRatio||t.msBackingStorePixelRatio||t.oBackingStorePixelRatio||t.backingStorePixelRatio||1)}function wt(t,e){return Math.round(t.measureText(e).width)}function bt(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:12,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"normal",a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Helvetica Neue";return"".concat(e," ").concat(t,"px ").concat(a)}function Pt(t,e,a,i){t.beginPath();var n=t.lineWidth%2?.5:0;t.moveTo(a,e+n),t.lineTo(i,e+n),t.stroke(),t.closePath()}function Ct(t,e,a,i){t.beginPath();var n=t.lineWidth%2?.5:0;t.moveTo(e+n,a),t.lineTo(e+n,i),t.stroke(),t.closePath()}function Tt(t,e){t.save(),t.lineWidth%2&&t.translate(.5,.5),e(),t.restore()}var Dt=function(){function t(e){a(this,t),this._height=-1,this._container=e.container,this._chartData=e.chartData,this._initBefore(e),this._initElement(),this._mainWidget=this._createMainWidget(this._element,e),this._yAxisWidget=this._createYAxisWidget(this._element,e)}return n(t,[{key:"_initBefore",value:function(t){}},{key:"_initElement",value:function(){this._element=document.createElement("div"),this._element.style.margin="0",this._element.style.padding="0",this._element.style.position="relative",this._element.style.overflow="hidden",this._element.style.width="100%";var t=this._container.lastChild;t?this._container.insertBefore(this._element,t):this._container.appendChild(this._element)}},{key:"_createMainWidget",value:function(t,e){}},{key:"_createYAxisWidget",value:function(t,e){}},{key:"computeAxis",value:function(){}},{key:"width",value:function(){return this._element.offsetWidth}},{key:"setWidth",value:function(t,e){this._mainWidget.setWidth(t),this._yAxisWidget&&this._yAxisWidget.setWidth(e)}},{key:"height",value:function(){return this._height}},{key:"setHeight",value:function(t){this._height=t,this._mainWidget.setHeight(t),this._yAxisWidget&&this._yAxisWidget.setHeight(t)}},{key:"setOffsetLeft",value:function(t,e){this._mainWidget.setOffsetLeft(t),this._yAxisWidget&&this._yAxisWidget.setOffsetLeft(e)}},{key:"layout",value:function(){this._element.offsetHeight!==this._height&&(this._element.style.height="".concat(this._height,"px")),this._mainWidget.layout(),this._yAxisWidget&&this._yAxisWidget.layout()}},{key:"invalidate",value:function(t){this._yAxisWidget&&this._yAxisWidget.invalidate(t),this._mainWidget.invalidate(t)}},{key:"getImage",value:function(t,e){var a=document.createElement("canvas"),i=a.getContext("2d"),n=xt(i),r=this._element.offsetWidth,o=this._element.offsetHeight;a.style.width="".concat(r,"px"),a.style.height="".concat(o,"px"),a.width=r*n,a.height=o*n,i.scale(n,n);var c=this._mainWidget.getElement(),s=c.offsetWidth,l=c.offsetHeight,h=parseInt(c.style.left,10);if(i.drawImage(this._mainWidget.getImage(t,e),h,0,s,l),this._yAxisWidget){var u=this._yAxisWidget.getElement(),d=u.offsetWidth,v=u.offsetHeight,p=parseInt(u.style.left,10);i.drawImage(this._yAxisWidget.getImage(t),p,0,d,v)}return a}},{key:"destroy",value:function(){this._container.removeChild(this._element)}}]),t}(),Mt=function(){function t(e){a(this,t),this._width=0,this._height=0,this._initElement(e.container),this._mainView=this._createMainView(this._element,e),this._expandView=this._createExpandView(this._element,e),this._floatLayerView=this._createFloatLayerView(this._element,e)}return n(t,[{key:"_initElement",value:function(t){this._element=document.createElement("div"),this._element.style.top="0",this._element.style.margin="0",this._element.style.padding="0",this._element.style.position="absolute",this._element.style.overflow="hidden",t.appendChild(this._element)}},{key:"_createMainView",value:function(t,e){}},{key:"_createExpandView",value:function(t,e){}},{key:"_createFloatLayerView",value:function(t,e){}},{key:"getElement",value:function(){return this._element}},{key:"setWidth",value:function(t){this._width=t,this._mainView.setWidth(t),this._floatLayerView.setWidth(t),this._expandView&&this._expandView.setWidth(t)}},{key:"setHeight",value:function(t){this._height=t,this._mainView.setHeight(t),this._floatLayerView.setHeight(t),this._expandView&&this._expandView.setHeight(t)}},{key:"setOffsetLeft",value:function(t){this._element.style.left="".concat(t,"px")}},{key:"layout",value:function(){this._element.offsetWidth!==this._width&&(this._element.style.width="".concat(this._width,"px")),this._element.offsetHeight!==this._height&&(this._element.style.height="".concat(this._height,"px")),this._mainView.layout(),this._floatLayerView.layout(),this._expandView&&this._expandView.layout()}},{key:"invalidate",value:function(t){switch(t){case 2:this._floatLayerView.flush();break;case 3:case 4:this._mainView.flush(),this._floatLayerView.flush()}}},{key:"getImage",value:function(t,e){var a=document.createElement("canvas"),i=a.getContext("2d"),n=xt(i);return a.style.width="".concat(this._width,"px"),a.style.height="".concat(this._height,"px"),a.width=this._width*n,a.height=this._height*n,i.scale(n,n),i.drawImage(this._mainView.getImage(),0,0,this._width,this._height),e&&this._expandView&&i.drawImage(this._expandView.getImage(),0,0,this._width,this._height),t&&i.drawImage(this._floatLayerView.getImage(),0,0,this._width,this._height),a}}]),t}(),St="circle",Et=function(){function t(e,i){a(this,t),this._chartData=i,this._initCanvas(e)}return n(t,[{key:"_initCanvas",value:function(t){this._canvas=document.createElement("canvas"),this._canvas.style.position="absolute",this._canvas.style.top="0",this._canvas.style.left="0",this._canvas.style.zIndex="2",this._ctx=this._canvas.getContext("2d"),t.appendChild(this._canvas)}},{key:"_redraw",value:function(t){this._ctx.clearRect(0,0,this._canvas.offsetWidth,this._canvas.offsetHeight),t&&t(),this._draw()}},{key:"_draw",value:function(){}},{key:"setWidth",value:function(t){this._width=t}},{key:"setHeight",value:function(t){this._height=t}},{key:"layout",value:function(){var t=this;this._height!==this._canvas.offsetHeight||this._width!==this._canvas.offsetWidth?this._redraw((function(){var e=xt(t._ctx);t._canvas.style.width="".concat(t._width,"px"),t._canvas.style.height="".concat(t._height,"px"),t._canvas.width=t._width*e,t._canvas.height=t._height*e,t._ctx.scale(e,e)})):this.flush()}},{key:"flush",value:function(){var t,e,a=this;this.requestAnimationId&&(t=this.requestAnimationId,window.cancelAnimationFrame||clearTimeout(t),window.cancelAnimationFrame(t)),this.requestAnimationId=(e=function(){a._redraw()},window.requestAnimationFrame?window.requestAnimationFrame(e):window.setTimeout((function(){e()}),1e3/60))}},{key:"getImage",value:function(){return this._canvas}}]),t}(),It=function(t){o(i,t);var e=l(i);function i(t,n,r,o,c){var s;return a(this,i),(s=e.call(this,t,n))._xAxis=r,s._yAxis=o,s._additionalDataProvider=c,s}return n(i,[{key:"_draw",value:function(){this._drawGrid(),this._drawTechnicalIndicator()}},{key:"_drawGrid",value:function(){var t=this,e=this._chartData.styleOptions().grid;if(e.display){var a=e.horizontal;this._ctx.save(),a.display&&(this._ctx.strokeStyle=a.color,this._ctx.lineWidth=a.size,a.style===x&&this._ctx.setLineDash(a.dashValue),this._yAxis.ticks().forEach((function(e){Pt(t._ctx,e.y,0,t._width)})));var i=e.vertical;i.display&&(this._ctx.strokeStyle=i.color,this._ctx.lineWidth=i.size,this._ctx.setLineDash(i.style===x?i.dashValue:[]),this._xAxis.ticks().forEach((function(e){Ct(t._ctx,e.x,0,t._height)}))),this._ctx.restore()}}},{key:"_drawTechnicalIndicator",value:function(){var t=this,e=this._additionalDataProvider.technicalIndicator(),a=e.plots,i=[],n=this._chartData.styleOptions().technicalIndicator,r=this._chartData.dataList(),o=e.result,c=e.baseValue;k(c)||(c=this._yAxis.min());var s=this._yAxis.convertToPixel(c),l=this._yAxis.isCandleStickYAxis();this._ctx.lineWidth=1,this._drawGraphics((function(c,h,u,d,v){var p=o[h]||{},_=0;e.shouldOhlc&&!l&&t._drawCandleStickBar(c,d,v,u,n.bar,"ohlc"),a.forEach((function(e){var a=p[e.key];switch(e.type){case St:if(k(a)){var l={preData:{kLineData:r[h-1],technicalIndicatorData:o[h-1]},currentData:{kLineData:u,technicalIndicatorData:p}},v=t._yAxis.convertToPixel(a),f={x:c,y:v,radius:d,color:e.color&&e.color(l,n)||n.circle.noChangeColor,isStroke:!e.isStroke||e.isStroke(l)};t._drawCircle(f)}break;case"bar":if(k(a)){var y={preData:{kLineData:r[h-1],technicalIndicatorData:o[h-1]},currentData:{kLineData:u,technicalIndicatorData:p}},m=t._yAxis.convertToPixel(a),g=Math.abs(s-m),x={x:c-d,width:2*d,height:Math.max(1,g)};x.y=m>s?s:1>g?s+1:m,x.color=e.color&&e.color(y,n)||n.bar.noChangeColor,x.isStroke=!!e.isStroke&&e.isStroke(y),t._drawBar(x)}break;default:if(k(a)){var w=t._yAxis.convertToPixel(a),b={x:c,y:w};i[_]?i[_].push(b):i[_]=[b]}else i[_]?i[_].push(null):i[_]=[null];_++}}))}),(function(){t._drawLines(i,n)}))}},{key:"_drawLines",value:function(t,e){var a=this,i=e.line.colors,n=(i||[]).length;this._ctx.lineWidth=e.line.size,Tt(this._ctx,(function(){t.forEach((function(t,e){a._ctx.strokeStyle=i[e%n],a._ctx.beginPath();var r=!0;t.forEach((function(t){k(t)&&(r?(a._ctx.moveTo(t.x,t.y),r=!1):a._ctx.lineTo(t.x,t.y))})),a._ctx.stroke(),a._ctx.closePath()}))}))}},{key:"_drawBar",value:function(t){t.isStroke?(this._ctx.strokeStyle=t.color,this._ctx.strokeRect(t.x+.5,t.y,t.width-1,t.height)):(this._ctx.fillStyle=t.color,this._ctx.fillRect(t.x,t.y,t.width,t.height))}},{key:"_drawCircle",value:function(t){this._ctx.strokeStyle=t.color,this._ctx.fillStyle=t.color,this._ctx.beginPath(),this._ctx.arc(t.x,t.y,t.radius,2*Math.PI,0,!0),t.isStroke?this._ctx.stroke():this._ctx.fill(),this._ctx.closePath()}},{key:"_drawGraphics",value:function(t,e){for(var a=this._chartData.dataList(),i=a.length,n=this._chartData.barSpace(),r=this._chartData.dataSpace(),o=n/2,c=this._chartData.offsetRightBarCount(),s=this._chartData.to(),l=this._chartData.from();s>l;l++)t(this._width-(i+c-l-.5)*r+o,l,a[l],o,n);e&&e()}},{key:"_drawCandleStickBar",value:function(t,e,a,i,n,r){var o=i.open,c=i.close,s=i.high,l=i.low;c>o?(this._ctx.strokeStyle=n.upColor,this._ctx.fillStyle=n.upColor):o>c?(this._ctx.strokeStyle=n.downColor,this._ctx.fillStyle=n.downColor):(this._ctx.strokeStyle=n.noChangeColor,this._ctx.fillStyle=n.noChangeColor);var h=this._yAxis.convertToPixel(o),u=this._yAxis.convertToPixel(c),d=this._yAxis.convertToPixel(s),v=this._yAxis.convertToPixel(l),p=Math.min(h,u),_=Math.max(h,u);this._ctx.fillRect(t-.5,d,1,p-d),this._ctx.fillRect(t-.5,_,1,v-_);var f=Math.max(1,_-p);switch(r){case T:this._ctx.fillRect(t-e,p,a,f);break;case"stroke":this._ctx.strokeRect(t-e+.5,p,a-1,f);break;case"up_stroke":c>o?this._ctx.strokeRect(t-e+.5,p,a-1,f):this._ctx.fillRect(t-e,p,a,f);break;case"down_stroke":c>o?this._ctx.fillRect(t-e,p,a,f):this._ctx.strokeRect(t-e+.5,p,a-1,f);break;default:this._ctx.fillRect(t-.5,d,1,v-d),this._ctx.fillRect(t-e,h-.5,e,1),this._ctx.fillRect(t,u-.5,e,1)}}}]),i}(Et),Lt=function(t){o(i,t);var e=l(i);function i(t,n,r,o,c){var s;return a(this,i),(s=e.call(this,t,n))._xAxis=r,s._yAxis=o,s._additionalDataProvider=c,s}return n(i,[{key:"_draw",value:function(){var t,e=this._chartData.crossHair(),a=this._chartData.dataList(),i=this._additionalDataProvider.technicalIndicator(),n=i.result,r=t=k(e.x)?this._xAxis.convertFromPixel(e.x):a.length-1;0>r?r=0:r>a.length-1&&(r=a.length-1);var o=a[r],c=n[r];if(o){var s=this._xAxis.convertToPixel(t);this._drawCrossHairHorizontalLine(e),this._drawCrossHairVerticalLine(e,s);var l=this._chartData.styleOptions().floatLayer.prompt.displayRule;(l===D||"follow_cross"===l&&e.paneTag)&&this._drawPrompt(o,c,t,s,i,t>=0&&a.length-1>=t&&e.paneTag)}}},{key:"_drawPrompt",value:function(t,e,a,i,n,r){this._drawTechnicalIndicatorPrompt(e,a,i,n,r)}},{key:"_drawCrossHairHorizontalLine",value:function(t){if(t.paneTag===this._additionalDataProvider.tag()){var e=this._chartData.styleOptions().floatLayer.crossHair,a=e.horizontal,i=a.line;e.display&&a.display&&i.display&&(this._ctx.save(),this._ctx.lineWidth=i.size,this._ctx.strokeStyle=i.color,i.style===x&&this._ctx.setLineDash(i.dashValue),Pt(this._ctx,t.y,0,this._width),this._ctx.restore())}}},{key:"_drawCrossHairVerticalLine",value:function(t,e){if(t.paneTag){var a=this._chartData.styleOptions().floatLayer.crossHair,i=a.vertical,n=i.line;a.display&&i.display&&n.display&&(this._ctx.save(),this._ctx.lineWidth=n.size,this._ctx.strokeStyle=n.color,n.style===x&&this._ctx.setLineDash(n.dashValue),Ct(this._ctx,e,0,this._height),this._ctx.restore())}}},{key:"_drawTechnicalIndicatorPrompt",value:function(t,e,a,i,n){var r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,o=this._chartData.styleOptions().technicalIndicator,c=rt(t,i,this._yAxis),s=o.line.colors;this._drawTechnicalIndicatorPromptText(e,i,c,s,r),n&&this._drawTechnicalIndicatorPromptPoint(e,a,i,c.values,s)}},{key:"_drawTechnicalIndicatorPromptText",value:function(t,e,a,i,n){var r=this._chartData.dataList(),o=this._chartData.styleOptions().technicalIndicator,c={preData:{kLineData:r[t-1],technicalIndicatorData:e.result[t-1]},currentData:{kLineData:r[t],technicalIndicatorData:e.result[t]}},s=e.plots,l=this._chartData.styleOptions().floatLayer.prompt.technicalIndicator.text,h=a.name,u=a.labels,d=a.values,v=l.marginLeft,p=l.marginRight,_=v,f=l.marginTop+n,y=l.size,m=l.color,k=i.length;this._ctx.textBaseline="top",this._ctx.font=bt(y,l.weight,l.family);var g=wt(this._ctx,h);this._ctx.fillStyle=m,this._ctx.fillText(h,_,f),_+=v+g;for(var x=0,w=0;u.length>w;w++){switch(s[w].type){case St:this._ctx.fillStyle=s[w].color&&s[w].color(c,o)||o.circle.noChangeColor;break;case"bar":this._ctx.fillStyle=s[w].color&&s[w].color(c,o)||o.bar.noChangeColor;break;default:this._ctx.fillStyle=i[x%k]||m,x++}var b="".concat(u[w],": ").concat(d[w].value||"n/a"),P=wt(this._ctx,b);this._ctx.fillText(b,_,f),_+=v+p+P}}},{key:"_drawTechnicalIndicatorPromptPoint",value:function(t,e,a,i,n){var r=this._chartData.styleOptions().floatLayer.prompt.technicalIndicator.point;if(r.display)for(var o=a.plots,c=n.length,s=i.length,l=r.radius,h=0,u=0;s>u;u++)"line"===o[u].type&&(k(i[u].value)&&(this._ctx.fillStyle=n[h%c],this._ctx.beginPath(),this._ctx.arc(e,i[u].y,l,0,2*Math.PI),this._ctx.closePath(),this._ctx.fill()),h++)}}]),i}(Et),At=function(t){o(i,t);var e=l(i);function i(){return a(this,i),e.apply(this,arguments)}return n(i,[{key:"_createMainView",value:function(t,e){return new It(t,e.chartData,e.xAxis,e.yAxis,e.additionalDataProvider)}},{key:"_createFloatLayerView",value:function(t,e){return new Lt(t,e.chartData,e.xAxis,e.yAxis,e.additionalDataProvider)}}]),i}(Mt),Ot=function(t){o(i,t);var e=l(i);function i(t,n,r,o){var c;return a(this,i),(c=e.call(this,t,n))._yAxis=r,c._additionalDataProvider=o,c}return n(i,[{key:"_draw",value:function(){var t=this._chartData.styleOptions().yAxis;t.display&&(this._drawAxisLine(t),this._drawTickLines(t),this._drawTickLabels(t),this._drawTechnicalIndicatorLastValue(t),this._drawLastPriceLabel(t))}},{key:"_drawAxisLine",value:function(t){var e,a=t.axisLine;a.display&&(this._ctx.strokeStyle=a.color,this._ctx.lineWidth=a.size,e=this._isDrawFromStart(t)?0:this._width-1,Ct(this._ctx,e,0,this._height))}},{key:"_drawTickLines",value:function(t){var e=this,a=t.tickLine;if(a.display){this._ctx.lineWidth=a.size,this._ctx.strokeStyle=a.color;var i,n,r=a.length;this._isDrawFromStart(t)?(i=0,t.axisLine.display&&(i+=t.axisLine.size),n=i+r):(i=this._width,t.axisLine.display&&(i-=t.axisLine.size),n=i-r),this._yAxis.ticks().forEach((function(t){Pt(e._ctx,t.y,i,n)}))}}},{key:"_drawTickLabels",value:function(t){var e=this,a=t.tickText;if(a.display){var i,n=t.tickLine,r=n.display,o=n.length;this._isDrawFromStart(t)?(i=a.paddingLeft,t.axisLine.display&&(i+=t.axisLine.size),r&&(i+=o),this._ctx.textAlign="left"):(i=this._width-a.paddingRight,t.axisLine.display&&(i-=t.axisLine.size),r&&(i-=o),this._ctx.textAlign="right"),this._ctx.textBaseline="middle",this._ctx.font=bt(a.size,a.weight,a.family),this._ctx.fillStyle=a.color,this._yAxis.ticks().forEach((function(t){e._ctx.fillText(t.v,i,t.y)})),this._ctx.textAlign="left"}}},{key:"_drawTechnicalIndicatorLastValue",value:function(t){var e=this,a=this._chartData.styleOptions().technicalIndicator,i=a.lastValueMark,n=this._additionalDataProvider.technicalIndicator(),r=n.result,o=r.length,c=r[o-1];if(i.display&&c){var s=this._chartData.dataList(),l={preData:{kLineData:s[o-2],technicalIndicatorData:r[o-2]},currentData:{kLineData:s[o-1],technicalIndicatorData:c}},h=n.precision,u=a.line.colors||[],d=u.length,v=0;n.plots.forEach((function(n){var r,o=c[n.key];switch(n.type){case St:r=n.color&&n.color(l,a)||a.circle.noChangeColor;break;case"bar":r=n.color&&n.color(l,a)||a.bar.noChangeColor;break;default:r=u[v%d],v++}k(o)&&e._drawMarkLabel(t,o,h,i.textSize,i.textWeight,i.textFamily,i.textColor,r,i.textPaddingLeft,i.textPaddingTop,i.textPaddingRight,i.textPaddingBottom)}))}}},{key:"_drawLastPriceLabel",value:function(t){if(this._yAxis.isCandleStickYAxis()){var e=this._chartData.styleOptions().candleStick.priceMark,a=e.last,i=this._chartData.dataList(),n=i.length;if(e.display&&a.display&&a.text.display&&0!==n){var r,o=i[n-1],c=o.close,s=o.open;r=c>s?a.upColor:s>c?a.downColor:a.noChangeColor;var l=a.text;this._drawMarkLabel(t,c,this._chartData.pricePrecision(),l.size,l.weight,l.family,l.color,r,l.paddingLeft,l.paddingTop,l.paddingRight,l.paddingBottom)}}}},{key:"_drawMarkLabel",value:function(t,e,a,i,n,r,o,c,s,l,h,u){var d,v=this._yAxis.convertToPixel(e);if(v=+Math.max(.05*this._height,Math.min(v,.98*this._height)).toFixed(0),this._yAxis.isPercentageYAxis()){var p=this._chartData.dataList()[this._chartData.from()].close;d="".concat(((e-p)/p*100).toFixed(2),"%")}else d=L(e,a),this._additionalDataProvider.technicalIndicator().shouldFormatBigNumber&&(d=A(d));this._ctx.font=bt(i,n,r);var _,f=wt(this._ctx,d)+s+h,y=l+i+u;_=this._isDrawFromStart(t)?0:this._width-f,this._ctx.fillStyle=c,this._ctx.fillRect(_,v-l-i/2,f,y),this._ctx.fillStyle=o,this._ctx.textBaseline="middle",this._ctx.fillText(d,_+s,v)}},{key:"_isDrawFromStart",value:function(t){return t.position===w&&t.inside||t.position===b&&!t.inside}}]),i}(Et),Rt=function(t){o(i,t);var e=l(i);function i(t,n,r,o){var c;return a(this,i),(c=e.call(this,t,n))._yAxis=r,c._additionalDataProvider=o,c}return n(i,[{key:"_draw",value:function(){this._drawCrossHairLabel()}},{key:"_drawCrossHairLabel",value:function(){var t=this._chartData.crossHair();if(t.paneTag===this._additionalDataProvider.tag()&&0!==this._chartData.dataList().length){var e=this._chartData.styleOptions().floatLayer.crossHair,a=e.horizontal,i=a.text;if(e.display&&a.display&&i.display){var n,r=this._yAxis.convertFromPixel(t.y);if(this._yAxis.isPercentageYAxis()){var o=this._chartData.dataList()[this._chartData.from()].close;n="".concat(((r-o)/o*100).toFixed(2),"%")}else{var c=this._additionalDataProvider.technicalIndicator();n=L(r,this._yAxis.isCandleStickYAxis()?this._chartData.pricePrecision():c.precision),c.shouldFormatBigNumber&&(n=A(n))}var s=i.size;this._ctx.font=bt(s,i.weight,i.family);var l,h=wt(this._ctx,n),u=i.paddingLeft,d=i.paddingTop,v=i.borderSize,p=h+2*v+u+i.paddingRight,_=s+2*v+d+i.paddingBottom,f=this._chartData.styleOptions().yAxis;l=f.position===w&&f.inside||f.position===b&&!f.inside?0:this._width-p;var y=t.y-v-d-s/2;this._ctx.fillStyle=i.backgroundColor,this._ctx.fillRect(l,y,p,_),this._ctx.lineWidth=v,this._ctx.strokeStyle=i.borderColor,this._ctx.strokeRect(l,y,p,_),this._ctx.textBaseline="middle",this._ctx.fillStyle=i.color,this._ctx.fillText(n,l+v+u,t.y)}}}}]),i}(Et),zt=function(t){o(i,t);var e=l(i);function i(){return a(this,i),e.apply(this,arguments)}return n(i,[{key:"_createMainView",value:function(t,e){return new Ot(t,e.chartData,e.yAxis,e.additionalDataProvider)}},{key:"_createFloatLayerView",value:function(t,e){return new Rt(t,e.chartData,e.yAxis,e.additionalDataProvider)}}]),i}(Mt),Vt=function(){function t(e){a(this,t),this._chartData=e,this._width=0,this._height=0,this._minValue=0,this._maxValue=0,this._range=0,this._ticks=[],this._initMeasureCanvas()}return n(t,[{key:"_initMeasureCanvas",value:function(){var t=document.createElement("canvas");this._measureCtx=t.getContext("2d");var e=xt(this._measureCtx);this._measureCtx.scale(e,e)}},{key:"min",value:function(){return this._minValue}},{key:"max",value:function(){return this._maxValue}},{key:"setWidth",value:function(t){this._width=t}},{key:"setHeight",value:function(t){this._height=t}},{key:"ticks",value:function(){return this._ticks}},{key:"computeAxis",value:function(){var t=this._computeMinMaxValue(),e=t.max,a=t.range;this._minValue=t.min,this._maxValue=e,this._range=a,this._ticks=this._computeOptimalTicks(this._computeTicks())}},{key:"_computeMinMaxValue",value:function(){}},{key:"_computeOptimalTicks",value:function(t){}},{key:"_computeTicks",value:function(){var t=[];if(this._range>=0){var e=+this._nice(this._range/8),a=this._getIntervalPrecision(e),i=+this._round(Math.ceil(this._minValue/e)*e,a),n=+this._round(Math.floor(this._maxValue/e)*e,a),r=0,o=i;if(0!==e)for(;n>=o;)t[r]={v:o.toFixed(a)},++r,o+=e}return t}},{key:"_nice",value:function(t){var e=Math.floor(Math.log(t)/Math.LN10),a=Math.pow(10,e),i=t/a;return t=(1.5>i?1:2.5>i?2:3.5>i?3:4.5>i?4:5.5>i?5:6.5>i?6:8)*a,-20>e?t:+t.toFixed(0>e?-e:0)}},{key:"_getIntervalPrecision",value:function(t){var e=""+t,a=e.indexOf("e");if(a>0){var i=+e.slice(a+1);return 0>i?-i:0}var n=e.indexOf(".");return 0>n?0:e.length-1-n}},{key:"_round",value:function(t,e){return null==e&&(e=10),(+t).toFixed(e=Math.min(Math.max(0,e),20))}}]),t}(),Ht=function(t){o(i,t);var e=l(i);function i(t,n,r){var o;return a(this,i),(o=e.call(this,t))._isCandleStickYAxis=n,o._additionalDataProvider=r,o}return n(i,[{key:"_computeMinMaxValue",value:function(){var t=this._minValue,e=this._maxValue,a=Math.abs(e-t);return{min:t-=a/100*10,max:e+=a/100*20,range:a=Math.abs(e-t)}}},{key:"_computeOptimalTicks",value:function(t){var e=[],a=t.length;if(a>0){var i=this._chartData.styleOptions().xAxis.tickText.size,n=this._innerConvertToPixel(+t[0].v),r=1;if(a>1){var o=this._innerConvertToPixel(+t[1].v),c=Math.abs(o-n);2*i>c&&(r=Math.ceil(2*i/c))}for(var s=this._additionalDataProvider.technicalIndicator(),l=this.isPercentageYAxis(),h=this._isCandleStickYAxis?this._chartData.pricePrecision():s.precision,u=s.shouldFormatBigNumber,d=0;a>d;d+=r){var v=t[d].v,p=this._innerConvertToPixel(+(v=0==+v?"0":v)),_="";l?_="".concat(L(v,2),"%"):(_=L(v,h),u&&(_=A(_))),p>i&&this._height-i>p&&e.push({v:_,y:p})}}return e}},{key:"calcMinMaxValue",value:function(){var t=this,e=this._additionalDataProvider.technicalIndicator(),a=this._additionalDataProvider.isTimeLine(),i=this._chartData.dataList(),n=e.result,r=this._chartData.from(),o=this._chartData.to(),c=this._chartData.styleOptions().realTime.averageLine.display,s=[1/0,-1/0];if(a)for(var l=r;o>l;l++){var h=i[l],u=n[l]||{};s[0]=Math.min(h.close,s[0]),s[1]=Math.max(h.close,s[1]),c&&k(u.average)&&(s[0]=Math.min(u.average,s[0]),s[1]=Math.max(u.average,s[1]))}else for(var d=e.plots||[],v=function(a){var r=i[a],o=n[a]||{};d.forEach((function(t){var e=o[t.key];k(e)&&(s[0]=Math.min(s[0],e),s[1]=Math.max(s[1],e))})),(t._isCandleStickYAxis||e.shouldOhlc)&&(s[0]=Math.min(s[0],r.low),s[1]=Math.max(s[1],r.high))},p=r;o>p;p++)v(p);if(k(e.minValue)&&m(e.minValue)&&(s[0]=e.minValue),k(e.maxValue)&&m(e.maxValue)&&(s[1]=e.maxValue),s[0]!==1/0&&s[1]!==-1/0)if(this.isPercentageYAxis()){var _=i[r].close;this._minValue=(s[0]-_)/_*100,this._maxValue=(s[1]-_)/_*100,(this._minValue===this._maxValue||.01>Math.abs(this._minValue-this._maxValue))&&(this._minValue-=10,this._maxValue+=10)}else if(this._minValue=s[0],this._maxValue=s[1],this._minValue===this._maxValue||1e-6>Math.abs(this._minValue-this._maxValue)){var f=0!==this._minValue?Math.abs(.2*this._minValue):10;this._minValue=0!==this._minValue?this._minValue-f:this._minValue,this._maxValue+=f}}},{key:"_innerConvertToPixel",value:function(t){return Math.round((1-(t-this._minValue)/this._range)*this._height)}},{key:"isCandleStickYAxis",value:function(){return this._isCandleStickYAxis}},{key:"isPercentageYAxis",value:function(){return this._isCandleStickYAxis&&"percentage"===this._chartData.styleOptions().yAxis.type}},{key:"getSelfWidth",value:function(){var t=this,e=this._additionalDataProvider.technicalIndicator(),a=this._chartData.styleOptions(),i=a.yAxis,n=0;if(i.display&&(i.axisLine.display&&(n+=i.axisLine.size),i.tickLine.display&&(n+=i.tickLine.length),i.tickText.display)){var r=0;this._measureCtx.font=bt(i.tickText.size,i.tickText.weight,i.tickText.family),this._ticks.forEach((function(e){r=Math.max(r,wt(t._measureCtx,e.v))})),n+=i.tickText.paddingLeft+i.tickText.paddingRight+r}var o=a.floatLayer.crossHair,c=0;if(o.display&&o.horizontal.display&&o.horizontal.text.display){this._measureCtx.font=bt(o.horizontal.text.size,o.horizontal.text.weight,o.horizontal.text.family);var s=2;if(!this.isPercentageYAxis())if(this._isCandleStickYAxis){var l=this._chartData.pricePrecision();s=a.technicalIndicator.lastValueMark.display?Math.max(e.precision,l):l}else s=e.precision;var h=L(this._maxValue,s);e.shouldFormatBigNumber&&(h=A(h)),c+=o.horizontal.text.paddingLeft+o.horizontal.text.paddingRight+2*o.horizontal.text.borderSize+wt(this._measureCtx,h)}return Math.max(n,c)}},{key:"convertFromPixel",value:function(t){var e=(1-t/this._height)*this._range+this._minValue;if(this.isPercentageYAxis()){var a=this._chartData.dataList()[this._chartData.from()].close;return a*e/100+a}return e}},{key:"convertToPixel",value:function(t){var e=t;if(this.isPercentageYAxis()){var a=(this._chartData.dataList()[this._chartData.from()]||{}).close;k(a)&&(e=(t-a)/a*100)}return this._innerConvertToPixel(e)}}]),i}(Vt),Bt=function(t){o(i,t);var e=l(i);function i(t){var n;return a(this,i),(n=e.call(this,t)).setTechnicalIndicatorType(t.technicalIndicatorType||"MACD"),n}return n(i,[{key:"_initBefore",value:function(t){this._tag=t.tag,this._yAxis=this._createYAxis(t)}},{key:"_createYAxis",value:function(t){return new Ht(t.chartData,!1,{technicalIndicator:this.technicalIndicator.bind(this),isTimeLine:this._isRealTime.bind(this)})}},{key:"_createMainWidget",value:function(t,e){return new At({container:t,chartData:e.chartData,xAxis:e.xAxis,yAxis:this._yAxis,additionalDataProvider:{technicalIndicator:this.technicalIndicator.bind(this),tag:this.tag.bind(this)}})}},{key:"_createYAxisWidget",value:function(t,e){return new zt({container:t,chartData:e.chartData,yAxis:this._yAxis,additionalDataProvider:{technicalIndicator:this.technicalIndicator.bind(this),tag:this.tag.bind(this)}})}},{key:"_isRealTime",value:function(){return!1}},{key:"setHeight",value:function(t){h(c(i.prototype),"setHeight",this).call(this,t),this._yAxis.setHeight(t)}},{key:"setWidth",value:function(t,e){h(c(i.prototype),"setWidth",this).call(this,t,e),this._yAxis.setWidth(e)}},{key:"computeAxis",value:function(){this._yAxis.calcMinMaxValue(),this._yAxis.computeAxis()}},{key:"getSelfAxisWidth",value:function(){return this._yAxis.getSelfWidth(this._technicalIndicator)}},{key:"tag",value:function(){return this._tag}},{key:"yAxis",value:function(){return this._yAxis}},{key:"technicalIndicator",value:function(){return this._technicalIndicator}},{key:"setTechnicalIndicatorType",value:function(t){var e=this._chartData.technicalIndicator(t).structure;!this._technicalIndicator&&!e||this._technicalIndicator&&this._technicalIndicator.name===t||(this._technicalIndicator=e?new e:new z({}),this._chartData.calcTechnicalIndicator(this))}}]),i}(Dt),Nt=function(t){o(i,t);var e=l(i);function i(){return a(this,i),e.apply(this,arguments)}return n(i,[{key:"_draw",value:function(){this._drawGrid(),this._additionalDataProvider.chartType()===P?this._drawRealTime():(this._drawCandleStick(),this._drawTechnicalIndicator(),this._drawHighestPriceMark(),this._drawLowestPriceMark()),this._drawLastPriceLine()}},{key:"_drawRealTime",value:function(){var t=this,e=[],a=[],i=[],n=this._chartData.from(),r=this._additionalDataProvider.technicalIndicator().result;this._drawGraphics((function(o,c,s,l){var h=(r[c]||{}).average||0,u=t._yAxis.convertToPixel(s.close),d=t._yAxis.convertToPixel(h);if(i.push({x:o,y:d}),c===n){var v=o-l;a.push({x:v,y:t._height}),a.push({x:v,y:u}),e.push({x:v,y:u})}e.push({x:o,y:u}),a.push({x:o,y:u})}),(function(){var n=a.length;if(n>0){var r=a[n-1],o=t._chartData.barSpace()/2,c=r.x+o;e.push({x:c,y:r.y}),a.push({x:c,y:r.y}),a.push({x:c,y:t._height})}var s=t._chartData.styleOptions().realTime,l=s.timeLine;if(e.length>0&&(t._ctx.lineWidth=l.size,t._ctx.strokeStyle=l.color,Tt(t._ctx,(function(){t._ctx.beginPath(),t._ctx.moveTo(e[0].x,e[0].y);for(var a=1;e.length>a;a++)t._ctx.lineTo(e[a].x,e[a].y);t._ctx.stroke(),t._ctx.closePath()}))),a.length>0){t._ctx.fillStyle=l.areaFillColor,t._ctx.beginPath(),t._ctx.moveTo(a[0].x,a[0].y);for(var h=1;a.length>h;h++)t._ctx.lineTo(a[h].x,a[h].y);t._ctx.closePath(),t._ctx.fill()}var u=s.averageLine;u.display&&i.length>0&&(t._ctx.lineWidth=u.size,t._ctx.strokeStyle=u.color,Tt(t._ctx,(function(){t._ctx.beginPath(),t._ctx.moveTo(i[0].x,i[0].y);for(var e=1;i.length>e;e++)t._ctx.lineTo(i[e].x,i[e].y);t._ctx.stroke(),t._ctx.closePath()})))}))}},{key:"_drawCandleStick",value:function(){var t=this,e=-1/0,a=-1,i=1/0,n=-1,r=this._chartData.styleOptions().candleStick;this._drawGraphics((function(o,c,s,l,h){var u=s.high,d=s.low;u>e&&(e=u,a=o),i>d&&(i=d,n=o),t._drawCandleStickBar(o,l,h,s,r.bar,r.bar.style)})),this._highestMarkData={x:a,price:e},this._lowestMarkData={x:n,price:i}}},{key:"_drawHighestPriceMark",value:function(){if(this._highestMarkData){var t=this._highestMarkData.price,e=this._chartData.styleOptions().candleStick.priceMark,a=e.high;t!==-1/0&&e.display&&a.display&&this._drawLowestHighestPriceMark(a,this._highestMarkData.x,t,!0,this._chartData.pricePrecision())}}},{key:"_drawLowestPriceMark",value:function(){if(this._lowestMarkData){var t=this._lowestMarkData.price,e=this._chartData.styleOptions().candleStick.priceMark,a=e.low;t!==1/0&&e.display&&a.display&&this._drawLowestHighestPriceMark(a,this._lowestMarkData.x,t,!1,this._chartData.pricePrecision())}}},{key:"_drawLowestHighestPriceMark",value:function(t,e,a,i,n){var r=this,o=this._yAxis.convertToPixel(a),c=e,s=o+(i?-2:2);this._ctx.textAlign="left",this._ctx.lineWidth=1,this._ctx.strokeStyle=t.color,this._ctx.fillStyle=t.color,Tt(this._ctx,(function(){r._ctx.beginPath(),r._ctx.moveTo(c,s),r._ctx.lineTo(c-2,s+(i?-2:2)),r._ctx.stroke(),r._ctx.closePath(),r._ctx.beginPath(),r._ctx.moveTo(c,s),r._ctx.lineTo(c+2,s+(i?-2:2)),r._ctx.stroke(),r._ctx.closePath()}));var l=s+(i?-5:5);Ct(this._ctx,c,s,l),Pt(this._ctx,l,c,c+5),this._ctx.font=bt(t.textSize,t.textWeight,t.textFamily);var h=L(a,n);this._ctx.textBaseline="middle",this._ctx.fillText(h,c+5+t.textMargin,l)}},{key:"_drawLastPriceLine",value:function(){var t=this._chartData.dataList(),e=t.length,a=this._chartData.styleOptions().candleStick.priceMark,i=a.last;if(a.display&&i.display&&i.line.display&&0!==e){var n,r=t[e-1],o=r.close,c=r.open,s=this._yAxis.convertToPixel(o);s=+Math.max(.05*this._height,Math.min(s,.98*this._height)).toFixed(0),n=o>c?i.upColor:c>o?i.downColor:i.noChangeColor;var l=i.line;this._ctx.save(),this._ctx.strokeStyle=n,this._ctx.lineWidth=l.size,l.style===x&&this._ctx.setLineDash(l.dashValue),Pt(this._ctx,s,0,this._width),this._ctx.restore()}}}]),i}(It),Ft=function(t){o(i,t);var e=l(i);function i(){return a(this,i),e.apply(this,arguments)}return n(i,[{key:"_drawPrompt",value:function(t,e,a,i,n,r){var o=this._chartData.styleOptions(),c=o.floatLayer.prompt.candleStick,s=this._getCandleStickPromptData(t,o.candleStick,c);if(c.showType===M)this._drawCandleStickStandardPromptText(c,s),this._additionalDataProvider.chartType()===C&&this._drawTechnicalIndicatorPrompt(e,a,i,n,r,c.text.size+c.text.marginTop);else{var l=rt(e,n,this._yAxis);if(this._drawCandleStickRectPromptText(i,c,s,l),r){var h=this._chartData.styleOptions().technicalIndicator;this._drawTechnicalIndicatorPromptPoint(a,i,n,l.values,h.line.colors)}}}},{key:"_drawCandleStickStandardPromptText",value:function(t,e){var a=this,i=e,n=t.text.marginLeft,r=t.text.marginRight,o=t.text.size,c=t.text.color,s=t.labels;this._ctx.textBaseline="top",this._ctx.font=bt(o,t.text.weight,t.text.family);var l=n,h=t.text.marginTop;s.forEach((function(t,e){var o=t?"".concat(t,": "):"",s=wt(a._ctx,o);a._ctx.fillStyle=c,a._ctx.fillText(o,l,h),l+=s;var u,d=i[e]||"n/a";y(d)?(u=d.value||"n/a",a._ctx.fillStyle=d.color||c):(a._ctx.fillStyle=c,u=d);var v=wt(a._ctx,u);a._ctx.fillText(u,l,h),l+=v+n+r}))}},{key:"_drawCandleStickRectPromptText",value:function(t,e,a,i){var n=this,r=e.labels,o=a,c=e.text.marginLeft,s=e.text.marginRight,l=e.text.marginTop,h=e.text.marginBottom,u=e.text.size,d=e.text.color;this._ctx.save(),this._ctx.textBaseline="top",this._ctx.font=bt(u,e.text.weight,e.text.family);var v=0;r.forEach((function(t,e){var a=o[e]||"n/a",i=a;y(a)&&(i=a.value||"n/a");var r="".concat(t,": ").concat(i),l=wt(n._ctx,r)+c+s;v=Math.max(v,l)}));var p=e.rect,_=p.borderSize,f=p.paddingLeft,m=p.paddingRight,k=p.paddingTop,g=p.left,x=p.right,w=2*_+k+p.paddingBottom+(h+l+u)*r.length,b=this._chartData.styleOptions().floatLayer.prompt.technicalIndicator,P=b.text.marginLeft,T=b.text.marginRight,D=b.text.marginTop,M=b.text.marginBottom,S=b.text.size,E=this._additionalDataProvider.chartType()===C,I=i.labels||[],L=i.values||[];E&&(this._ctx.font=bt(S,b.text.weight,b.text.family),I.forEach((function(t,e){var a=L[e].value||"n/a",i="".concat(t,": ").concat(a),r=wt(n._ctx,i)+P+T;v=Math.max(v,r)})),w+=(D+M+S)*I.length);var A,O=2*_+v+f+m;A=this._width/2>t?this._width-x-O:g;var R=p.top,z=p.borderRadius;this._ctx.lineWidth=_,this._ctx.strokeStyle=p.borderColor,this._ctx.fillStyle=p.fillColor,this._drawRoundRect(A,R,O,w,z),this._ctx.stroke(),this._drawRoundRect(A,R,O,w,z),this._ctx.fill();var V=A+_+f+c,H=R+_+k;if(this._ctx.font=bt(u,e.text.weight,e.text.family),r.forEach((function(t,e){H+=l,n._ctx.textAlign="left",n._ctx.fillStyle=d,n._ctx.fillText("".concat(t,": "),V,H);var a,i=o[e]||"n/a";n._ctx.fillStyle=i.color||d,a=y(i)?i.value||"n/a":i,n._ctx.textAlign="right",n._ctx.fillText(a,A+O-_-s-m,H),H+=u+h})),E){var B=this._chartData.styleOptions().technicalIndicator,N=B.line.colors,F=A+_+f+P,Y=N.length;this._ctx.font=bt(S,b.text.weight,b.text.family),I.forEach((function(t,e){H+=D,n._ctx.textAlign="left",n._ctx.fillStyle=N[e%Y]||B.text.color,n._ctx.fillText("".concat(t.toUpperCase(),": "),F,H),n._ctx.textAlign="right",n._ctx.fillText(L[e].value||"n/a",A+O-_-T-m,H),H+=S+M}))}this._ctx.restore()}},{key:"_drawRoundRect",value:function(t,e,a,i,n){this._ctx.beginPath(),this._ctx.moveTo(t+n,e),this._ctx.arcTo(t+a,e,t+a,e+i,n),this._ctx.arcTo(t+a,e+i,t,e+i,n),this._ctx.arcTo(t,e+i,t,e,n),this._ctx.arcTo(t,e,t+a,e,n),this._ctx.closePath()}},{key:"_getCandleStickPromptData",value:function(t,e,a){var i=this,n=a.values,r=[];if(n)r=f(n)?n(t,e,a)||[]:n;else{var o=this._chartData.pricePrecision(),c=this._chartData.volumePrecision();(r=[E(t,"timestamp"),E(t,"open"),E(t,"close"),E(t,"high"),E(t,"low"),E(t,"volume")]).forEach((function(t,e){switch(e){case 0:r[e]=I(i._chartData.dateTimeFormat(),t,"YYYY-MM-DD hh:mm");break;case r.length-1:r[e]=A(L(t,c));break;default:r[e]=L(t,o)}}))}return r}}]),i}(Lt);function Yt(t,e,a){var i=[];if(t&&e&&a.length>0){var n=t.x-e.x;if(0===n)a.forEach((function(t){i.push(t.y)}));else{var r=(t.y-e.y)/n,o=t.y-r*t.x;a.forEach((function(t){i.push(t.x*r+o)}))}}return i}function Wt(t,e,a){return!!(a&&t&&e)&&(t.x===e.x?1>Math.abs(a.x-t.x):t.y===e.y?1>Math.abs(a.y-t.y):1>Math.abs(a.y-Yt(t,e,[a])[0]))}function jt(t,e,a){return!!(a&&t&&e)&&!!Wt(t,e,a)&&(t.x===e.x?e.y>t.y?a.y>t.y-2:t.y+2>a.y:e.x>t.x?a.x>t.x-2:t.x+2>a.x)}function Gt(t,e,a){return!!(a&&t&&e)&&!!Wt(t,e,a)&&2>Math.abs(Math.sqrt(Math.pow(a.x-t.x,2)+Math.pow(a.y-t.y,2))+Math.sqrt(Math.pow(a.x-e.x,2)+Math.pow(a.y-e.y,2))-Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2)))}function Ut(t,e,a){if(!a)return!1;var i=a.x-t.x,n=a.y-t.y;return!(i*i+n*n>e*e)}function Xt(t,e,a){var i=[];if(t.length>1)if(t[0].x===t[1].x){var n=e.height;if(i.push([{x:t[0].x,y:0},{x:t[0].x,y:n}]),t.length>2&&(i.push([{x:t[2].x,y:0},{x:t[2].x,y:n}]),a)){var r=t[0].x-t[2].x;i.push([{x:t[0].x+r,y:0},{x:t[0].x+r,y:n}])}}else{var o=e.width;if(t[0].y===t[1].y){if(i.push([{x:0,y:t[0].y},{x:o,y:t[0].y}]),t.length>2&&(i.push([{x:0,y:t[2].y},{x:o,y:t[2].y}]),a)){var c=t[0].y-t[2].y;i.push([{x:0,y:t[0].y+c},{x:o,y:t[0].y+c}])}}else{var s=(t[0].y-t[1].y)/(t[0].x-t[1].x),l=t[0].y-s*t[0].x;if(i.push([{x:0,y:0*s+l},{x:o,y:o*s+l}]),t.length>2){var h=t[2].y-s*t[2].x;if(i.push([{x:0,y:0*s+h},{x:o,y:o*s+h}]),a){var u=l+(l-h);i.push([{x:0,y:0*s+u},{x:o,y:o*s+u}])}}}}return i}function Kt(t,e){var a=[];if(t.length>0){var i=e.width;if(a.push([{x:0,y:t[0].y},{x:i,y:t[0].y}]),t.length>1){var n=t[0].y-t[1].y;a.push([{x:0,y:t[1].y+.786*n},{x:i,y:t[1].y+.786*n}]),a.push([{x:0,y:t[1].y+.618*n},{x:i,y:t[1].y+.618*n}]),a.push([{x:0,y:t[1].y+.5*n},{x:i,y:t[1].y+.5*n}]),a.push([{x:0,y:t[1].y+.382*n},{x:i,y:t[1].y+.382*n}]),a.push([{x:0,y:t[1].y+.236*n},{x:i,y:t[1].y+.236*n}]),a.push([{x:0,y:t[1].y},{x:i,y:t[1].y}])}}return a}function Zt(t){return t.getBoundingClientRect()||{left:0,top:0}}function Jt(t){return!!t.touches}function qt(t){t.cancelable&&t.preventDefault()}var $t=!!navigator.maxTouchPoints||!!navigator.msMaxTouchPoints||"ontouchstart"in window||!!(window.DocumentTouch&&document instanceof window.DocumentTouch),Qt="onorientationchange"in window&&$t;function te(t,e){var a=t.clientX-e.clientX,i=t.clientY-e.clientY;return Math.sqrt(a*a+i*i)}var ee=function(){function t(e,i,n){a(this,t),this._target=e,this._handler=i,this._options=n,this._clickCount=0,this._clickTimeoutId=null,this._longTapTimeoutId=null,this._longTapActive=!1,this._mouseMoveStartPosition=null,this._moveExceededManhattanDistance=!1,this._cancelClick=!1,this._unsubscribeOutsideEvents=null,this._unsubscribeMousemove=null,this._unsubscribeRoot=null,this._startPinchMiddlePoint=null,this._startPinchDistance=0,this._pinchPrevented=!1,this._preventDragProcess=!1,this._mousePressed=!1,this._init()}return n(t,[{key:"destroy",value:function(){null!==this._unsubscribeOutsideEvents&&(this._unsubscribeOutsideEvents(),this._unsubscribeOutsideEvents=null),null!==this._unsubscribeMousemove&&(this._unsubscribeMousemove(),this._unsubscribeMousemove=null),null!==this._unsubscribeRoot&&(this._unsubscribeRoot(),this._unsubscribeRoot=null),this._clearLongTapTimeout(),this._resetClickTimeout()}},{key:"_mouseEnterHandler",value:function(t){var e=this;this._unsubscribeMousemove&&this._unsubscribeMousemove();var a=this._mouseMoveHandler.bind(this),i=this._mouseWheelHandler.bind(this);this._unsubscribeMousemove=function(){e._target.removeEventListener("mousemove",a),e._target.removeEventListener("wheel",i)},this._target.addEventListener("mousemove",a),this._target.addEventListener("wheel",i,{passive:!1}),Jt(t)&&this._mouseMoveHandler(t);var n=this._makeCompatEvent(t);this._processEvent(n,this._handler.mouseEnterEvent)}},{key:"_resetClickTimeout",value:function(){null!==this._clickTimeoutId&&clearTimeout(this._clickTimeoutId),this._clickCount=0,this._clickTimeoutId=null}},{key:"_mouseMoveHandler",value:function(t){if(!this._mousePressed||Jt(t)){var e=this._makeCompatEvent(t);this._processEvent(e,this._handler.mouseMoveEvent)}}},{key:"_mouseWheelHandler",value:function(t){var e=this._makeCompatEvent(t);t.localX=e.localX,t.localY=e.localY,this._processEvent(t,this._handler.mouseWheelEvent)}},{key:"_mouseMoveWithDownHandler",value:function(t){if((!("button"in t)||0===t.button)&&null===this._startPinchMiddlePoint){var e=Jt(t);if(!this._preventDragProcess||!e){this._pinchPrevented=!0;var a=this._makeCompatEvent(t),i=this._mouseMoveStartPosition,n=Math.abs(i.x-a.pageX),r=Math.abs(i.y-a.pageY),o=n+r>5;if(o||!e){if(o&&!this._moveExceededManhattanDistance&&e){var c=.5*n;r>=c&&!this._options.treatVertTouchDragAsPageScroll||c>r&&!this._options.treatHorzTouchDragAsPageScroll||(this._preventDragProcess=!0)}o&&(this._moveExceededManhattanDistance=!0,this._cancelClick=!0,e&&this._clearLongTapTimeout()),this._preventDragProcess||(this._processEvent(a,this._handler.pressedMouseMoveEvent),e&&qt(t))}}}}},{key:"_mouseUpHandler",value:function(t){if(!("button"in t)||0===t.button){var e=this._makeCompatEvent(t);this._clearLongTapTimeout(),this._mouseMoveStartPosition=null,this._mousePressed=!1,this._unsubscribeRoot&&(this._unsubscribeRoot(),this._unsubscribeRoot=null),Jt(t)&&this._mouseLeaveHandler(t),this._processEvent(e,this._handler.mouseUpEvent),++this._clickCount,this._clickTimeoutId&&this._clickCount>1?(this._processEvent(e,this._handler.mouseDoubleClickEvent),this._resetClickTimeout()):this._cancelClick||this._processEvent(e,this._handler.mouseClickEvent),Jt(t)&&(qt(t),this._mouseLeaveHandler(t),0===t.touches.length&&(this._longTapActive=!1))}}},{key:"_clearLongTapTimeout",value:function(){null!==this._longTapTimeoutId&&(clearTimeout(this._longTapTimeoutId),this._longTapTimeoutId=null)}},{key:"_mouseDownHandler",value:function(t){if(!("button"in t)||0===t.button||2===t.button){var e=this._makeCompatEvent(t);if("button"in t&&2===t.button)this._processEvent(e,this._handler.mouseRightDownEvent);else{this._cancelClick=!1,this._moveExceededManhattanDistance=!1,this._preventDragProcess=!1,Jt(t)&&this._mouseEnterHandler(t),this._mouseMoveStartPosition={x:e.pageX,y:e.pageY},this._unsubscribeRoot&&(this._unsubscribeRoot(),this._unsubscribeRoot=null);var a=this._mouseMoveWithDownHandler.bind(this),i=this._mouseUpHandler.bind(this),n=this._target.ownerDocument.documentElement;this._unsubscribeRoot=function(){n.removeEventListener("touchmove",a),n.removeEventListener("touchend",i),n.removeEventListener("mousemove",a),n.removeEventListener("mouseup",i)},n.addEventListener("touchmove",a,{passive:!1}),n.addEventListener("touchend",i,{passive:!1}),this._clearLongTapTimeout(),Jt(t)&&1===t.touches.length?this._longTapTimeoutId=setTimeout(this._longTapHandler.bind(this,t),600):(n.addEventListener("mousemove",a),n.addEventListener("mouseup",i)),this._mousePressed=!0,this._processEvent(e,this._handler.mouseDownEvent),this._clickTimeoutId||(this._clickCount=0,this._clickTimeoutId=setTimeout(this._resetClickTimeout.bind(this),500))}}}},{key:"_init",value:function(){var t=this;this._target.addEventListener("mouseenter",this._mouseEnterHandler.bind(this)),this._target.addEventListener("touchcancel",this._clearLongTapTimeout.bind(this));var e=this._target.ownerDocument,a=function(e){t._handler.mouseDownOutsideEvent&&(e.target&&t._target.contains(e.target)||t._handler.mouseDownOutsideEvent())};this._unsubscribeOutsideEvents=function(){e.removeEventListener("mousedown",a),e.removeEventListener("touchstart",a)},e.addEventListener("mousedown",a),e.addEventListener("touchstart",a,{passive:!0}),this._target.addEventListener("mouseleave",this._mouseLeaveHandler.bind(this)),this._target.addEventListener("touchstart",this._mouseDownHandler.bind(this),{passive:!0}),Qt||this._target.addEventListener("mousedown",this._mouseDownHandler.bind(this)),this._initPinch(),this._target.addEventListener("touchmove",(function(){}),{passive:!1})}},{key:"_initPinch",value:function(){var t=this;void 0===this._handler.pinchStartEvent&&void 0===this._handler.pinchEvent&&void 0===this._handler.pinchEndEvent||(this._target.addEventListener("touchstart",(function(e){return t._checkPinchState(e.touches)}),{passive:!0}),this._target.addEventListener("touchmove",(function(e){if(2===e.touches.length&&null!==t._startPinchMiddlePoint&&void 0!==t._handler.pinchEvent){var a=te(e.touches[0],e.touches[1]);t._handler.pinchEvent(t._startPinchMiddlePoint,a/t._startPinchDistance),qt(e)}}),{passive:!1}),this._target.addEventListener("touchend",(function(e){t._checkPinchState(e.touches)})))}},{key:"_checkPinchState",value:function(t){1===t.length&&(this._pinchPrevented=!1),2!==t.length||this._pinchPrevented||this._longTapActive?this._stopPinch():this._startPinch(t)}},{key:"_startPinch",value:function(t){var e=Zt(this._target);this._startPinchMiddlePoint={x:(t[0].clientX-e.left+(t[1].clientX-e.left))/2,y:(t[0].clientY-e.top+(t[1].clientY-e.top))/2},this._startPinchDistance=te(t[0],t[1]),void 0!==this._handler.pinchStartEvent&&this._handler.pinchStartEvent(),this._clearLongTapTimeout()}},{key:"_stopPinch",value:function(){null!==this._startPinchMiddlePoint&&(this._startPinchMiddlePoint=null,void 0!==this._handler.pinchEndEvent&&this._handler.pinchEndEvent())}},{key:"_mouseLeaveHandler",value:function(t){this._unsubscribeMousemove&&this._unsubscribeMousemove();var e=this._makeCompatEvent(t);this._processEvent(e,this._handler.mouseLeaveEvent)}},{key:"_longTapHandler",value:function(t){var e=this._makeCompatEvent(t);this._processEvent(e,this._handler.longTapEvent),this._cancelClick=!0,this._longTapActive=!0}},{key:"_processEvent",value:function(t,e){e&&e.call(this._handler,t)}},{key:"_makeCompatEvent",value:function(t){var e;e="touches"in t&&t.touches.length?t.touches[0]:"changedTouches"in t&&t.changedTouches.length?t.changedTouches[0]:t;var a=Zt(this._target);return{clientX:e.clientX,clientY:e.clientY,pageX:e.pageX,pageY:e.pageY,screenX:e.screenX,screenY:e.screenY,localX:e.clientX-a.left,localY:e.clientY-a.top,ctrlKey:t.ctrlKey,altKey:t.altKey,shiftKey:t.shiftKey,metaKey:t.metaKey,type:t.type.startsWith("mouse")?"mouse":"touch",target:e.target,view:t.view}}}]),t}();function ae(t){return"touch"===t.type}function ie(t){return"mouse"===t.type}var ne=function(){function t(e){a(this,t),this._chartData=e,this._chartContentSize={},this._paneContentSize={}}return n(t,[{key:"_checkEventPointX",value:function(t){return t>0&&this._chartContentSize.contentRight-this._chartContentSize.contentLeft>t}},{key:"setChartContentSize",value:function(t){this._chartContentSize=t}},{key:"setPaneContentSize",value:function(t){this._paneContentSize=t}}]),t}(),re="step_1",oe="step_2",ce="step_3",se="step_done",le=function(t){o(r,t);var i=l(r);function r(t,e,n){var o;return a(this,r),(o=i.call(this,t))._xAxis=e,o._yAxis=n,o._noneGraphicMarkMouseDownFlag=!1,o._noneGraphicMarkMouseDownActiveData={markKey:null,dataIndex:-1,onLine:!1,onCircle:!1,pointIndex:-1},o}return n(r,[{key:"mouseUpEvent",value:function(t){this._chartData.setDragGraphicMarkFlag(!1),this._noneGraphicMarkMouseDownFlag=!1,this._noneGraphicMarkMouseDownActiveData={markKey:null,dataIndex:-1,onLine:!1,onCircle:!1,pointIndex:-1}}},{key:"mouseDownEvent",value:function(t){if(this._checkEventPointX(t.localX)&&this._checkEventPointY(t.localY)){this._chartData.setGraphicMarkPoint({x:t.localX,y:t.localY});var e=this._chartData.graphicMarkType();switch(e){case ct:case st:case lt:case ht:case ut:case dt:case vt:case pt:case _t:case ft:case kt:this._twoStepGraphicMarkMouseDown(t,e);break;case yt:case mt:this._threeStepGraphicMarkMouseDown(t,e);break;case ot:this._noneGraphicMarkMouseLeftDown(t)}}}},{key:"mouseRightDownEvent",value:function(t){if(this._chartData.graphicMarkType()===ot){this._findNoneGraphicMarkMouseDownActiveData(t);var e=this._noneGraphicMarkMouseDownActiveData.markKey,a=this._noneGraphicMarkMouseDownActiveData.dataIndex;if(e&&-1!==a){var i=this._chartData.graphicMarkData(),n=i[e];n.splice(a,1),i[e]=n,this._chartData.setGraphicMarkData(i),this.mouseUpEvent(t)}}}},{key:"_twoStepGraphicMarkMouseDown",value:function(t,e){var a=this;this._graphicMarkMouseDown(t,e,(function(t){switch(t.drawStep){case re:t.drawStep=oe;break;case oe:t.drawStep=se,a._chartData.setGraphicMarkType(ot)}}))}},{key:"_threeStepGraphicMarkMouseDown",value:function(t,e){var a=this;this._graphicMarkMouseDown(t,e,(function(t){switch(t.drawStep){case re:t.drawStep=oe;break;case oe:t.drawStep=ce;break;case ce:t.drawStep=se,a._chartData.setGraphicMarkType(ot)}}))}},{key:"_graphicMarkMouseDown",value:function(t,e,a){var i=this._chartData.graphicMarkData(),n=i[e];if(2===t.button)n.splice(n.length-1,1),this._chartData.setGraphicMarkType(ot);else{var r=n[n.length-1];a(r),n[n.length-1]=r}i[e]=n,this._chartData.setGraphicMarkData(i)}},{key:"_noneGraphicMarkMouseLeftDown",value:function(t){this._findNoneGraphicMarkMouseDownActiveData(t),this._noneGraphicMarkMouseDownActiveData.markKey&&-1!==this._noneGraphicMarkMouseDownActiveData.dataIndex&&this._noneGraphicMarkMouseDownActiveData.onCircle&&(this._noneGraphicMarkMouseDownFlag=!0,this._chartData.setDragGraphicMarkFlag(!0))}},{key:"_findNoneGraphicMarkMouseDownActiveData",value:function(t){for(var a=this,i={x:t.localX,y:t.localY},n=Object.keys(this._chartData.graphicMarkData()),r=function(t){var e=n[t];switch(e){case ct:case ft:if(a._realFindNoneGraphicMarkMouseDownActiveData(e,i,(function(t){return Wt(t[0],{x:a._chartContentSize.contentRight,y:t[0].y},i)})))return{v:void 0};break;case st:if(a._realFindNoneGraphicMarkMouseDownActiveData(e,i,(function(t){return Wt(t[0],{x:t[0].x,y:a._paneContentSize[Pe].contentBottom},i)})))return{v:void 0};break;case lt:if(a._realFindNoneGraphicMarkMouseDownActiveData(e,i,(function(t){return Wt(t[0],t[1],i)})))return{v:void 0};break;case ht:case ut:case dt:if(a._realFindNoneGraphicMarkMouseDownActiveData(e,i,(function(t){return jt(t[0],t[1],i)})))return{v:void 0};break;case vt:case pt:case _t:if(a._realFindNoneGraphicMarkMouseDownActiveData(e,i,(function(t){return Gt(t[0],t[1],i)})))return{v:void 0};break;case yt:case mt:case kt:if(a._realFindNoneGraphicMarkMouseDownActiveData(e,i,(function(t){var n,r={width:a._chartContentSize.contentRight,height:a._paneContentSize[Pe].contentBottom-a._paneContentSize[Pe].contentTop};switch(e){case yt:n=Xt(t,r,!0);break;case mt:n=Xt(t,r);break;case kt:n=Kt(t,r)}var o=!1;if(n)for(var c=0;n.length>c;c++){var s=n[c];if(o=Wt(s[0],s[1],i))return o}return o})))return{v:void 0}}},o=0;n.length>o;o++){var c=r(o);if("object"===e(c))return c.v}}},{key:"_realFindNoneGraphicMarkMouseDownActiveData",value:function(t,e,a){var i=this,n=this._chartData.graphicMarkData()[t],r=this._chartData.styleOptions().graphicMark;return n.forEach((function(n,o){var c=[],s=!1,l=-1;n.points.forEach((function(t,a){var n=i._xAxis.convertToPixel(t.xPos),o=i._yAxis.convertToPixel(t.price);c.push({x:n,y:o});var h=Ut({x:n,y:o},r.point.radius,e);h&&(l=a),s||(s=h)}));var h=a(c,e);if(h||s)return i._noneGraphicMarkMouseDownActiveData={markKey:t,dataIndex:o,onLine:h,onCircle:s,pointIndex:l},!0})),!1}},{key:"mouseMoveEvent",value:function(t){if(this._checkEventPointX(t.localX)&&this._checkEventPointY(t.localY)){var e={x:t.localX,y:t.localY};if(this._chartData.setGraphicMarkPoint(e),!this._waitingForMouseMoveAnimationFrame){this._waitingForMouseMoveAnimationFrame=!0;var a=this._chartData.graphicMarkType();switch(a){case ct:case st:case ft:this._onePointGraphicMarkMouseMove(e,a);break;case lt:case dt:case _t:case kt:this._twoPointGraphicMarkMouseMove(e,a);break;case ht:case vt:this._twoPointGraphicMarkMouseMove(e,a,(function(t,e){t.points[0].price=e.price}));break;case ut:case pt:this._twoPointGraphicMarkMouseMove(e,a,(function(t,e){t.points[0].xPos=e.xPos}));break;case yt:case mt:this._threePointGraphicMarkMouseMove(e,a);break;case ot:this._chartData.setGraphicMarkData(this._chartData.graphicMarkData())}this._waitingForMouseMoveAnimationFrame=!1}}}},{key:"pressedMouseMoveEvent",value:function(t){var e=this._noneGraphicMarkMouseDownActiveData.markKey,a=this._noneGraphicMarkMouseDownActiveData.dataIndex;if(e&&-1!==a){var i=this._chartData.graphicMarkData(),n=i[e],r={x:t.localX,y:t.localY};switch(e){case ct:case st:case ft:case lt:case dt:case _t:case yt:case mt:case kt:var o=this._noneGraphicMarkMouseDownActiveData.pointIndex;-1!==o&&(n[a].points[o].xPos=this._xAxis.convertFromPixel(r.x),n[a].points[o].price=this._yAxis.convertFromPixel(r.y));break;case ht:case vt:var c=this._noneGraphicMarkMouseDownActiveData.pointIndex;if(-1!==c){var s=this._yAxis.convertFromPixel(r.y);n[a].points[c].xPos=this._xAxis.convertFromPixel(r.x),n[a].points[0].price=s,n[a].points[1].price=s}break;case ut:case pt:var l=this._noneGraphicMarkMouseDownActiveData.pointIndex;if(-1!==l){var h=this._xAxis.convertFromPixel(r.x);n[a].points[0].xPos=h,n[a].points[1].xPos=h,n[a].points[l].price=this._yAxis.convertFromPixel(r.y)}}i[e]=n,this._chartData.setGraphicMarkPoint({x:t.localX,y:t.localY}),this._chartData.setGraphicMarkData(i)}}},{key:"_onePointGraphicMarkMouseMove",value:function(t,e){var a=this;this._graphicMarkMouseMove(t,e,(function(e,i){var n=a._xAxis.convertFromPixel(t.x),r=a._yAxis.convertFromPixel(t.y);switch(i.drawStep){case se:e.push({points:[{xPos:n,price:r}],drawStep:re});break;case re:case oe:i.points[0].xPos=n,i.points[0].price=r,e[e.length-1]=i}}))}},{key:"_twoPointGraphicMarkMouseMove",value:function(t,e,a){var i=this;this._graphicMarkMouseMove(t,e,(function(e,n){var r=i._xAxis.convertFromPixel(t.x),o=i._yAxis.convertFromPixel(t.y);switch(n.drawStep){case se:e.push({points:[{xPos:r,price:o},{xPos:r,price:o}],drawStep:re});break;case re:n.points[0]={xPos:r,price:o},n.points[1]={xPos:r,price:o},e[e.length-1]=n;break;case oe:n.points[1]={xPos:r,price:o},f(a)&&a(n,{xPos:r,price:o}),e[e.length-1]=n}}))}},{key:"_threePointGraphicMarkMouseMove",value:function(t,e,a){var i=this;this._graphicMarkMouseMove(t,e,(function(e,n){var r=i._xAxis.convertFromPixel(t.x),o=i._yAxis.convertFromPixel(t.y);switch(n.drawStep){case se:e.push({points:[{xPos:r,price:o},{xPos:r,price:o}],drawStep:re});break;case re:n.points[0]={xPos:r,price:o},n.points[1]={xPos:r,price:o},e[e.length-1]=n;break;case oe:f(a)&&a(n,{xPos:r,price:o}),n.points[1]={xPos:r,price:o},e[e.length-1]=n;break;case ce:n.points[2]={xPos:r,price:o},e[e.length-1]=n}}))}},{key:"_graphicMarkMouseMove",value:function(t,e,a){var i=this._chartData.graphicMarkData(),n=i[e];a(n,n[n.length-1]||{drawStep:se}),i[e]=n,this._chartData.setGraphicMarkData(i)}},{key:"_checkEventPointY",value:function(t){var e=this._paneContentSize[Pe];return t>e.contentTop&&e.contentBottom>t}}]),r}(ne),he=function(t){o(i,t);var e=l(i);function i(t,n,r,o){var c;return a(this,i),(c=e.call(this,t,n))._xAxis=r,c._yAxis=o,c}return n(i,[{key:"_draw",value:function(){var t=this._chartData.styleOptions().graphicMark,e=this._chartData.pricePrecision();this._drawHorizontalStraightLine(t),this._drawVerticalStraightLine(t),this._drawStraightLine(t),this._drawHorizontalRayLine(t),this._drawVerticalRayLine(t),this._drawRayLine(t),this._drawSegmentLine(t),this._drawPriceLine(t,e),this._drawPriceChannelLine(t),this._drawParallelStraightLine(t),this._drawFibonacciLine(t,e)}},{key:"_drawHorizontalStraightLine",value:function(t){var e=this;this._drawPointGraphicMark(ct,t,Wt,(function(t){return[[{x:0,y:t[0].y},{x:e._width,y:t[0].y}]]}))}},{key:"_drawVerticalStraightLine",value:function(t){var e=this;this._drawPointGraphicMark(st,t,Wt,(function(t){return[[{x:t[0].x,y:0},{x:t[0].x,y:e._height}]]}))}},{key:"_drawStraightLine",value:function(t){var e=this;this._drawPointGraphicMark(lt,t,Wt,(function(t){if(t[0].x===t[1].x)return[[{x:t[0].x,y:0},{x:t[0].x,y:e._height}]];var a=Yt(t[0],t[1],[{x:0,y:t[0].y},{x:e._width,y:t[0].y}]);return[[{x:0,y:a[0]},{x:e._width,y:a[1]}]]}))}},{key:"_drawHorizontalRayLine",value:function(t){var e=this;this._drawPointGraphicMark(ht,t,jt,(function(t){var a={x:0,y:t[0].y};return t[1].x>t[0].x&&(a.x=e._width),[[t[0],a]]}))}},{key:"_drawVerticalRayLine",value:function(t){var e=this;this._drawPointGraphicMark(ut,t,jt,(function(t){var a={x:t[0].x,y:0};return t[1].y>t[0].y&&(a.y=e._height),[[t[0],a]]}))}},{key:"_drawRayLine",value:function(t){var e=this;this._drawPointGraphicMark(dt,t,jt,(function(t){var a;return a=t[0].x===t[1].x&&t[0].y!==t[1].y?t[1].y>t[0].y?{x:t[0].x,y:e._height}:{x:t[0].x,y:0}:t[0].x>t[1].x?{x:0,y:Yt(t[0],t[1],[{x:0,y:t[0].y}])[0]}:{x:e._width,y:Yt(t[0],t[1],[{x:e._width,y:t[0].y}])[0]},[[t[0],a]]}))}},{key:"_drawSegmentLine",value:function(t){this._drawPointGraphicMark(vt,t,Gt),this._drawPointGraphicMark(pt,t,Gt),this._drawPointGraphicMark(_t,t,Gt)}},{key:"_drawPriceLine",value:function(t,e){var a=this;this._drawPointGraphicMark(ft,t,jt,(function(t){return[[t[0],{x:a._width,y:t[0].y}]]}),!0,e)}},{key:"_drawPriceChannelLine",value:function(t){var e=this;this._drawPointGraphicMark(yt,t,Wt,(function(t){return Xt(t,{width:e._width,height:e._height},!0)}))}},{key:"_drawParallelStraightLine",value:function(t){var e=this;this._drawPointGraphicMark(mt,t,Wt,(function(t){return Xt(t,{width:e._width,height:e._height})}))}},{key:"_drawFibonacciLine",value:function(t,e){var a=this;this._drawPointGraphicMark(kt,t,Wt,(function(t){return Kt(t,{width:a._width,height:a._height})}),!0,e,["(100.0%)","(78.6%)","(61.8%)","(50.0%)","(38.2%)","(23.6%)","(0.0%)"])}},{key:"_drawPointGraphicMark",value:function(t,e,a,i,n,r,o){var c=this;this._chartData.graphicMarkData()[t].forEach((function(t){var s=t.drawStep,l=[];t.points.forEach((function(t){var e=t.price,a=c._xAxis.convertToPixel(t.xPos),i=c._yAxis.convertToPixel(e);l.push({x:a,y:i})}));var h=i?i(l):[l];c._drawGraphicMark(e,h,l,s,a,n,r,o)}))}},{key:"_drawGraphicMark",value:function(t,e,a,i,n,r,o){var c=this,s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:[],l=this._chartData.graphicMarkPoint(),h=!1;e.forEach((function(e,a){if(e.length>1){var u=n(e[0],e[1],l);if(h||(h=u),i!==re){switch(c._ctx.strokeStyle=t.line.color,c._ctx.lineWidth=t.line.size,c._getLineType(e[0],e[1])){case 0:Tt(c._ctx,(function(){c._ctx.beginPath(),c._ctx.moveTo(e[0].x,e[0].y),c._ctx.lineTo(e[1].x,e[1].y),c._ctx.stroke(),c._ctx.closePath()}));break;case 1:Pt(c._ctx,e[0].y,e[0].x,e[1].x);break;case 2:Ct(c._ctx,e[0].x,e[0].y,e[1].y)}if(r){var d=L(c._yAxis.convertFromPixel(e[0].y),o);c._ctx.font=bt(t.text.size,t.text.weight,t.text.family),c._ctx.fillStyle=t.text.color,c._ctx.fillText("".concat(d," ").concat(s[a]||""),e[0].x+t.text.marginLeft,e[0].y-t.text.marginBottom)}}}}));for(var u=t.point.radius,d=!1,v=0;a.length>v&&!(d=Ut(a[v],u,l));v++);a.forEach((function(e){var a=Ut(e,u,l);if(d||h){var i=u,n=t.point.backgroundColor,r=t.point.borderColor,o=t.point.borderSize;a&&(i=t.point.activeRadius,n=t.point.activeBackgroundColor,r=t.point.activeBorderColor,o=t.point.activeBorderSize),c._ctx.fillStyle=n,c._ctx.beginPath(),c._ctx.arc(e.x,e.y,i,0,2*Math.PI),c._ctx.closePath(),c._ctx.fill(),c._ctx.lineWidth=o,c._ctx.strokeStyle=r,c._ctx.beginPath(),c._ctx.arc(e.x,e.y,i,0,2*Math.PI),c._ctx.closePath(),c._ctx.stroke()}}))}},{key:"_getLineType",value:function(t,e){return t.x===e.x?2:t.y===e.y?1:0}}]),i}(Et),ue=function(t){o(i,t);var e=l(i);function i(){return a(this,i),e.apply(this,arguments)}return n(i,[{key:"_createMainView",value:function(t,e){return new Nt(t,e.chartData,e.xAxis,e.yAxis,e.additionalDataProvider)}},{key:"_createExpandView",value:function(t,e){return new he(t,e.chartData,e.xAxis,e.yAxis)}},{key:"_createFloatLayerView",value:function(t,e){return new Ft(t,e.chartData,e.xAxis,e.yAxis,e.additionalDataProvider)}},{key:"invalidate",value:function(t){1!==t&&h(c(i.prototype),"invalidate",this).call(this,t),this._expandView.flush()}},{key:"setSize",value:function(t,e){h(c(i.prototype),"setSize",this).call(this,t,e),this._expandView.setSize(t,e)}}]),i}(At),de=function(t){o(i,t);var e=l(i);function i(){return a(this,i),e.call(this,{name:"TAP",precision:2,plots:[{key:"average",type:"line"}]})}return n(i,[{key:"calcTechnicalIndicator",value:function(t,e){var a=0,i=0,n=[];return t.forEach((function(t){var e={},r=t.volume||0;a+=t.turnover||0,i+=r,0!==r&&(e.average=a/i),n.push(e)})),n}}]),i}(z),ve=function(t){o(i,t);var e=l(i);function i(t){var n;return a(this,i),(n=e.call(this,t))._chartType=C,n._realTimeTechnicalIndicator=new de,n}return n(i,[{key:"_createYAxis",value:function(t){return new Ht(t.chartData,!0,{technicalIndicator:this.technicalIndicator.bind(this),isTimeLine:this._isRealTime.bind(this)})}},{key:"_createMainWidget",value:function(t,e){return new ue({container:t,chartData:e.chartData,xAxis:e.xAxis,yAxis:this._yAxis,additionalDataProvider:{technicalIndicator:this.technicalIndicator.bind(this),chartType:this.chartType.bind(this),tag:this.tag.bind(this)}})}},{key:"_isRealTime",value:function(){return this._chartType===P}},{key:"technicalIndicator",value:function(){return this._isRealTime()?this._realTimeTechnicalIndicator:this._technicalIndicator}},{key:"chartType",value:function(){return this._chartType}},{key:"setChartType",value:function(t){this._chartType!==t&&(this._chartType=t,this._chartData.calcTechnicalIndicator(this))}}]),i}(Bt),pe=function(t){o(i,t);var e=l(i);function i(t,n,r){var o;return a(this,i),(o=e.call(this,t,n))._xAxis=r,o}return n(i,[{key:"_draw",value:function(){var t=this._chartData.styleOptions().xAxis;t.display&&(this._drawAxisLine(t),this._drawTickLines(t),this._drawTickLabels(t))}},{key:"_drawAxisLine",value:function(t){var e=t.axisLine;e.display&&(this._ctx.strokeStyle=e.color,this._ctx.lineWidth=e.size,Pt(this._ctx,0,0,this._width))}},{key:"_drawTickLines",value:function(t){var e=this,a=t.tickLine;if(a.display){this._ctx.lineWidth=a.size,this._ctx.strokeStyle=a.color;var i=t.axisLine.display?t.axisLine.size:0,n=i+a.length;this._xAxis.ticks().forEach((function(t){Ct(e._ctx,t.x,i,n)}))}}},{key:"_drawTickLabels",value:function(t){var e=t.tickText;if(e.display){var a=t.tickLine;this._ctx.textBaseline="top",this._ctx.font=bt(e.size,e.weight,e.family),this._ctx.textAlign="center",this._ctx.fillStyle=e.color;var i=e.paddingTop;t.axisLine.display&&(i+=t.axisLine.size),a.display&&(i+=a.length);for(var n=this._xAxis.ticks(),r=n.length,o=0;r>o;o++)this._ctx.fillText(n[o].v,n[o].x,i)}}}]),i}(Et),_e=function(t){o(i,t);var e=l(i);function i(t,n,r){var o;return a(this,i),(o=e.call(this,t,n))._xAxis=r,o}return n(i,[{key:"_draw",value:function(){this._drawCrossHairLabel()}},{key:"_drawCrossHairLabel",value:function(){var t=this._chartData.crossHair();if(t.paneTag){var e=this._chartData.styleOptions().floatLayer.crossHair,a=e.vertical,i=a.text;if(e.display&&a.display&&i.display){var n,r=this._chartData.dataList(),o=r[n=k(t.x)?this._xAxis.convertFromPixel(t.x):r.length-1];if(o){var c=this._xAxis.convertToPixel(n),s=o.timestamp,l=I(this._chartData.dateTimeFormat(),s,"YYYY-MM-DD hh:mm"),h=i.size;this._ctx.font=bt(h,i.weight,i.family);var u=wt(this._ctx,l),d=c-u/2,v=i.paddingLeft,p=i.paddingRight,_=i.paddingTop,f=i.borderSize;v+f>d?d=v+f:d>this._width-u-f-p&&(d=this._width-u-f-p);var y=d-f-v,m=d+u+f+p,g=0+h+2*f+_+i.paddingBottom;this._ctx.fillStyle=i.backgroundColor,this._ctx.fillRect(y,0,m-y,g-0),this._ctx.lineWidth=f,this._ctx.strokeStyle=i.borderColor,this._ctx.strokeRect(y,0,m-y,g-0),this._ctx.textBaseline="top",this._ctx.fillStyle=i.color,this._ctx.fillText(l,d,f+_)}}}}}]),i}(Et),fe=function(t){o(i,t);var e=l(i);function i(){return a(this,i),e.apply(this,arguments)}return n(i,[{key:"_createMainView",value:function(t,e){return new pe(t,e.chartData,e.xAxis)}},{key:"_createFloatLayerView",value:function(t,e){return new _e(t,e.chartData,e.xAxis)}}]),i}(Mt),ye=function(t){o(i,t);var e=l(i);function i(){return a(this,i),e.apply(this,arguments)}return n(i,[{key:"_computeMinMaxValue",value:function(){var t=this._chartData.from(),e=this._chartData.to()-1;return{min:t,max:e,range:e-t+1}}},{key:"_computeOptimalTicks",value:function(t){var e=[],a=t.length,i=this._chartData.dataList();if(a>0){var n=this._chartData.dateTimeFormat(),r=this._chartData.styleOptions().xAxis.tickText;this._measureCtx.font=bt(r.size,r.weight,r.family);var o=wt(this._measureCtx,"00-00 00:00"),c=this.convertToPixel(parseInt(t[0].v,10)),s=1;if(a>1){var l=this.convertToPixel(parseInt(t[1].v,10)),h=Math.abs(l-c);o>h&&(s=Math.ceil(o/h))}for(var u=0;a>u;u+=s){var d=parseInt(t[u].v,10),v=i[d].timestamp,p=I(n,v,"hh:mm");0!==u&&(p=this._optimalTickLabel(n,v,i[parseInt(t[u-s].v,10)].timestamp)||p);var _=this.convertToPixel(d);e.push({v:p,x:_,oV:v})}if(1===e.length)e[0].v=I(n,e[0].oV,"YYYY-MM-DD hh:mm");else{var f=e[0].oV,y=e[1].oV;if(e[2]){var m=e[2].v;/^[0-9]{2}-[0-9]{2}$/.test(m)?e[0].v=I(n,f,"MM-DD"):/^[0-9]{4}-[0-9]{2}$/.test(m)?e[0].v=I(n,f,"YYYY-MM"):/^[0-9]{4}$/.test(m)&&(e[0].v=I(n,f,"YYYY"))}else e[0].v=this._optimalTickLabel(n,f,y)||e[0].v}}return e}},{key:"_optimalTickLabel",value:function(t,e,a){var i=I(t,e,"YYYY"),n=I(t,e,"YYYY-MM"),r=I(t,e,"MM-DD");return i!==I(t,a,"YYYY")?i:n!==I(t,a,"YYYY-MM")?n:r!==I(t,a,"MM-DD")?r:null}},{key:"getSelfHeight",value:function(){var t=this._chartData.styleOptions(),e=t.xAxis,a=t.floatLayer.crossHair,i=0;e.display&&(e.axisLine.display&&(i+=e.axisLine.size),e.tickLine.display&&(i+=e.tickLine.length),e.tickText.display&&(i+=e.tickText.paddingTop+e.tickText.paddingBottom+e.tickText.size));var n=0;return a.display&&a.vertical.display&&a.vertical.text.display&&(n+=a.vertical.text.paddingTop+a.vertical.text.paddingBottom+2*a.vertical.text.borderSize+a.vertical.text.size),Math.max(i,n)}},{key:"convertFromPixel",value:function(t){return Math.round(this._chartData.coordinateToFloatIndex(t))-1}},{key:"convertToPixel",value:function(t){var e=this._chartData.dataList().length,a=this._chartData.dataSpace(),i=e+this._chartData.offsetRightBarCount()-t;return this._width-(i-.5)*a+this._chartData.barSpace()/2}}]),i}(Vt),me=function(t){o(i,t);var e=l(i);function i(){return a(this,i),e.apply(this,arguments)}return n(i,[{key:"_initBefore",value:function(){this._xAxis=new ye(this._chartData)}},{key:"_createMainWidget",value:function(t,e){return new fe({container:t,chartData:e.chartData,xAxis:this._xAxis})}},{key:"computeAxis",value:function(){this._xAxis.computeAxis()}},{key:"getSelfAxisHeight",value:function(){return this._xAxis.getSelfHeight()}},{key:"xAxis",value:function(){return this._xAxis}},{key:"setWidth",value:function(t,e){h(c(i.prototype),"setWidth",this).call(this,t,e),this._xAxis.setWidth(t)}},{key:"setHeight",value:function(t){h(c(i.prototype),"setHeight",this).call(this,t),this._xAxis.setHeight(t)}}]),i}(Dt),ke=function(){function t(e,i,n,r,o){a(this,t),this._chartData=i,this._paneIndex=n,this._width=0,this._offsetLeft=0,this._dragEventHandler=o,this._initElement(e,r)}return n(t,[{key:"_initElement",value:function(t,e){this._container=t,this._wrapper=this._createElement(),this._wrapper.style.overflow="hidden",this._element=this._createElement(),this._element.style.width="100%",this._element.style.position="absolute",this._element.style.zIndex="20",this._element.style.height="5px",e&&(this._element.style.cursor="ns-resize",this._dragEvent=new ee(this._element,{mouseDownEvent:this._mouseDownEvent.bind(this),pressedMouseMoveEvent:this._pressedMouseMoveEvent.bind(this)},{treatVertTouchDragAsPageScroll:!1,treatHorzTouchDragAsPageScroll:!0})),this._wrapper.appendChild(this._element);var a=t.lastChild;a?t.insertBefore(this._wrapper,a):t.appendChild(this._wrapper)}},{key:"_createElement",value:function(){var t=document.createElement("div");return t.style.margin="0",t.style.padding="0",t}},{key:"_mouseDownEvent",value:function(t){this._startY=t.pageY,this._dragEventHandler.startDrag(this._paneIndex)}},{key:"_pressedMouseMoveEvent",value:function(t){this._dragEventHandler.drag(t.pageY-this._startY,this._paneIndex)}},{key:"height",value:function(){return this._wrapper.offsetHeight}},{key:"setSize",value:function(t,e){this._offsetLeft=t,this._width=e,this.invalidate()}},{key:"updatePaneIndex",value:function(t){this._paneIndex=t}},{key:"invalidate",value:function(){var t=this._chartData.styleOptions().separator;this._wrapper.style.backgroundColor=t.color,this._wrapper.style.height="".concat(t.size,"px"),this._wrapper.style.marginLeft="".concat(t.fill?0:this._offsetLeft,"px"),this._wrapper.style.width=t.fill?"100%":"".concat(this._width,"px")}},{key:"getImage",value:function(){var t=this._chartData.styleOptions().separator,e=document.createElement("canvas"),a=e.getContext("2d"),i=xt(a),n=this._wrapper.offsetWidth,r=t.size;return e.style.width="".concat(n,"px"),e.style.height="".concat(r,"px"),e.width=n*i,e.height=r*i,a.scale(i,i),a.fillStyle=t.color,a.fillRect(this._offsetLeft,0,n,r),e}},{key:"destroy",value:function(){this._dragEvent&&this._dragEvent.destroy(),this._container.removeChild(this._wrapper)}}]),t}(),ge=function(t){o(i,t);var e=l(i);function i(t){var n;return a(this,i),(n=e.call(this,t))._startScrollPoint={},n._touchPoint={},n._touchCancelCrossHair=!1,n._touchZoomed=!1,n._pinchScale=1,n}return n(i,[{key:"pinchStartEvent",value:function(){this._pinchScale=1,this._touchZoomed=!0}},{key:"pinchEvent",value:function(t,e){var a=5*(e-this._pinchScale);this._pinchScale=e,this._chartData.zoom(a,t)}},{key:"mouseLeaveEvent",value:function(t){ie(t)&&this._chartData.setCrossHairPointPaneTag(null,null)}},{key:"mouseMoveEvent",value:function(t){var e=this;ie(t)&&this._performCross(t,!1,(function(a){e._chartData.setCrossHairPointPaneTag({x:t.localX,y:a.y},a.tag)}),(function(){e._chartData.setCrossHairPointPaneTag(null,null)}))}},{key:"mouseWheelEvent",value:function(t){if(this._checkEventPointX(t.localX)){var e=-t.deltaY/100;if(0!==e){switch(t.cancelable&&t.preventDefault(),t.deltaMode){case t.DOM_DELTA_PAGE:e*=120;break;case t.DOM_DELTA_LINE:e*=32}if(0!==e){var a=Math.sign(e)*Math.min(1,Math.abs(e));this._chartData.zoom(a,{x:t.localX,y:t.localY})}}}}},{key:"mouseClickEvent",value:function(t){var e=this;this._performCross(t,!0,(function(a){e._touchPoint||e._touchCancelCrossHair||e._touchZoomed||(e._touchPoint={x:t.localX,y:t.localY},e._chartData.setCrossHairPointPaneTag({x:t.localX,y:a.y},a.tag))}))}},{key:"mouseDownEvent",value:function(t){var e=this;this._startScrollPoint={x:t.localX,y:t.localY},this._chartData.startScroll(),this._performCross(t,!0,(function(a){var i={x:t.localX,y:a.y};if(e._touchZoomed=!1,e._touchPoint){var n=t.localX-e._touchPoint.x,r=t.localY-e._touchPoint.y;10>Math.sqrt(n*n+r*r)?(e._touchPoint={x:t.localX,y:t.localY},e._chartData.setCrossHairPointPaneTag(i,a.tag)):(e._touchCancelCrossHair=!0,e._touchPoint=null,e._chartData.setCrossHairPointPaneTag(null,null))}else e._touchCancelCrossHair=!1}))}},{key:"pressedMouseMoveEvent",value:function(t){var e=this;this._performCross(t,!1,(function(a){var i={x:t.localX,y:a.y};if(ae(t)&&e._touchPoint)return e._touchPoint={x:t.localX,y:t.localY},void e._chartData.setCrossHairPointPaneTag(i,a.tag);var n=t.localX-e._startScrollPoint.x;e._chartData.setCrossHairPointPaneTag(i,a.tag),e._chartData.scroll(n)}))}},{key:"longTapEvent",value:function(t){var e=this;this._performCross(t,!0,(function(a){e._touchPoint={x:t.localX,y:t.localY},e._chartData.setCrossHairPointPaneTag({x:t.localX,y:a.y},a.tag)}))}},{key:"_performCross",value:function(t,e,a,i){if(!e||ae(t))if(this._checkEventPointX(t.localX)){var n=!1;for(var r in this._paneContentSize){var o=this._paneContentSize[r];if(t.localY>o.contentTop&&o.contentBottom>t.localY){n=!0,a&&a({tag:r,y:t.localY-o.contentTop});break}}!n&&i&&i()}else i&&i()}}]),i}(ne),xe=function(t){o(i,t);var e=l(i);function i(){return a(this,i),e.apply(this,arguments)}return n(i,[{key:"keyBoardDownEvent",value:function(t){if(t.shiftKey)switch(t.code){case"ArrowUp":this._chartData.zoom(-.5);break;case"ArrowDown":this._chartData.zoom(.5);break;case"ArrowLeft":this._chartData.startScroll(),this._chartData.scroll(-this._chartData.dataSpace());break;case"ArrowRight":this._chartData.startScroll(),this._chartData.scroll(this._chartData.dataSpace())}}}]),i}(ne),we=function(){function t(e,i,n,r){a(this,t),this._target=e,this._chartData=i,this._chartContentSize={},this._event=new ee(this._target,{pinchStartEvent:this._pinchStartEvent.bind(this),pinchEvent:this._pinchEvent.bind(this),mouseUpEvent:this._mouseUpEvent.bind(this),mouseClickEvent:this._mouseClickEvent.bind(this),mouseDownEvent:this._mouseDownEvent.bind(this),mouseRightDownEvent:this._mouseRightDownEvent.bind(this),mouseLeaveEvent:this._mouseLeaveEvent.bind(this),mouseMoveEvent:this._mouseMoveEvent.bind(this),mouseWheelEvent:this._mouseWheelEvent.bind(this),pressedMouseMoveEvent:this._pressedMouseMoveEvent.bind(this),longTapEvent:this._longTapEvent.bind(this)},{treatVertTouchDragAsPageScroll:!1,treatHorzTouchDragAsPageScroll:!1}),this._boundKeyBoardDownEvent=this._keyBoardDownEvent.bind(this),this._target.addEventListener("keydown",this._boundKeyBoardDownEvent),this._boundContextMenuEvent=function(t){t.preventDefault()},this._target.addEventListener("contextmenu",this._boundContextMenuEvent,!1),this._zoomScrollEventHandler=new ge(i),this._graphicMarkEventHandler=new le(i,n,r),this._keyBoardEventHandler=new xe(i)}return n(t,[{key:"_keyBoardDownEvent",value:function(t){this._keyBoardEventHandler.keyBoardDownEvent(t)}},{key:"_pinchStartEvent",value:function(){this._zoomScrollEventHandler.pinchStartEvent()}},{key:"_pinchEvent",value:function(t,e){this._zoomScrollEventHandler.pinchEvent(t,e)}},{key:"_mouseUpEvent",value:function(t){this._target.style.cursor="crosshair",t.localX-=this._chartContentSize.contentLeft,this._graphicMarkEventHandler.mouseUpEvent(t)}},{key:"_mouseLeaveEvent",value:function(t){this._checkZoomScroll()&&(t.localX-=this._chartContentSize.contentLeft,this._zoomScrollEventHandler.mouseLeaveEvent(t))}},{key:"_mouseMoveEvent",value:function(t){t.localX-=this._chartContentSize.contentLeft,this._chartData.shouldInvalidateGraphicMark()&&this._graphicMarkEventHandler.mouseMoveEvent(t),this._checkZoomScroll()&&this._zoomScrollEventHandler.mouseMoveEvent(t)}},{key:"_mouseWheelEvent",value:function(t){this._checkZoomScroll()&&this._zoomScrollEventHandler.mouseWheelEvent(t)}},{key:"_mouseClickEvent",value:function(t){this._checkZoomScroll()&&(t.localX-=this._chartContentSize.contentLeft,this._zoomScrollEventHandler.mouseClickEvent(t))}},{key:"_mouseDownEvent",value:function(t){this._target.style.cursor="pointer",t.localX-=this._chartContentSize.contentLeft,this._graphicMarkEventHandler.mouseDownEvent(t),this._checkZoomScroll()&&this._zoomScrollEventHandler.mouseDownEvent(t)}},{key:"_mouseRightDownEvent",value:function(t){t.localX-=this._chartContentSize.contentLeft,this._graphicMarkEventHandler.mouseRightDownEvent(t)}},{key:"_pressedMouseMoveEvent",value:function(t){t.localX-=this._chartContentSize.contentLeft,this._chartData.dragGraphicMarkFlag()&&(this._graphicMarkEventHandler.pressedMouseMoveEvent(t),this._chartData.crossHair().paneTag&&this._chartData.setCrossHairPointPaneTag(null,null)),this._checkZoomScroll()&&this._zoomScrollEventHandler.pressedMouseMoveEvent(t)}},{key:"_longTapEvent",value:function(t){this._checkZoomScroll()&&(t.localX-=this._chartContentSize.contentLeft,this._zoomScrollEventHandler.longTapEvent(t))}},{key:"_checkZoomScroll",value:function(){return!this._chartData.dragGraphicMarkFlag()&&this._chartData.graphicMarkType()===ot}},{key:"setChartContentSize",value:function(t){this._chartContentSize=t,this._zoomScrollEventHandler.setChartContentSize(t),this._graphicMarkEventHandler.setChartContentSize(t)}},{key:"setPaneContentSize",value:function(t){this._zoomScrollEventHandler.setPaneContentSize(t),this._graphicMarkEventHandler.setPaneContentSize(t)}},{key:"destroy",value:function(){this._event.destroy(),this._target.removeEventListener("keydown",this._boundKeyBoardDownEvent),this._target.removeEventListener("contextmenu",this._boundContextMenuEvent)}}]),t}();function be(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:16,a=0;return function(){var i=Date.now(),n=this,r=arguments;i-a>e&&(t.apply(n,r),a=i)}}var Pe="candle_stick_pane_tag",Ce=function(){function t(e,i){a(this,t),this._initChartContainer(e),this._technicalIndicatorBaseId=0,this._technicalIndicatorPanes=[],this._separatorPanes=[],this._separatorDragStartTechnicalIndicatorHeight=0,this._chartData=new gt(i,this._updatePane.bind(this)),this._xAxisPane=new me({container:this._chartContainer,chartData:this._chartData}),this._candleStickPane=new ve({container:this._chartContainer,chartData:this._chartData,xAxis:this._xAxisPane.xAxis(),technicalIndicatorType:"MA",tag:Pe}),this._chartEvent=new we(this._chartContainer,this._chartData,this._xAxisPane.xAxis(),this._candleStickPane.yAxis()),this._measurePaneHeight(),this._layoutPane()}return n(t,[{key:"_initChartContainer",value:function(t){this._container=t,this._chartContainer=document.createElement("div"),this._chartContainer.style.userSelect="none",this._chartContainer.style.webkitUserSelect="none",this._chartContainer.style.msUserSelect="none",this._chartContainer.style.MozUserSelect="none",this._chartContainer.style.webkitTapHighlightColor="transparent",this._chartContainer.style.position="relative",this._chartContainer.style.outline="none",this._chartContainer.style.borderStyle="none",this._chartContainer.style.width="100%",this._chartContainer.style.cursor="crosshair",this._chartContainer.tabIndex=1,t.appendChild(this._chartContainer)}},{key:"_separatorStartDrag",value:function(t){this._separatorDragStartTechnicalIndicatorHeight=this._technicalIndicatorPanes[t].height()}},{key:"_separatorDrag",value:function(t,e){var a=this._separatorDragStartTechnicalIndicatorHeight-t;0>a&&(a=0),this._technicalIndicatorPanes[e].setHeight(a),this._measurePaneHeight(),this._candleStickPane.layout();var i,n=d(this._technicalIndicatorPanes);try{for(n.s();!(i=n.n()).done;)i.value.layout()}catch(t){n.e(t)}finally{n.f()}}},{key:"_layoutPane",value:function(){this._measurePaneWidth(),this._xAxisPane.computeAxis(),this._xAxisPane.layout(),this._candleStickPane.layout();var t,e=d(this._technicalIndicatorPanes);try{for(e.s();!(t=e.n()).done;)t.value.layout()}catch(t){e.e(t)}finally{e.f()}}},{key:"_updatePane",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:4;if(2===t){this._xAxisPane.invalidate(t),this._candleStickPane.invalidate(t);var e,a=d(this._technicalIndicatorPanes);try{for(a.s();!(e=a.n()).done;){var i=e.value;i.invalidate(t)}}catch(t){a.e(t)}finally{a.f()}}else{if(this._candleStickPane.computeAxis(),1!==t){var n,r=d(this._technicalIndicatorPanes);try{for(r.s();!(n=r.n()).done;){var o=n.value;o.computeAxis()}}catch(t){r.e(t)}finally{r.f()}}this._layoutPane()}}},{key:"_calcAllPaneTechnicalIndicator",value:function(){var t=this;Promise.resolve().then((function(e){t._chartData.calcTechnicalIndicator(t._candleStickPane);var a,i=d(t._technicalIndicatorPanes);try{for(i.s();!(a=i.n()).done;)t._chartData.calcTechnicalIndicator(a.value)}catch(t){i.e(t)}finally{i.f()}t._layoutPane()}))}},{key:"_measurePaneHeight",value:function(){var t,e=this._chartData.styleOptions(),a=this._container.offsetHeight,i=e.separator.size*this._separatorPanes.length,n=this._xAxisPane.getSelfAxisHeight(),r=a-n-i,o=0,c=d(this._technicalIndicatorPanes);try{for(c.s();!(t=c.n()).done;){var s=t.value,l=s.height();if((o+=l)>r){var h=o-r;o=r,s.setHeight(l-h)}}}catch(t){c.e(t)}finally{c.f()}var u=r-o,v={};v[Pe]={contentTop:0,contentBottom:u};var p=u,_=u;this._candleStickPane.setHeight(u);for(var f=0;this._technicalIndicatorPanes.length>f;f++){var y=this._technicalIndicatorPanes[f],m=y.height();y.setHeight(m),_+=m,v[y.tag()]={contentTop:p,contentBottom:_},p=_}this._xAxisPane.setHeight(n),this._chartEvent.setPaneContentSize(v)}},{key:"_measurePaneWidth",value:function(){var t,e,a,i,n=this._chartData.styleOptions().yAxis,r=n.position===w,o=this._container.offsetWidth;if(n.inside)t=o,e=o,a=0,i=0;else{e=this._candleStickPane.getSelfAxisWidth();var c,s=d(this._technicalIndicatorPanes);try{for(s.s();!(c=s.n()).done;)e=Math.max(e,c.value.getSelfAxisWidth())}catch(t){s.e(t)}finally{s.f()}t=o-e,r?(a=0,i=e):(i=0,a=o-e)}this._chartData.setTotalDataSpace(t),this._candleStickPane.setWidth(t,e),this._candleStickPane.setOffsetLeft(i,a);for(var l=0;this._technicalIndicatorPanes.length>l;l++){var h=this._technicalIndicatorPanes[l],u=this._separatorPanes[l];h.setWidth(t,e),h.setOffsetLeft(i,a),u.setSize(i,t)}this._xAxisPane.setWidth(t,e),this._xAxisPane.setOffsetLeft(i,a),this._chartEvent.setChartContentSize({contentLeft:i,contentRight:i+t})}},{key:"chartData",value:function(){return this._chartData}},{key:"resize",value:function(){this._measurePaneHeight(),this._candleStickPane.computeAxis();var t,e=d(this._technicalIndicatorPanes);try{for(e.s();!(t=e.n()).done;)t.value.computeAxis()}catch(t){e.e(t)}finally{e.f()}this._layoutPane()}},{key:"applyTechnicalIndicatorParams",value:function(t,e){var a=this,i=this._chartData.technicalIndicator(t);if(i.structure&&_(e)){var n,r=d(e);try{for(r.s();!(n=r.n()).done;){var o=n.value;if(!m(o)||0>=o||parseInt(o,10)!==o)return}}catch(t){r.e(t)}finally{r.f()}i.calcParams=p(e),Promise.resolve().then((function(e){a._candleStickPane.technicalIndicator().name===t&&a._chartData.calcTechnicalIndicator(a._candleStickPane);var i,n=d(a._technicalIndicatorPanes);try{for(n.s();!(i=n.n()).done;){var r=i.value;r.technicalIndicator().name===t&&a._chartData.calcTechnicalIndicator(r)}}catch(t){n.e(t)}finally{n.f()}a._layoutPane()}))}}},{key:"_applyDataList",value:function(t,e,a){_(t)&&(f(a)&&a(),this._chartData.addData(t,0,e),this._calcAllPaneTechnicalIndicator())}},{key:"applyNewData",value:function(t,e){var a=this;this._applyDataList(t,e,(function(){a._chartData.clearDataList()}))}},{key:"applyMoreData",value:function(t,e){this._applyDataList(t,e)}},{key:"updateData",value:function(t){if(y(t)&&!_(t)){var e=this._chartData.dataList(),a=e.length,i=a;+E(t,"timestamp",0)===+E(e[a-1],"timestamp",0)&&(i=a-1),this._chartData.addData(t,i),this._calcAllPaneTechnicalIndicator()}}},{key:"setCandleStickChartType",value:function(t){this._candleStickPane.setChartType(t)}},{key:"createTechnicalIndicator",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"MACD",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100,a=arguments.length>2?arguments[2]:void 0,i=this._chartData.technicalIndicator(t),n=i.structure;if(!n)return null;var r=this._technicalIndicatorPanes.length,o=!g(a)||a;this._separatorPanes.push(new ke(this._chartContainer,this._chartData,r,o,{startDrag:this._separatorStartDrag.bind(this),drag:be(this._separatorDrag.bind(this),50)})),this._technicalIndicatorBaseId++;var c="".concat("technical_indicator_").concat(this._technicalIndicatorBaseId),s=new Bt({container:this._chartContainer,chartData:this._chartData,xAxis:this._xAxisPane.xAxis(),technicalIndicatorType:t,tag:c});return s.setHeight(e),this._technicalIndicatorPanes.push(s),this._measurePaneHeight(),this._layoutPane(),c}},{key:"removeTechnicalIndicator",value:function(t){for(var e=-1,a=0;this._technicalIndicatorPanes.length>a;a++)if(this._technicalIndicatorPanes[a].tag()===t){e=a;break}if(-1!==e){this._technicalIndicatorPanes[e].destroy(),this._separatorPanes[e].destroy(),this._technicalIndicatorPanes.splice(e,1),this._separatorPanes.splice(e,1);for(var i=0;this._separatorPanes.length>i;i++)this._separatorPanes[i].updatePaneIndex(i);this._measurePaneHeight(),this._layoutPane()}}},{key:"setTechnicalIndicatorType",value:function(t,e){if(t===Pe)this._candleStickPane.setTechnicalIndicatorType(e),this._layoutPane();else{var a,i,n=d(this._technicalIndicatorPanes);try{for(n.s();!(i=n.n()).done;){var r=i.value;if(r.tag()===t){a=r;break}}}catch(t){n.e(t)}finally{n.f()}a&&(this._chartData.technicalIndicator(e).structure?(a.setTechnicalIndicatorType(e),this._layoutPane()):this.removeTechnicalIndicator(t))}}},{key:"setTimezone",value:function(t){this._chartData.setTimezone(t),this._xAxisPane.invalidate(4)}},{key:"getConvertPictureUrl",value:function(t,e){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"jpeg",i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"#333333";if("png"!==a&&"jpeg"!==a&&"bmp"!==a)throw Error("Picture format only supports jpeg, png and bmp!!!");var n=document.createElement("canvas"),r=n.getContext("2d"),o=xt(r),c=this._chartContainer.offsetWidth,s=this._chartContainer.offsetHeight;n.style.width="".concat(c,"px"),n.style.height="".concat(s,"px"),n.width=c*o,n.height=s*o,r.scale(o,o),r.fillStyle=i,r.fillRect(0,0,c,s);var l=0,h=this._candleStickPane.height();r.drawImage(this._candleStickPane.getImage(t,e),0,l,c,h),l+=h;for(var u=0;this._separatorPanes.length>u;u++){var d=this._separatorPanes[u],v=d.height(),p=this._technicalIndicatorPanes[u],_=p.height();r.drawImage(d.getImage(),0,l,c,v),l+=v,r.drawImage(p.getImage(t),0,l,c,_),l+=_}return r.drawImage(this._xAxisPane.getImage(t),0,l,c,this._xAxisPane.height()),n.toDataURL("image/".concat(a))}},{key:"destroy",value:function(){this._candleStickPane.destroy(),this._technicalIndicatorPanes.forEach((function(t){t.destroy()})),this._separatorPanes.forEach((function(t){t.destroy()})),this._xAxisPane.destroy(),this._container.removeChild(this._chartContainer),this._chartEvent.destroy()}}]),t}(),Te=function(){function t(e,i){a(this,t),this._chartPane=new Ce(e,i)}return n(t,[{key:"setStyleOptions",value:function(t){t&&(this._chartPane.chartData().applyStyleOptions(t),this._chartPane.resize())}},{key:"getStyleOptions",value:function(){return p(this._chartPane.chartData().styleOptions())}},{key:"setTechnicalIndicatorParams",value:function(t,e){t&&this._chartPane.applyTechnicalIndicatorParams(t,e)}},{key:"getTechnicalIndicatorParamOptions",value:function(){return this._chartPane.chartData().technicalIndicatorCalcParams()}},{key:"setPrecision",value:function(t,e){this._chartPane.chartData().applyPrecision(t,e)}},{key:"setTechnicalIndicatorPrecision",value:function(t,e){this._chartPane.chartData().applyTechnicalIndicatorPrecision(t,e)}},{key:"setTimezone",value:function(t){this._chartPane.setTimezone(t)}},{key:"resize",value:function(){this._chartPane.resize()}},{key:"setOffsetRightSpace",value:function(t){this._chartPane.chartData().setOffsetRightSpace(t)}},{key:"setLeftMinVisibleBarCount",value:function(t){this._chartPane.chartData().setLeftMinVisibleBarCount(t)}},{key:"setRightMinVisibleBarCount",value:function(t){this._chartPane.chartData().setRightMinVisibleBarCount(t)}},{key:"setDataSpace",value:function(t){this._chartPane.chartData().setDataSpace(t)}},{key:"clearData",value:function(){this._chartPane.chartData().clearDataList()}},{key:"getDataList",value:function(){return this._chartPane.chartData().dataList()}},{key:"applyNewData",value:function(t,e){this._chartPane.applyNewData(t,e)}},{key:"applyMoreData",value:function(t,e){this._chartPane.applyMoreData(t,e)}},{key:"updateData",value:function(t){this._chartPane.updateData(t)}},{key:"loadMore",value:function(t){this._chartPane.chartData().loadMore(t)}},{key:"setCandleStickChartType",value:function(t){this._chartPane.setCandleStickChartType(t)}},{key:"setCandleStickTechnicalIndicatorType",value:function(t){t&&this._chartPane.setTechnicalIndicatorType(Pe,t)}},{key:"setTechnicalIndicatorType",value:function(t,e){t&&this._chartPane.setTechnicalIndicatorType(t,e)}},{key:"createTechnicalIndicator",value:function(t,e,a){return this._chartPane.createTechnicalIndicator(t,e,a)}},{key:"addCustomTechnicalIndicator",value:function(t){this._chartPane.chartData().addCustomTechnicalIndicator(t)}},{key:"removeTechnicalIndicator",value:function(t){t&&this._chartPane.removeTechnicalIndicator(t)}},{key:"addGraphicMark",value:function(t){var e=this._chartPane.chartData().graphicMarkType();if(e!==t){var a=this._chartPane.chartData().graphicMarkData(),i=a[e];i&&_(i)&&(i.splice(i.length-1,1),a[e]=i),a.hasOwnProperty(t)||(t=ot),this._chartPane.chartData().setGraphicMarkType(t),this._chartPane.chartData().setGraphicMarkData(a)}}},{key:"removeAllGraphicMark",value:function(){var t=this._chartPane.chartData().graphicMarkData(),e={};Object.keys(t).forEach((function(t){e[t]=[]})),this._chartPane.chartData().setGraphicMarkType(ot),this._chartPane.chartData().setGraphicMarkData(e)}},{key:"getConvertPictureUrl",value:function(t,e,a,i){return this._chartPane.getConvertPictureUrl(t,e,a,i)}},{key:"destroy",value:function(){this._chartPane.destroy()}}]),t}(),De={},Me=1;t.dispose=function(t){var e;t&&("string"==typeof t&&(e=(t=document.getElementById(t)||document.getElementsByClassName(t)).chartId),e||(e=t.chartId),!e&&t instanceof Te&&(e=t.id),e&&(De[e].destroy(),delete De[e]))},t.init=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a="Chart version is 5.5.0. Root dom is null, can not initialize the chart!!!",i=t;if(!i)throw Error(a);if("string"==typeof i&&(i=document.getElementById(t)||document.getElementsByClassName(t)),!i)throw Error(a);var n=De[i.chartId||""];if(n)return n;var r="".concat("k_line_chart_").concat(Me++),o=new Te(i,e);return o.id=r,i.chartId=r,De[r]=o,o},t.version=function(){return"5.5.0"},Object.defineProperty(t,"__esModule",{value:!0})}(e)},148:function(t,e,a){},149:function(t,e,a){},150:function(t,e,a){},33:function(t,e,a){var i,n,r;"undefined"!==typeof globalThis?globalThis:"undefined"!==typeof self&&self,n=[e,a(351),a(352),a(353),a(354),a(355)],void 0===(r="function"===typeof(i=function(t,e,a,i,n,r){"use strict";function o(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"simpleMovingAverage",{enumerable:!0,get:function(){return e.default}}),Object.defineProperty(t,"bullAndBearIndex",{enumerable:!0,get:function(){return a.default}}),Object.defineProperty(t,"rateOfChange",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(t,"priceAndVolumeTrend",{enumerable:!0,get:function(){return n.default}}),Object.defineProperty(t,"awesomeOscillator",{enumerable:!0,get:function(){return r.default}}),e=o(e),a=o(a),i=o(i),n=o(n),r=o(r)})?i.apply(e,n):i)||(t.exports=r)},346:function(t,e,a){},347:function(t,e,a){},348:function(t,e,a){},349:function(t,e,a){},350:function(t,e,a){},351:function(t,e,a){var i,n,r;"undefined"!==typeof globalThis?globalThis:"undefined"!==typeof self&&self,n=[e],void 0===(r="function"===typeof(i=function(t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var e={name:"SMA",calcParams:[12,2],series:"price",precision:2,plots:[{key:"sma",type:"line"}],shouldCheckParamCount:!0,shouldOhlc:!0,calcTechnicalIndicator:function(t,e){var a=0,i=[];return t.forEach((function(t,n){var r={},o=t.close;r.sma=0===n?o:(o*e[1]+a*(e[0]-e[1]+1))/(e[0]+1),a=r.sma,i.push(r)})),i}};t.default=e})?i.apply(e,n):i)||(t.exports=r)},352:function(t,e,a){var i,n,r;"undefined"!==typeof globalThis?globalThis:"undefined"!==typeof self&&self,n=[e],void 0===(r="function"===typeof(i=function(t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var e={name:"BBI",series:"price",precision:2,calcParams:[3,6,12,24],shouldCheckParamCount:!0,shouldOhlc:!0,plots:[{key:"bbi",type:"line"}],calcTechnicalIndicator:function(t,e){var a=Math.max.apply(null,e),i=[],n=[],r=[];return t.forEach((function(o,c){var s={},l=o.close;if(e.forEach((function(e,a){i[a]=(i[a]||0)+l,c>=e-1&&(n[a]=i[a]/e,i[a]-=t[c-(e-1)].close)})),c>=a-1){var h=0;n.forEach((function(t){h+=t})),s.bbi=h/4}r.push(s)})),r}};t.default=e})?i.apply(e,n):i)||(t.exports=r)},353:function(t,e,a){var i,n,r;"undefined"!==typeof globalThis?globalThis:"undefined"!==typeof self&&self,n=[e],void 0===(r="function"===typeof(i=function(t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var e={name:"ROC",calcParams:[12,6],shouldCheckParamCount:!0,plots:[{key:"roc",type:"line"},{key:"rocMa",type:"line"}],calcTechnicalIndicator:function(t,e){var a=[],i=0;return t.forEach((function(n,r){var o={};if(r>=e[0]-1){var c=n.close,s=t[r-(e[0]-1)].close;o.roc=0!==s?(c-s)/s:0,i+=o.roc,r>=e[0]-1+e[1]-1&&(o.rocMa=i/e[1],i-=a[r-(e[1]-1)].roc)}a.push(o)})),a}};t.default=e})?i.apply(e,n):i)||(t.exports=r)},354:function(t,e,a){var i,n,r;"undefined"!==typeof globalThis?globalThis:"undefined"!==typeof self&&self,n=[e],void 0===(r="function"===typeof(i=function(t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var e={name:"PVT",plots:[{key:"pvt",type:"line"}],calcTechnicalIndicator:function(t){var e=[],a=0;return t.forEach((function(i,n){var r={};if(n>0){var o=i.close,c=i.volume,s=t[n-1].close,l=0;0!==s&&(l=(o-s)/s*c),a+=l,r.pvt=a}e.push(r)})),e}};t.default=e})?i.apply(e,n):i)||(t.exports=r)},355:function(t,e,a){var i,n,r;"undefined"!==typeof globalThis?globalThis:"undefined"!==typeof self&&self,n=[e],void 0===(r="function"===typeof(i=function(t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var e={name:"AO",calcParams:[5,34],shouldCheckParamCount:!0,plots:[{key:"ao",type:"bar",color:function(t,e){var a=t.preData,i=t.currentData,n=(a.technicalIndicatorData||{}).ao;return(i.technicalIndicatorData||{}).ao>n?e.bar.upColor:e.bar.downColor},isStroke:function(t){var e=t.preData,a=t.currentData,i=(e.technicalIndicatorData||{}).ao;return(a.technicalIndicatorData||{}).ao>i}}],baseValue:0,calcTechnicalIndicator:function(t,e){var a=Math.max(e[0],e[1]),i=[],n=0,r=0,o=0,c=0;return t.forEach((function(s,l){var h={},u=(s.low+s.high)/2;if(n+=u,r+=u,l>=e[0]-1){o=n/e[0];var d=t[l-(e[0]-1)];n-=(d.low+d.high)/2}if(l>=e[1]-1){c=r/e[1];var v=t[l-(e[1]-1)];r-=(v.low+v.high)/2}l>=a-1&&(h.ao=o-c),i.push(h)})),i}};t.default=e})?i.apply(e,n):i)||(t.exports=r)},356:function(t,e,a){},357:function(t,e,a){},358:function(t,e,a){},359:function(t,e,a){},361:function(t,e,a){"use strict";a.r(e);a(139),a(142);var i=a(0),n=a.n(i),r=a(134),o=a.n(r),c=a(59),s=a(40),l=a(2),h=a(3),u=a(5),d=a(4),v=a(39),p={"zh-CN":a(135),en:a(136)},_="zh-CN";function f(t){return(p[_]||p["zh-CN"])[t]||"--"}var y=["Line","1m","5m","15m","30m","1H","2H","4H","6H","12H","1D","1W","1M","1Y"],m=[{key:"horizontalStraightLine",icon:"icon-horizontal-straight-line"},{key:"horizontalRayLine",icon:"icon-horizontal-ray-line"},{key:"horizontalSegmentLine",icon:"icon-horizontal-segment-line"},{key:"priceLine",icon:"icon-price-line"},{key:"verticalStraightLine",icon:"icon-vertical-straight-line"},{key:"verticalRayLine",icon:"icon-vertical-ray-line"},{key:"verticalSegmentLine",icon:"icon-vertical-segment-line"},{key:"straightLine",icon:"icon-straight-line"},{key:"rayLine",icon:"icon-ray-line"},{key:"segmentLine",icon:"icon-segment-line"},{key:"parallelStraightLine",icon:"icon-parallel-straight-line"},{key:"priceChannelLine",icon:"icon-price-channel-line"},{key:"fibonacciLine",icon:"icon-fibonacci-line"}],k=["MA","EMA","SMA","BOLL","SAR","BBI"],g=["MA","EMA","VOL","MACD","BOLL","KDJ","RSI","BIAS","BRAR","CCI","DMI","CR","PSY","DMA","TRIX","OBV","VR","WR","MTM","EMV","SAR","SMA","ROC","PVT","BBI","AO"],x=["main_view_style","chart_background","axis","timezone"],w=[{key:"candleStick.bar.style",title:"candlestick_style",componentType:"select",dataSource:[{key:"solid",text:f("solid")},{key:"stroke",text:f("stroke")},{key:"up_stroke",text:f("up_stroke")},{key:"down_stroke",text:f("down_stroke")},{key:"ohlc",text:f("ohlc")}]},{key:"candleStick.bar.color",title:"candlestick_color",componentType:"colorGroup",dataSource:[{key:"candleStick.bar.upColor",label:f("up"),style:{marginRight:40}},{key:"candleStick.bar.downColor",label:f("down"),style:{marginRight:40}},{key:"candleStick.bar.noChangeColor",label:f("no_change"),shouldClassName:!0}]},{key:"candleStick.priceMark.high",componentType:"compose",dataSource:[{key:"candleStick.priceMark.high.display",componentType:"checkbox",label:"high_price",style:{width:140}},{key:"candleStick.priceMark.high.color",componentType:"color",style:{marginRight:40}},{key:"candleStick.priceMark.high.textSize",componentType:"input",style:{width:60}}]},{key:"candleStick.priceMark.low",componentType:"compose",dataSource:[{key:"candleStick.priceMark.low.display",componentType:"checkbox",label:"low_price",style:{width:140}},{key:"candleStick.priceMark.low.color",componentType:"color",style:{marginRight:40}},{key:"candleStick.priceMark.low.textSize",componentType:"input",style:{width:60}}]},{key:"realTime.timeLine",title:"time_line",componentType:"compose",dataSource:[{key:"realTime.timeLine.color",componentType:"color",style:{marginRight:40}},{key:"realTime.timeLine.size",componentType:"input",style:{width:60,marginRight:40}},{key:"realTime.timeLine.areaFillColor",componentType:"color"}]},{key:"realTime.averageLine",componentType:"compose",title:"trade_average_line",dataSource:[{key:"realTime.averageLine.color",componentType:"color",style:{marginRight:40}},{key:"realTime.averageLine.size",componentType:"input",style:{width:60}}]}],b=[{key:"separator",title:"chart_separator_line",componentType:"compose",dataSource:[{key:"separator.color",componentType:"color",style:{marginRight:40}},{key:"separator.size",componentType:"input",style:{width:60}}]},{key:"grid.horizontal",componentType:"compose",dataSource:[{key:"grid.horizontal.display",componentType:"checkbox",label:"grid_horizontal_line",style:{width:140}},{key:"grid.horizontal.color",componentType:"color",style:{marginRight:40}},{key:"grid.horizontal.size",componentType:"input",style:{width:60}}]},{key:"grid.vertical",componentType:"compose",dataSource:[{key:"grid.vertical.display",componentType:"checkbox",label:"grid_vertical_line",style:{width:140}},{key:"grid.vertical.color",componentType:"color",style:{marginRight:40}},{key:"grid.vertical.size",componentType:"input",style:{width:60}}]},{key:"crosshair.horizontal",componentType:"compose",dataSource:[{key:"floatLayer.crossHair.horizontal.display",componentType:"checkbox",label:"crosshair_horizontal_line",style:{width:140}},{key:"floatLayer.crossHair.horizontal.line.color",componentType:"color",style:{marginRight:40}},{key:"floatLayer.crossHair.horizontal.line.size",componentType:"input",style:{width:60}}]},{key:"crosshair.vertical",componentType:"compose",dataSource:[{key:"floatLayer.crossHair.vertical.display",componentType:"checkbox",label:"crosshair_vertical_line",style:{width:140}},{key:"floatLayer.crossHair.vertical.line.color",componentType:"color",style:{marginRight:40}},{key:"floatLayer.crossHair.vertical.line.size",componentType:"input",style:{width:60}}]}],P=[{key:"yAxis.type",title:"y_axis_type",componentType:"radioGroup",radioStyle:{marginRight:40},dataSource:[{label:f("line_axis"),value:"normal"},{label:f("percentage_axis"),value:"percentage"}]},{key:"yAxis.position",title:"y_axis_position",componentType:"compose",dataSource:[{key:"yAxis.position",componentType:"radioGroup",radioStyle:{marginRight:40},dataSource:[{label:f("left"),value:"left"},{label:f("right"),value:"right"}]},{key:"yAxis.inside",componentType:"checkbox",label:"inside",style:{marginLeft:20}}]}],C=[{key:"timezone",componentType:"select",style:{width:160},dataSource:[{key:"Etc/UTC",text:f("utc"),utc:""},{key:"Pacific/Honolulu",text:f("honolulu")},{key:"America/Juneau",text:f("juneau")},{key:"America/Los_Angeles",text:f("los_angeles")},{key:"America/Chicago",text:f("chicago")},{key:"America/Toronto",text:f("toronto")},{key:"America/Sao_Paulo",text:f("sao_paulo")},{key:"Europe/London",text:f("london")},{key:"Europe/Berlin",text:f("berlin")},{key:"Asia/Bahrain",text:f("bahrain")},{key:"Asia/Dubai",text:f("dubai")},{key:"Asia/Ashkhabad",text:f("ashkhabad")},{key:"Asia/Almaty",text:f("almaty")},{key:"Asia/Bangkok",text:f("bangkok")},{key:"Asia/Shanghai",text:f("shanghai")},{key:"Asia/Tokyo",text:f("tokyo")},{key:"Australia/Sydney",text:f("sydney")},{key:"Pacific/Norfolk",text:f("norfolk")}]}],T=a(58);function D(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:16,a=0;return function(){var i=Date.now(),n=this,r=arguments;i-a>e&&(t.apply(n,r),a=i)}}a(148);var M=function(t){Object(u.a)(a,t);var e=Object(d.a)(a);function a(){var t;Object(l.a)(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(t=e.call.apply(e,[this].concat(r))).contentEl=Object(i.createRef)(),t.startDragPoint={},t.startContentElRect={},t.mouseMove=D((function(e){var a=e.clientX-t.startDragPoint.x,i=e.clientY-t.startDragPoint.y,n=t.startContentElRect.left,r=t.startContentElRect.top,o=n+a;o<0?o=0:t.startContentElRect.width;var c=r+i;c<0&&(c=0),t.contentEl.current.style.left="".concat(o,"px"),t.contentEl.current.style.top="".concat(c,"px")})),t.onTitleMouseDown=function(e){t.startDragPoint={x:e.clientX,y:e.clientY},t.startContentElRect=t.contentEl.current.getBoundingClientRect(),t.bindEvent()},t.onTitleMouseUp=function(){t.unbindEvent()},t.unbindEvent=function(){document.removeEventListener("mousemove",t.mouseMove),document.removeEventListener("mouseup",t.unbindEvent)},t}return Object(h.a)(a,[{key:"bindEvent",value:function(){document.addEventListener("mousemove",this.mouseMove),document.addEventListener("mouseup",this.unbindEvent)}},{key:"componentDidMount",value:function(){var t=this.contentEl.current.getBoundingClientRect();this.contentEl.current.style.left="calc(50% - ".concat(t.width/2,"px)"),this.contentEl.current.style.top="calc(50% - ".concat(t.height/2,"px)")}},{key:"componentWillUnmount",value:function(){this.unbindEvent()}},{key:"render",value:function(){var t=this.props,e=t.theme,a=t.title,i=t.children,r=t.onClose;return n.a.createElement("div",{className:"modal-".concat(e)},n.a.createElement("div",{ref:this.contentEl,className:"modal-inner"},n.a.createElement("div",{className:"modal-inner-title-container",onMouseDown:this.onTitleMouseDown,onMouseUp:this.onTitleMouseUp},a&&n.a.createElement("span",null,a),n.a.createElement("i",{className:"modal-inner-title-close icon-close",onClick:r})),i))}}]),a}(i.PureComponent);M.defaultProps={theme:"dark"};a(149);var S=function(t){Object(u.a)(a,t);var e=Object(d.a)(a);function a(t){var i;return Object(l.a)(this,a),(i=e.call(this,t)).onClick=function(){return function(){var t=i.props.onChange,e=!i.state.checked;t&&t(e),i.setState({checked:e})}},i.state={checked:t.checked||t.defaultChecked},i}return Object(h.a)(a,[{key:"render",value:function(){var t=this.props,e=t.theme,a=t.className,i=t.style,r=t.iconClassName,o=t.iconStyle,c=t.labelClassName,s=t.labelStyle,l=t.label,h=t.trigger,u=this.state.checked,d="icon"===h||"all"===h?{onClick:this.onClick()}:{},v="label"===h||"all"===h?{onClick:this.onClick()}:{};return n.a.createElement("div",{style:i,className:"checkbox-".concat(e," ").concat(a)},n.a.createElement("i",Object.assign({style:o},d,{className:"checkbox-icon ".concat(r," ").concat(u?"icon-checked checkbox-icon-checked":"icon-uncheck")})),l&&n.a.createElement("span",Object.assign({style:s},v,{className:"checkbox-label ".concat(c," ").concat(u?"checkbox-label-checked":"")}),l))}}],[{key:"getDerivedStateFromProps",value:function(t,e){return"checked"in t&&t.checked!==e.checked?{checked:t.checked}:null}}]),a}(i.PureComponent);S.defaultProps={theme:"dark",trigger:"all"};var E=function(t){Object(u.a)(a,t);var e=Object(d.a)(a);function a(){var t;Object(l.a)(this,a);for(var i=arguments.length,n=new Array(i),r=0;r<i;r++)n[r]=arguments[r];return(t=e.call.apply(e,[this].concat(n))).onButtonClick=function(e){if(!t.locked){var a=t.props,i=a.throttle,n=a.onClick;n&&n(e),i&&(t.locked=!0,t.timer=setTimeout((function(){t.locked=!1}),i))}},t}return Object(h.a)(a,[{key:"componentWillUnmount",value:function(){this.timer&&clearTimeout(this.timer)}},{key:"render",value:function(){var t=this.props.children;return n.a.createElement("button",Object.assign({},this.props,{onClick:this.onButtonClick}),t)}}]),a}(i.PureComponent),I=(a(150),function(t){Object(u.a)(a,t);var e=Object(d.a)(a);function a(t){var i;return Object(l.a)(this,a),(i=e.call(this,t)).onAddClick=function(){var t=i.props,e=t.max,a=t.tick,n=t.onChange,r=i.state.value,o=r+a;o<=e&&(n&&n(o),i.setState({value:r}))},i.onSubClick=function(){var t=i.props,e=t.min,a=t.tick,n=t.onChange,r=i.state.value,o=r-a;o>=e&&(n&&n(o),i.setState({value:r}))},i.onValueChange=function(t){var e,a=i.props,n=a.min,r=a.max,o=a.precision,c=a.onChange,s=t.target.value,l=Math.max(0,parseInt(o,10));e=l<=0?new RegExp(/^[1-9]\d*$/):new RegExp("/^(0|([1-9][0-9]*))([.][0-9]{0,"+l+"})?$/"),(""===s||e.test(s)&&+s>=n&&+s<=r)&&(c&&c(s),i.setState({value:s}))},i.state={value:t.value||t.defaultValue},i}return Object(h.a)(a,[{key:"render",value:function(){var t=this.props,e=t.theme,a=t.className,i=t.style,r=t.showTickButton;return n.a.createElement("div",{style:i,className:"number-input-".concat(e," ").concat(a)},n.a.createElement("input",{value:this.state.value,onChange:this.onValueChange}),r&&n.a.createElement("div",{className:"number-input-button-container"},n.a.createElement(E,{className:"add-arrow-button",onClick:this.onAddClick},n.a.createElement("i",{className:"add-arrow"})),n.a.createElement(E,{onClick:this.onSubClick},n.a.createElement("i",{className:"sub-arrow"}))))}}],[{key:"getDerivedStateFromProps",value:function(t,e){return"value"in t&&t.value!==e.value?{value:t.value}:null}}]),a}(i.PureComponent));I.defaultProps={theme:"dark",min:Number.MIN_SAFE_INTEGER,max:Number.MAX_SAFE_INTEGER,tick:1,precision:0,showTickButton:!0};var L=function(t){Object(u.a)(a,t);var e=Object(d.a)(a);function a(){var t;Object(l.a)(this,a);for(var i=arguments.length,n=new Array(i),r=0;r<i;r++)n[r]=arguments[r];return(t=e.call.apply(e,[this].concat(n))).state={currentSelectedTechnicalIndicatorType:"MA"},t.onMainTechnicalIndicatorCheckedChange=function(e){return function(a){var i=t.props.onMainTechnicalIndicatorChange,n=e;a||(n="NO"),i(n)}},t.onSubTechnicalIndicatorCheckedChange=function(e){return function(a){(0,t.props.onSubTechnicalIndicatorChange)(e,a?"add":"delete")}},t.technicalIndicatorParamChange=function(e){return function(a){var i=t.props,n=i.technicalIndicatorParams,r=i.onTechnicalIndicatorParamsChange,o=t.state.currentSelectedTechnicalIndicatorType,c=Object(s.a)(n[o]);c[e]=a,r&&r(o,c)}},t.onConfirmClick=function(){var e=t.props,a=e.onTechnicalIndicatorParamsConfirmClick,i=e.onClose,n=t.state.currentSelectedTechnicalIndicatorType;a&&a(n),i&&i()},t.resetDefaultClick=function(){var e=t.props,a=e.defaultTechnicalIndicatorParams,i=e.onTechnicalIndicatorParamsChange,n=t.state.currentSelectedTechnicalIndicatorType,r=Object(s.a)(a[n]);i&&i(n,r)},t.technicalIndicatorTypeSelect=function(e){return function(){t.setState({currentSelectedTechnicalIndicatorType:e})}},t}return Object(h.a)(a,[{key:"renderMainTechnicalIndicator",value:function(){var t=this,e=this.state.currentSelectedTechnicalIndicatorType,a=this.props.mainTechnicalIndicatorType;return n.a.createElement(i.Fragment,null,n.a.createElement("li",{className:"modal-content-list-row-title"},f("main_technical_indicator")),k.map((function(i){var r=a===i;return n.a.createElement("li",{key:i,className:"".concat(e===i&&"modal-content-list-row-selected"," ").concat(r&&"modal-content-list-row-checked"),onClick:t.technicalIndicatorTypeSelect(i)},n.a.createElement(S,{checked:r,labelClassName:"modal-content-list-row-label",label:f(i.toLowerCase()),trigger:"icon",onChange:t.onMainTechnicalIndicatorCheckedChange(i)}))})))}},{key:"renderSubTechnicalIndicator",value:function(){var t=this,e=this.state.currentSelectedTechnicalIndicatorType,a=this.props.subTechnicalIndicatorTypes;return n.a.createElement(i.Fragment,null,n.a.createElement("li",{className:"modal-content-list-row-title"},f("sub_technical_indicator")),g.map((function(i){var r=a.indexOf(i)>-1;return n.a.createElement("li",{key:i,className:"".concat(e===i&&"modal-content-list-row-selected"," ").concat(r&&"modal-content-list-row-checked"),onClick:t.technicalIndicatorTypeSelect(i)},n.a.createElement(S,{labelClassName:"modal-content-list-row-label",checked:r,label:f(i.toLowerCase()),trigger:"icon",onChange:t.onSubTechnicalIndicatorCheckedChange(i)}))})))}},{key:"renderTechnicalIndicatorParams",value:function(){var t=this,e=this.props,a=e.theme;return(e.technicalIndicatorParams[this.state.currentSelectedTechnicalIndicatorType]||[]).map((function(e,i){return n.a.createElement("li",{key:"key_".concat(i)},n.a.createElement("span",{className:"modal-content-technical-indicator-row-title"},f("calc_param"),i+1),n.a.createElement(I,{theme:a,className:"modal-content-technical-indicator-row-input",value:e,min:1,onChange:t.technicalIndicatorParamChange(i)}))}))}},{key:"render",value:function(){var t=this.props,e=t.theme,a=t.onClose;return n.a.createElement(M,{theme:e,title:f("indicator"),onClose:a},n.a.createElement("div",{className:"modal-content-".concat(e)},n.a.createElement(T.a,{style:{height:448}},n.a.createElement("ul",{className:"modal-content-list-container modal-content-left-container"},this.renderMainTechnicalIndicator(),this.renderSubTechnicalIndicator())),n.a.createElement("ul",{className:"modal-content-list-container modal-content-technical-indicator-container"},n.a.createElement("li",{className:"modal-content-list-row-title"},f("params_setting")),this.renderTechnicalIndicatorParams()),n.a.createElement("div",{className:"modal-content-button-container"},n.a.createElement(E,{className:"modal-content-reset-button",onClick:this.resetDefaultClick},f("reset")),n.a.createElement(E,{className:"modal-content-confirm-button",onClick:this.onConfirmClick},f("confirm")))))}}]),a}(i.PureComponent);L.defaultProps={theme:"dark"};var A=a(13),O=a.n(A),R=a(137),z=(a(346),function(t){Object(u.a)(a,t);var e=Object(d.a)(a);function a(t){var i;return Object(l.a)(this,a),(i=e.call(this,t)).onChangeComplete=function(t){var e=i.props.onChange;e&&e(t.hex),i.setState({color:t.hex})},i.state={showPicker:!1,color:t.color||t.defaultColor},i}return Object(h.a)(a,[{key:"render",value:function(){var t=this,e=this.props,a=e.theme,i=e.className,r=e.style,o=e.labelClassName,c=e.labelStyle,s=e.label,l=this.state,h=l.showPicker,u=l.color;return n.a.createElement("div",{style:r,tabIndex:"0",onFocus:function(){h||t.setState({showPicker:!0})},onBlur:function(){h&&t.setState({showPicker:!1})},className:"color-picker-".concat(a," ").concat(i)},n.a.createElement("div",{className:"color-picker-container"},n.a.createElement(E,{style:{background:u},className:"color-picker-color-box"}),n.a.createElement("div",{className:"color-picker-content-container ".concat(h?"color-picker-content-container-show":"")},n.a.createElement("i",{className:"color-picker-content-arrow"}),n.a.createElement(R.SketchPicker,{disableAlpha:!0,color:u,onChangeComplete:this.onChangeComplete}))),s&&n.a.createElement("span",{style:c,className:"color-picker-label ".concat(o)},s))}}],[{key:"getDerivedStateFromProps",value:function(t,e){return"color"in t&&t.color!==e.color?{color:t.color}:null}}]),a}(i.PureComponent));function V(t){var e=typeof t;return"function"===e||!!t&&"object"===e}z.defaultProps={theme:"dark"};a(347);var H=function(t){Object(u.a)(a,t);var e=Object(d.a)(a);function a(t){var i;return Object(l.a)(this,a),(i=e.call(this,t)).onClick=function(){return function(){if(!i.state.checked){var t=i.props.onChange;t&&t(!0),i.setState({checked:!0})}}},i.state={checked:t.checked||t.defaultChecked},i}return Object(h.a)(a,[{key:"render",value:function(){var t=this.props,e=t.theme,a=t.className,i=t.style,r=t.iconClassName,o=t.iconStyle,c=t.labelClassName,s=t.labelStyle,l=t.label,h=t.trigger,u=this.state.checked,d="icon"===h||"all"===h?{onClick:this.onClick()}:{},v="label"===h||"all"===h?{onClick:this.onClick()}:{};return n.a.createElement("div",{style:i,className:"radio-".concat(e," ").concat(a)},n.a.createElement("i",Object.assign({style:o},d,{className:"radio-icon ".concat(r," ").concat(u?"radio-icon-checked":"")})),l&&n.a.createElement("span",Object.assign({style:s},v,{className:"radio-label ".concat(c," ").concat(u?"radio-label-checked":"")}),l))}}],[{key:"getDerivedStateFromProps",value:function(t,e){return"checked"in t&&t.checked!==e.checked?{checked:t.checked}:null}}]),a}(i.PureComponent);H.defaultProps={theme:"dark",trigger:"all"};a(348);var B=function(t){Object(u.a)(a,t);var e=Object(d.a)(a);function a(t){var i;return Object(l.a)(this,a),(i=e.call(this,t)).onRadioChange=function(t){return function(){var e=i.props,a=e.valueKey,n=e.onChange,r=i.getValue(t,a);r!==i.state.value&&(n&&n(t),i.setState({value:r}))}},i.state={value:t.value||t.defaultValue},i}return Object(h.a)(a,[{key:"getValue",value:function(t,e){return V(t)?t[e]:t}},{key:"render",value:function(){var t=this,e=this.props,a=e.theme,i=e.className,r=e.style,o=e.radioClassName,c=e.radioStyle,s=e.radioIconClassName,l=e.radioIconStyle,h=e.radioLabelClassName,u=e.radioLabelStyle,d=e.labelKey,v=e.valueKey,p=e.dataSource,_=this.state.value;return n.a.createElement("div",{style:r,className:"radio-group ".concat(i)},p.map((function(e,i){var r=t.getValue(e,v)===_;return n.a.createElement(H,{key:"key_".concat(i),theme:a,className:o,style:c,iconClassName:s,iconStyle:l,labelClassName:h,labelStyle:u,checked:r,label:t.getValue(e,d),onChange:t.onRadioChange(e)})})))}}],[{key:"getDerivedStateFromProps",value:function(t,e){return"value"in t&&t.value!==e.value?{value:t.value}:null}}]),a}(i.PureComponent);B.defaultProps={theme:"dark",valueKey:"value",labelKey:"label",dataSource:[]};a(349);var N=function(t){Object(u.a)(a,t);var e=Object(d.a)(a);function a(t){var i;return Object(l.a)(this,a),(i=e.call(this,t)).onSelectClick=function(){var t=i.props,e=t.trigger,a=t.onDropdownVisibleChange;if("click"===e){var n=!i.state.open;a&&a(n),i.setState({open:n})}},i.onSelectMouseEnter=function(){var t=i.props,e=t.trigger,a=t.onDropdownVisibleChange;"hover"===e&&(a&&a(!0),i.setState({open:!0}))},i.onSelectMouseLeave=function(){var t=i.props,e=t.trigger,a=t.onDropdownVisibleChange;"hover"===e&&(a&&a(!1),i.setState({open:!1}))},i.onSelectBlur=function(){var t=i.props.onDropdownVisibleChange;t&&t(!1),i.setState({open:!1})},i.onRowClick=function(t,e){return function(){var a=i.props.onSelected,n={open:!1};i.state.value!==e&&(a&&a(t),n.value=e),i.setState(n)}},i.state={value:t.value||t.defaultValue,open:t.open||t.defaultOpen},i}return Object(h.a)(a,[{key:"getDataValue",value:function(t){return V(t)?t[this.props.valueKey]:t}},{key:"renderDropDownList",value:function(){var t=this,e=this.props,a=e.dataSource,i=e.renderDropDownRow;return a.map((function(e,a){var r=t.getDataValue(e);return n.a.createElement("li",{key:"row_".concat(a),onClick:t.onRowClick(e,r)},i?i(e):r)}))}},{key:"render",value:function(){var t=this.props,e=t.theme,a=t.style,i=t.className,r=t.dropDownContainerClassName,o=t.dropDownContainerStyle,c=t.selectorStyle,s=t.selectorClassName,l=t.valueStyle,h=t.valueClassName,u=t.valueIcon,d=t.showArrow,v=t.renderDropDownContainer,p=this.state,_=p.value,f=p.open;return n.a.createElement("div",{style:a,className:"select-".concat(e," ").concat(i," ").concat(f?"select-show":""),tabIndex:"0",onClick:this.onSelectClick,onBlur:this.onSelectBlur,onMouseEnter:this.onSelectMouseEnter,onMouseLeave:this.onSelectMouseLeave},n.a.createElement("div",{style:c,className:"select-selector-container ".concat(s)},n.a.createElement("div",{className:"select-selector-left-container"},u,n.a.createElement("span",{style:l,className:"select-selector-value ".concat(h)},_)),d&&n.a.createElement("i",{className:"select-selector-arrow"})),n.a.createElement("div",{style:o,className:"".concat(r," select-drop-down-container")},n.a.createElement(T.a,{style:{maxHeight:204}},v?v():n.a.createElement("ul",null,this.renderDropDownList()))))}}],[{key:"getDerivedStateFromProps",value:function(t,e){var a=null;return"value"in t&&t.value!==e.value&&(a={value:t.value}),"open"in t&&t.open!==e.open&&(a?a.open=t.open:a={open:t.open}),a}}]),a}(i.PureComponent);N.defaultProps={theme:"dark",trigger:"click",valueKey:"text",showArrow:!0,dataSource:[]};var F=function(t){Object(u.a)(a,t);var e=Object(d.a)(a);function a(){var t;Object(l.a)(this,a);for(var i=arguments.length,n=new Array(i),r=0;r<i;r++)n[r]=arguments[r];return(t=e.call.apply(e,[this].concat(n))).state={currentMenu:x[0]},t.changeMenu=function(e){return function(){t.setState({currentMenu:e})}},t.resetClick=function(){var e=t.props,a=e.defaultStyleOptions,i=e.onStyleOptionsChange;i&&i(O.a.assign({},a))},t.onComponentChange=function(e,a){return function(i){var n=t.props,r=n.styleOptions,o=n.onStyleOptionsChange,c=n.onTimezoneChange;if("timezone"===a)c(i);else{var s=O.a.assign({},r);switch(e){case"radioGroup":O.a.set(s,a,i.value);break;case"select":O.a.set(s,a,i.key);break;case"color":case"checkbox":O.a.set(s,a,i);break;case"input":O.a.set(s,a,+i)}o&&o(s)}}},t}return Object(h.a)(a,[{key:"getStyles",value:function(){switch(this.state.currentMenu){case"main_view_style":return w;case"chart_background":return b;case"axis":return P;case"timezone":return C}}},{key:"renderComponent",value:function(t){var e=this,a=this.props,i=a.theme,r=a.styleOptions,o=a.timezone;switch(t.componentType){case"compose":return t.dataSource.map((function(t){return e.renderComponent(t)}));case"radioGroup":return n.a.createElement(B,{key:t.key,theme:i,value:O.a.get(r,t.key),radioStyle:t.radioStyle,dataSource:t.dataSource,onChange:this.onComponentChange("radioGroup",t.key)});case"colorGroup":return t.dataSource.map((function(t,a){return n.a.createElement(z,{theme:i,key:"color_".concat(a),color:O.a.get(r,t.key),style:t.style,label:t.label,onChange:e.onComponentChange("color",t.key)})}));case"color":return n.a.createElement(z,{key:t.key,theme:i,style:t.style,color:O.a.get(r,t.key),onChange:this.onComponentChange("color",t.key)});case"select":return n.a.createElement(N,{key:t.key,theme:i,style:t.style,value:"timezone"===t.key?o:f(O.a.get(r,t.key)),dataSource:t.dataSource,onSelected:this.onComponentChange("select",t.key)});case"checkbox":return n.a.createElement(S,{key:t.key,style:t.style,checked:O.a.get(r,t.key),label:f(t.label),onChange:this.onComponentChange("checkbox",t.key)});case"input":return n.a.createElement(I,{key:t.key,theme:i,style:t.style,min:1,max:50,value:O.a.get(r,t.key),onChange:this.onComponentChange("input",t.key)})}}},{key:"render",value:function(){var t=this,e=this.props,a=e.theme,i=e.onClose,r=this.state.currentMenu;return n.a.createElement(M,{theme:a,onClose:i,title:f("setting")},n.a.createElement("div",{className:"modal-content-".concat(a)},n.a.createElement("ul",{style:{height:400},className:"modal-content-list-container modal-content-left-container"},x.map((function(e){return n.a.createElement("li",{key:e,className:r===e?"modal-content-list-row-selected":"",onClick:t.changeMenu(e)},f(e))}))),n.a.createElement("ul",{className:"modal-content-list-container modal-content-setting-container"},this.getStyles().map((function(e){return n.a.createElement("li",{key:e.key,className:"modal-content-setting-list-content-row"},e.title&&n.a.createElement("span",{className:"modal-content-setting-row-title"},f(e.title)),t.renderComponent(e))}))),"timezone"!==r&&n.a.createElement("div",{className:"modal-content-button-container"},n.a.createElement(E,{className:"modal-content-reset-button",onClick:this.resetClick},f("reset")))))}}]),a}(i.PureComponent);F.defaultProps={theme:"dark"};a(350);var Y=a(7),W=a.n(Y),j=a(33);a(356);function G(){return n.a.createElement("div",{className:"loading"},n.a.createElement("i",{className:"bar1"}),n.a.createElement("i",{className:"bar2"}),n.a.createElement("i",{className:"bar3"}),n.a.createElement("i",{className:"bar4"}),n.a.createElement("i",{className:"bar5"}))}a(357);function U(t,e){if(e)switch(t){case"Line":case"1m":return W()(e).subtract(1,"minutes").valueOf();case"5m":return W()(e).subtract(5,"minutes").valueOf();case"15m":return W()(e).subtract(15,"minutes").valueOf();case"30m":return W()(e).subtract(30,"minutes").valueOf();case"1H":return W()(e).subtract(1,"hours").valueOf();case"2H":return W()(e).subtract(2,"hours").valueOf();case"4H":return W()(e).subtract(4,"hours").valueOf();case"6H":return W()(e).subtract(6,"hours").valueOf();case"12H":return W()(e).subtract(12,"hours").valueOf();case"1D":return W()(e).subtract(1,"days").valueOf();case"1W":return W()(e).subtract(1,"weeks").valueOf();case"1M":return W()(e).subtract(1,"months").valueOf();case"1Y":return W()(e).subtract(1,"years").valueOf()}else{var a=W()();switch(t){case"Line":case"1m":return a.startOf("minute").valueOf();case"5m":var i=a.valueOf()%3e5;return a.valueOf()-i;case"15m":var n=a.valueOf()%9e5;return a.valueOf()-n;case"30m":var r=a.valueOf()%18e5;return a.valueOf()-r;case"1H":return a.startOf("hour").valueOf();case"2H":var o=a.valueOf()%72e5;return a.valueOf()-o;case"4H":var c=a.valueOf()%144e5;return a.valueOf()-c;case"6H":var s=a.valueOf()%216e5;return a.valueOf()-s;case"12H":var l=a.valueOf()%432e5;return a.valueOf()-l;case"1D":return a.startOf("day");case"1W":return a.startOf("week");case"1M":return a.startOf("month");case"1Y":return a.startOf("year").valueOf()}}}function X(t,e){for(var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:5e3,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:800,n=[],r=e,o=a,c=[],s=0;s<i;s++){o=o+20*Math.random()-10;for(var l=0;l<4;l++)c[l]=12*(Math.random()-.5)+o;c.sort();var h=+Math.round(3*Math.random()).toFixed(0),u=+Math.round(2*Math.random()).toFixed(0);u===h&&u++;var d=200*Math.random()+50;r=U(t,r);var v={open:c[h],low:c[0],high:c[3],close:c[u],volume:d,timestamp:r};v.turnover=(v.open+v.close+v.high+v.low)/4*d,n.unshift(v)}return n}var K=function(t){Object(u.a)(a,t);var e=Object(d.a)(a);function a(){var t;Object(l.a)(this,a);for(var i=arguments.length,n=new Array(i),r=0;r<i;r++)n[r]=arguments[r];return(t=e.call.apply(e,[this].concat(n))).state={loading:!0,firstLoading:!0},t.onResize=function(){t.chart&&t.chart.resize()},t}return Object(h.a)(a,[{key:"getChartStyle",value:function(t,e){var a="dark"===t?"#D9D9D9":"#7F7F7F",i="dark"===t?"#252525":"#EEEEEE",n="dark"===t?"#888888":"#999999";return{grid:{horizontal:{display:!0,color:i},vertical:{display:!0,color:i}},candleStick:{priceMark:{high:{color:a},low:{color:a}}},technicalIndicator:{line:{colors:[a,"#FF9600","#F632FF","#2196F3","#A25FF7"]},lastValueMark:{display:!0}},xAxis:{axisLine:{color:n},tickLine:{color:n},tickText:{color:a}},yAxis:{axisLine:{color:n},tickLine:{color:n},tickText:{color:a}},separator:{color:n},floatLayer:{crossHair:{horizontal:{line:{color:n}},vertical:{line:{color:n}}},prompt:{candleStick:{labels:"zh-CN"===e?["\u65f6\u95f4","\u5f00","\u6536","\u9ad8","\u4f4e","\u6210\u4ea4\u91cf"]:["T","O","C","H","L","V"],text:{color:a}},technicalIndicator:{text:{color:a}}}}}}},{key:"componentDidMount",value:function(){var t=this,e=this.props,a=e.theme,i=e.language,n=e.period,r=e.onChartReady;this.chart=Object(v.init)("k-line-chart"),window.addEventListener("resize",this.onResize),this.chart.loadMore((function(e){t.applyMoreData(e)})),this.chart.setStyleOptions(this.getChartStyle(a,i)),this.chart.addCustomTechnicalIndicator(j.simpleMovingAverage),this.chart.addCustomTechnicalIndicator(j.bullAndBearIndex),this.chart.addCustomTechnicalIndicator(j.rateOfChange),this.chart.addCustomTechnicalIndicator(j.priceAndVolumeTrend),this.chart.addCustomTechnicalIndicator(j.awesomeOscillator),r&&r(this.chart,!0),this.applyNewData(n)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.onResize),this.loadMoreDataTimer&&clearTimeout(this.loadMoreDataTimer),this.clearLoadNewDataTimer(),this.clearUpdateDataTimer(),Object(v.dispose)("k-line-chart")}},{key:"setOptions",value:function(t){this.chart.setStyleOptions(t)}},{key:"setMainTechnicalIndicatorType",value:function(t){this.chart.setCandleStickTechnicalIndicatorType(t)}},{key:"createSubTechnicalIndicator",value:function(t){return this.chart.createTechnicalIndicator(t,120)}},{key:"removeSubTechnicalIndicator",value:function(t){this.chart.removeTechnicalIndicator(t)}},{key:"setTechnicalIndicatorParams",value:function(t,e){this.chart.setTechnicalIndicatorParams(t,e)}},{key:"setTimezone",value:function(t){this.chart.setTimezone(t)}},{key:"screenShot",value:function(){var t=this.props.theme,e=this.chart.getConvertPictureUrl(!0,!0,"png","dark"===t?"#161616":"#FFFFFF"),a=document.createElement("a");a.download="screenShot",a.href=e,document.body.appendChild(a),a.click(),a.remove()}},{key:"applyNewData",value:function(t){var e=this;this.clearLoadNewDataTimer(),this.clearUpdateDataTimer(),this.setState({loading:!0}),this.loadNewDataTimer=setTimeout((function(){e.chart.applyNewData(X(t),!0),e.updateData(t),e.setState({loading:!1,firstLoading:!1})}),3500)}},{key:"applyMoreData",value:function(t){var e=this;this.loadMoreDataTimer=setTimeout((function(){var a=e.chart.getDataList()[0];e.chart.applyMoreData(X(e.props.period,t,a.close,200),!0)}),3e3)}},{key:"updateData",value:function(t){var e=this;this.updateDataTimer=setTimeout((function(){var a=e.chart.getDataList(),i=a[a.length-1],n=i.timestamp,r=U(t),o=Object(c.a)({},i);if(W()(n).isBefore(r))o.high=o.close,o.low=o.close,o.open=o.close,o.volume=0,o.turnover=0,o.timestamp=r;else{var s=10*(Math.random()-.5)+o.close,l=+(3*Math.random()).toFixed(0);o.close=s,o.high=Math.max(o.high,s),o.low=Math.min(o.low,s),o.volume=o.volume+l,o.turnover=o.turnover+l*s}e.chart.updateData(o),e.updateData(t)}),500)}},{key:"clearLoadNewDataTimer",value:function(){this.loadNewDataTimer&&clearTimeout(this.loadNewDataTimer)}},{key:"clearUpdateDataTimer",value:function(){this.updateDataTimer&&clearTimeout(this.updateDataTimer)}},{key:"componentDidUpdate",value:function(t,e,a){var i=this.props,n=i.theme,r=i.language,o=i.period,c=i.onChartReady;t.theme===n&&t.language===r||(this.chart.setStyleOptions(this.getChartStyle(n,r)),c&&c(this.chart)),t.period!==o&&("Line"===o?this.chart.setCandleStickChartType("real_time"):this.chart.setCandleStickChartType("candle_stick"),this.applyNewData(o))}},{key:"render",value:function(){var t=this,e=this.props.theme,a=this.state,i=a.firstLoading,r=a.loading;return n.a.createElement("div",{className:"chart-".concat(e)},r&&n.a.createElement(G,null),n.a.createElement("div",{style:{visibility:i?"hidden":"visible"},className:"drawing-tools-container"},m.map((function(e){return n.a.createElement("div",{key:e.key,className:"drawing-tools-row",onClick:function(){t.chart.addGraphicMark(e.key)}},n.a.createElement("i",{className:e.icon}))})),n.a.createElement("div",{className:"drawing-tools-row",onClick:function(){t.chart.removeAllGraphicMark()}},n.a.createElement("i",{className:"icon-delete"}))),n.a.createElement("div",{id:"k-line-chart",style:{visibility:i?"hidden":"visible"}}))}}]),a}(i.PureComponent);K.defaultProps={theme:"dark",language:"zh-CN"};a(358);var Z=function(t){Object(u.a)(a,t);var e=Object(d.a)(a);function a(t){var n;return Object(l.a)(this,a),(n=e.call(this,t)).changePeriod=function(t){return function(){n.state.currentPeriod!==t&&n.setState({currentPeriod:t})}},n.onChartReady=function(t,e){e&&(n.technicalIndicatorTags.VOL=t.createTechnicalIndicator("VOL",120),n.technicalIndicatorTags.MACD=t.createTechnicalIndicator("MACD",120)),n.setState({technicalIndicatorParams:t.getTechnicalIndicatorParamOptions(),defaultTechnicalIndicatorParams:t.getTechnicalIndicatorParamOptions(),defaultStyleOptions:t.getStyleOptions(),styleOptions:t.getStyleOptions()})},n.onMainTechnicalIndicatorChange=function(t){n.chartRef.current.setMainTechnicalIndicatorType(t),n.setState({mainTechnicalIndicatorType:t})},n.onSubTechnicalIndicatorChange=function(t,e){var a=Object(s.a)(n.state.subTechnicalIndicatorTypes);if("delete"===e){var i=n.technicalIndicatorTags[t];n.chartRef.current.removeSubTechnicalIndicator(i),a.splice(a.indexOf(t),1),delete n.technicalIndicatorTags[t]}else n.technicalIndicatorTags[t]=n.chartRef.current.createSubTechnicalIndicator(t),a.push(t);n.setState({subTechnicalIndicatorTypes:a})},n.onTechnicalIndicatorParamsChange=function(t,e){var a=Object(c.a)({},n.state.technicalIndicatorParams);a[t]=e,n.setState({technicalIndicatorParams:a})},n.onTechnicalIndicatorParamsConfirmClick=function(t){var e=n.state.technicalIndicatorParams[t]||[],a=[];e.forEach((function(t){t&&a.push(t)})),n.chartRef.current.setTechnicalIndicatorParams(t,a)},n.chartRef=Object(i.createRef)(),n.technicalIndicatorTags={},n.state={theme:"dark",language:"zh-CN",currentPeriod:"1m",isShowSettingModal:!1,isShowTechnicalIndicatorModal:!1,mainTechnicalIndicatorType:"MA",subTechnicalIndicatorTypes:["VOL","MACD"],defaultTechnicalIndicatorParams:{},technicalIndicatorParams:{},defaultStyleOptions:{},styleOptions:{},timezone:f("shanghai")},n}return Object(h.a)(a,[{key:"render",value:function(){var t=this,e=this.state,a=e.theme,i=e.language,r=e.currentPeriod,o=e.isShowTechnicalIndicatorModal,c=e.isShowSettingModal,s=e.mainTechnicalIndicatorType,l=e.subTechnicalIndicatorTypes,h=e.defaultTechnicalIndicatorParams,u=e.technicalIndicatorParams,d=e.defaultStyleOptions,p=e.styleOptions,m=e.timezone;return n.a.createElement("div",{className:"k-line-chart-".concat(a)},o&&n.a.createElement(L,{theme:a,defaultTechnicalIndicatorParams:h,technicalIndicatorParams:u,mainTechnicalIndicatorType:s,subTechnicalIndicatorTypes:l,onMainTechnicalIndicatorChange:this.onMainTechnicalIndicatorChange,onSubTechnicalIndicatorChange:this.onSubTechnicalIndicatorChange,onTechnicalIndicatorParamsChange:this.onTechnicalIndicatorParamsChange,onTechnicalIndicatorParamsConfirmClick:this.onTechnicalIndicatorParamsConfirmClick,onClose:function(){t.setState({isShowTechnicalIndicatorModal:!1})}}),c&&n.a.createElement(F,{theme:a,defaultStyleOptions:d,styleOptions:p,timezone:m,onStyleOptionsChange:function(e){t.chartRef.current.setOptions(e),t.setState({styleOptions:e})},onTimezoneChange:function(e){t.chartRef.current.setTimezone(e.key),t.setState({timezone:e.text})},onClose:function(){t.setState({isShowSettingModal:!1})}}),n.a.createElement("div",{className:"top-bar-container"},y.map((function(e){return n.a.createElement("span",{key:e,className:"top-bar-item ".concat(r===e&&"top-bar-item-selected"),onClick:t.changePeriod(e)},e)})),n.a.createElement("i",{className:"top-bar-split-line"}),n.a.createElement("span",{className:"top-bar-icon-item top-bar-item",onClick:function(){t.setState({isShowTechnicalIndicatorModal:!0})}},n.a.createElement("i",{className:"top-bar-icon icon-technical-indicator"}),n.a.createElement("span",null,f("indicator"))),n.a.createElement("i",{className:"top-bar-split-line"}),n.a.createElement("span",{className:"top-bar-icon-item top-bar-item",onClick:function(){t.setState({isShowSettingModal:!0})}},n.a.createElement("i",{className:"top-bar-icon icon-setting"}),n.a.createElement("span",null,f("setting"))),n.a.createElement("i",{className:"top-bar-split-line"}),n.a.createElement("span",{className:"top-bar-icon-item top-bar-item",onClick:function(){t.chartRef.current.screenShot()}},n.a.createElement("i",{className:"top-bar-icon icon-screen-shot"}),n.a.createElement("span",null,f("screen_shot"))),n.a.createElement("i",{className:"top-bar-split-line"}),n.a.createElement("span",{className:"top-bar-icon-item top-bar-item",onClick:function(){var e="dark"===a?"light":"dark";t.setState({isShowSettingModal:!1,theme:e})}},n.a.createElement("i",{style:{fontSize:20},className:"top-bar-icon ".concat("dark"===a?"icon-sun":"icon-moon")}),n.a.createElement("span",null,f("dark"===a?"light":"dark"))),n.a.createElement("i",{className:"top-bar-split-line"}),n.a.createElement("span",{className:"top-bar-icon-item top-bar-item",onClick:function(){var e="zh-CN"===i?"en":"zh-CN";!function(t){_=t}(e),t.setState({language:e})}},n.a.createElement("i",{className:"top-bar-icon icon-earth"}),"zh-CN"===i?"En":"\u4e2d"),n.a.createElement("i",{className:"top-bar-split-line"}),n.a.createElement("a",{className:"version-container",target:"_blank",rel:"noopener noreferrer",href:"https://github.com/liihuu/KLineChart"},n.a.createElement("i",{className:"github-icon icon-github"}),n.a.createElement("span",{className:"version-text"},"(v",Object(v.version)(),")"))),n.a.createElement(K,{ref:this.chartRef,theme:a,language:i,period:r,onChartReady:this.onChartReady}))}}]),a}(i.PureComponent),J=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function q(t,e){navigator.serviceWorker.register(t).then((function(t){t.onupdatefound=function(){var a=t.installing;null!=a&&(a.onstatechange=function(){"installed"===a.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),e&&e.onUpdate&&e.onUpdate(t)):(console.log("Content is cached for offline use."),e&&e.onSuccess&&e.onSuccess(t)))})}})).catch((function(t){console.error("Error during service worker registration:",t)}))}a(359),a(360);o.a.render(n.a.createElement(Z,null),document.getElementById("root")),function(t){if("serviceWorker"in navigator){if(new URL("/KLineChart",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var e="".concat("/KLineChart","/service-worker.js");J?(!function(t,e){fetch(t,{headers:{"Service-Worker":"script"}}).then((function(a){var i=a.headers.get("content-type");404===a.status||null!=i&&-1===i.indexOf("javascript")?navigator.serviceWorker.ready.then((function(t){t.unregister().then((function(){window.location.reload()}))})):q(t,e)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(e,t),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")}))):q(e,t)}))}}()},39:function(t,e,a){"use strict";t.exports=a(147)}},[[138,1,2]]]);